
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Word Search Problem - Non-recursive Solution | Bo's Blog</title>
  
  <meta name="author" content="Bo Yang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <!--
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  -->

  <!-- Bootstrap -->
  <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

  <!-- font-awesome -->
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

  <!-- Google Prettify -->
  <link href="/assets/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/style/blog.css" rel="stylesheet">
  
  <script src="/assets/bootstrap/js/jquery-1.10.2.js"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

   <!-- navigation bar -->
	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
				<a class="navbar-brand" href="/"><b>bo-yang</b></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/archive.html"><b>Archive</b></a>
					</li>
					<li><a href="/tags.html"><b>Tags</b></a>
                    </li>
                    <li><a href="/about.html"><b>About</b></a>
                    </li>
                    <li><a href="/messages.html"><b>Messages</b></a>
                    </li>
				</ul>
				<ul class="nav navbar-nav pull-right">
		          <li>
		            <form class="navbar-form navbar-search" method="get" action="http://www.google.com/search" target="google_window">
		              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
		              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
		              <input type="hidden" name="ie" value="UTF-8" />
		              <input type="hidden" name="oe" value="UTF-8" />
		              <input type="hidden" name="hl" value="en-US" />
		              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
					  <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
					  <button type="submit" class="button button-rounded button-flat-blue">Go</button>
		            </form>
		          </li>
		        </ul>
            </div>
			<!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

  <div class="container">
    <div class="row" id="content-row">
      
<div class="page-header">
	<h1>Word Search Problem - Non-recursive Solution</h1>
	<p>
		<span class="glyphicon glyphicon-time"></span> Posted at &nbsp; 2014-07-28 &nbsp; &nbsp; by  <a href="/about.html"><strong>Bo Yang</strong></a> &nbsp; &nbsp; <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Algorithm" rel="nofollow">Algorithm</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#C%2FC%2B%2B" rel="nofollow">C/C++</a>
	</p>
</div>

<div class="col-lg-10">
	<div class="post paper">
		<p>The <a href="https://oj.leetcode.com/problems/word-search/">Word Search</a> states:</p>

<blockquote>
  <p>Given a 2D board and a word, find if the word exists in the grid.</p>

  <p>The word can be constructed from letters of sequentially adjacent cell, where “adjacent” cells are those horizontally or vertically neighboring. The same letter cell may not be used more than once.</p>

  <p>For example,</p>

  <p>Given board =</p>

  <p>[</p>

  <p>[“ABCE”],</p>

  <p>[“SFCS”],</p>

  <p>[“ADEE”]</p>

  <p>]</p>
</blockquote>

<blockquote>
  <ul>
    <li>word = “ABCCED”, -&gt; returns <code>true</code>,</li>
    <li>word = “SEE”, -&gt; returns <code>true</code>,</li>
    <li>word = “ABCB”, -&gt; returns <code>false</code>.</li>
  </ul>
</blockquote>

<p>The most popular solution to this problem is recursive, such as <a href="http://yucoding.blogspot.com/2013/02/leetcode-question-124-word-search.html">http://yucoding.blogspot.com/2013/02/leetcode-question-124-word-search.html</a>.</p>

<p>However, I tried to solve this problem without recursion. In my implementation, three stacks are used to record the possible coordinates in <code>board</code>, the character position in <code>word</code>(with respect to each candidate cell) and the cells have been accessed to each possible coordinates, repectively. </p>

<p>The first step is finding the possible cells for the first char in <code>word</code>, and push coordinates, position of the char in <code>word</code>(here is 0) and accessed cells(here are matched cells) into stacks. </p>

<p>The second step is exploring all the neighbors of cells in stack, and match each char in <code>word</code> respectively. For a match, push contexts into stack and try to match the next char. For a mismatch, pop the top of stacks and try another candidate. If the search could reach the end of the word, then we successfully find the word. If the stacks turns empty and there are still chars left, that means the seach fails.</p>

<p>Following is my C++ implementation of the non-recursive solution.</p>

<pre><code>class Solution {
public:
    bool exist(vector&lt;vector&lt;char&gt; &gt; &amp;board, string word) {
		if(board.empty())
			return false;

		std::stack&lt;std::pair&lt;int,int&gt;&gt; st_coord; // coordinates of the board
		std::stack&lt;int&gt; st_char; // store characters of the words
		vector&lt;std::pair&lt;int,int&gt; &gt; vec;
		std::stack&lt;vector&lt;std::pair&lt;int,int&gt; &gt; &gt; st_access;
		bool found=false;
        for(int l=0;l&lt;word.length();) {
			if(l==0) { // Find the first character of word in board
				for(int i=0;i&lt;board.size();++i) {
					for(int j=0;j&lt;board[0].size();++j)
						if(board[i][j]==word[l]){
							st_coord.push(std::pair&lt;int,int&gt;(i,j));
							st_char.push(l);
							vec.push_back(std::pair&lt;int,int&gt;(i,j));
							st_access.push(vec);
							vec.pop_back(); // do not affect other candidates
							if(word.size()==1) 
								return true;
						}
				}
				l++;
			} else {
				if(st_coord.empty()) // cannot find the first character
					break;

				// Explore all possible cells to match each character of the word
				while(!st_coord.empty()) {
					int x=st_coord.top().first;
					int y=st_coord.top().second;
					vec=st_access.top();
					l=st_char.top()+1;
					if(l==word.length()) {
						found=true;
						break;
					}
					
					st_coord.pop();
					st_char.pop();
					st_access.pop();

					if(x-1&gt;=0 &amp;&amp; board[x-1][y]==word[l]) {
						vector&lt;std::pair&lt;int,int&gt; &gt;::iterator got=
							std::find(vec.begin(),vec.end(),std::pair&lt;int,int&gt;(x-1,y));
						if(got==vec.end()) {
							st_coord.push(std::pair&lt;int,int&gt;(x-1,y));
							st_char.push(l);
							vec.push_back(std::pair&lt;int,int&gt;(x-1,y));
							st_access.push(vec);
							vec.pop_back(); // do not affect other candidates
						}
					}
					if(x+1&lt;board.size() &amp;&amp; board[x+1][y]==word[l]) {
						vector&lt;std::pair&lt;int,int&gt; &gt;::iterator got=
							std::find(vec.begin(),vec.end(),std::pair&lt;int,int&gt;(x+1,y));
						if(got==vec.end()) {
							st_coord.push(std::pair&lt;int,int&gt;(x+1,y));
							st_char.push(l);
							vec.push_back(std::pair&lt;int,int&gt;(x+1,y));
							st_access.push(vec);
							vec.pop_back(); // do not affect other candidates
						}
					}
					if(y-1&gt;=0 &amp;&amp; board[x][y-1]==word[l]) {
						vector&lt;std::pair&lt;int,int&gt; &gt;::iterator got=
							std::find(vec.begin(),vec.end(),std::pair&lt;int,int&gt;(x,y-1));
						if(got==vec.end()) {
							st_coord.push(std::pair&lt;int,int&gt;(x,y-1));
							st_char.push(l);
							vec.push_back(std::pair&lt;int,int&gt;(x,y-1));
							st_access.push(vec);
							vec.pop_back(); // do not affect other candidates
						}
					}
					if(y+1&lt;board[0].size() &amp;&amp; board[x][y+1]==word[l]) {
						vector&lt;std::pair&lt;int,int&gt; &gt;::iterator got=
							std::find(vec.begin(),vec.end(),std::pair&lt;int,int&gt;(x,y+1));
						if(got==vec.end()) {
							st_coord.push(std::pair&lt;int,int&gt;(x,y+1));
							st_char.push(l);
							vec.push_back(std::pair&lt;int,int&gt;(x,y+1));
							st_access.push(vec);
							vec.pop_back(); // do not affect other candidates
						}
					}
				}
			} // end else
		} // end for l

		return found;
    }
};
</code></pre>

	</div>

	<div align="right">
        <div class="bshare-custom">
	<span class='st_facebook_large' displayText='Facebook'></span>
	<span class='st_googleplus_large' displayText='Google +'></span>
	<span class='st_twitter_large' displayText='Tweet'></span>
	<span class='st_sina_large' displayText='Sina'></span>
	<span class='st_linkedin_large' displayText='LinkedIn'></span>
	<span class='st_tumblr_large' displayText='Tumblr'></span>
	<span class='st_sharethis_large' displayText='ShareThis'></span>
	<span class='st_blogger_large' displayText='Blogger'></span>
	<span class='st_email_large' displayText='Email'></span>
</div>
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "6e9cb968-ad78-4055-b1e7-1b7ab6751416", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

	</div>

	<!-- page link -->
    <div class="pager">
      <ul>
      
        <li class="previous"><a href="/2014/07/21/merge-k-sorted-lists" title="Merge K Sorted Lists">&larr; Previous</a></li>
      

      
        <li class="next"><a href="/2014/08/03/string-permutation" title="String Permutation">Next &rarr;</a></li>
      
      </ul>
    </div>

	<!--
	<div class="well">
		<script>
var linkwithin_site_id = 2140443;
</script>
<script src="http://www.linkwithin.com/widget.js"></script>
<a href="http://www.linkwithin.com/"><img src="http://www.linkwithin.com/pixel.png" alt="Related Posts Plugin for WordPress, Blogger..." style="border: 0" /></a>

	</div>
	-->
    <div class="well">
		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'boyang'; // required: replace example with your forum shortname
     var disqus_identifier = '/2014/07/28/word-search';
    var disqus_url = 'http://bo-yang.github.com//2014/07/28/word-search';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    </div>
</div>

<div class="col-lg-2">
	<div class="well">
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Right-side Ad -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-1292710832620237"
     data-ad-slot="9707222500"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

	</div>
	<div class="well">
		<h4>Visitors</h4>
		<div class="tag_box">
			<script type="text/javascript" src="http://je.revolvermaps.com/2/2.js?i=493pvkdo4nt&amp;m=0&amp;s=130&amp;c=ff0000&amp;t=1" async="async"></script>
	
		</div>
    </div>

</div>




    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> Bo Yang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
	    </script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/google-code-prettify/prettify.js"></script>
  <script src="/assets/run_prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow" class="btn btn-primary" role="button">' + 'Read More &raquo;</a>');
        }
      });
    });
  </script>

  

</body>
</html>

