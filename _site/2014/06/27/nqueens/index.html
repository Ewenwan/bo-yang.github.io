
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N-Queens Problem | Bo's Blog</title>
  
  <meta name="author" content="Bo Yang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <!--
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  -->

  <!-- Bootstrap -->
  <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

  <!-- font-awesome -->
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

  <!-- Google Prettify -->
  <link href="/assets/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/style/blog.css" rel="stylesheet">
  
  <script src="/assets/bootstrap/js/jquery-1.10.2.js"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

   <!-- navigation bar -->
	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">bo-yang</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/archive.html">Archive</a>
                    </li>
                    <li><a href="/about.html">About</a>
                    </li>
                    <li><a href="/messages.html">Messages</a>
                    </li>
				</ul>
				<ul class="nav navbar-nav pull-right">
		          <li>
		            <form class="navbar-form navbar-search" method="get" action="http://www.google.com/search" target="google_window">
		              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
		              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
		              <input type="hidden" name="ie" value="UTF-8" />
		              <input type="hidden" name="oe" value="UTF-8" />
		              <input type="hidden" name="hl" value="en-US" />
		              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
					  <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
					  <button type="submit" class="button button-rounded button-flat-blue">Go</button>
		            </form>
		          </li>
		        </ul>
            </div>
			<!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

  <div class="container">
    <div class="row" id="content-row">
      
<div class="page-header">
	<h1>N-Queens Problem</h1>
	<p>
		<span class="glyphicon glyphicon-time"></span> Posted at &nbsp; 2014-06-27 &nbsp; &nbsp; by  <a href="/about.html"><strong>Bo Yang</strong></a> &nbsp; &nbsp; <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Algorithm-ref" rel="nofollow">Algorithm</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#C/C++-ref" rel="nofollow">C/C++</a>
	</p>
</div>

<div class="col-lg-10">
	<div class="post paper">
		<p><a href="https://oj.leetcode.com/problems/n-queens/">N-Queens Problem</a>:</p>

<blockquote>
  <p>The \(n\)-queens puzzle is the problem of placing \(n\) queens on an \(n \times n\) chessboard such that no two queens attack each other, which means <a href="http://en.wikipedia.org/wiki/Eight_queens_puzzle">no two queens share the same row, column, or diagonal</a>.
Given an integer \(n\), return all distinct solutions to the \(n\)-queens puzzle.
Each solution contains a distinct board configuration of the \(n\)-queens’ placement, where ‘Q’ and ‘.’ both indicate a queen and an empty space respectively.</p>
</blockquote>

<p>This problem can be solved recursively: for every free grid in a row, resursively check possible solutions in the row below, until (1) there is no free grid in the next row(failure) or (2) there is no row below(current row is the last row, sucess). </p>

<p>For any grid in the table, if the value of the grid is <em>true</em>, then this grid is free. Otherwise, it is not free. In order to guaranttee there is no two queens in the same row, column or diagonal, after picking up a grid, set the value of grids in the same row, column or diagonal to be <em>false</em>. After checking the remaining rows, the states of grids set in this step should be restored. </p>

<p>Following is my C++ implementation. Functions checkRow() and setGrid() are very tricky.</p>

<pre>
class Solution {
public:
	vector&lt;vector<string> &gt; solveNQueens(int n) {
	   vector&lt;vector<bool> &gt; grid;
	   vector<bool> row_bool;
	   for(int j=0;j&lt;n;++j) 
		   row_bool.push_back(true);
	   for(int i=0;i&lt;n;++i)
		   grid.push_back(row_bool);

	   vector&lt;vector&lt;pair&lt;int,int&gt; &gt; &gt; points;
	   vector&lt;pair&lt;int,int&gt; &gt; path;
	   checkRow(grid,path,points,n,0);

	   vector&lt;vector<string> &gt; ret;
	   for(int i=0;i&lt;points.size();++i) {
		   vector<string> trace;
		   string row_trace;
		   for(int i=0;i&lt;n;++i)
			   row_trace+=".";
		   for(int i=0;i&lt;n;++i)
			   trace.push_back(row_trace);

		   for(auto&amp; pt: points[i]) 
			   trace[pt.first][pt.second]='Q';

		   ret.push_back(trace);
	   }

	   return ret;
    }

	// Recrusively try a solution row-by-row
	void checkRow(vector&lt;vector<bool> &gt;&amp; grid, vector&lt;pair&lt;int,int&gt; &gt;&amp; path, vector&lt;vector&lt;pair&lt;int,int&gt; &gt; &gt;&amp; trace, int n, int row) {
		if(row==n &amp;&amp; path.size()==n) {
			trace.push_back(path);	// store the solution
			return;
		}

		vector<int> avail_cols;
		findAvailGrids(grid,avail_cols,row);
		if(avail_cols.empty())
			return;

		for(auto&amp; col:avail_cols) {
			path.push_back(pair&lt;int,int&gt;(row,col));
			vector&lt;pair&lt;int,int&gt; &gt; points;
			setGrid(grid,points,row,col,false);
			checkRow(grid,path,trace,n,row+1);
			setGrid(grid,points,true);	// recover the state of table
			path.pop_back();
		}
	}

	// Find available grids in a row
	void findAvailGrids(vector&lt;vector<bool> &gt;&amp; grid,vector<int>&amp; vec,int row) {
		for(int j=0;j&lt;grid[0].size();++j) {
			if(grid[row][j])
				vec.push_back(j);
		}
	}

	// Set grids to val based on the coordinate of a given grid
	void setGrid(vector&lt;vector<bool> &gt;&amp; grid,vector&lt;pair&lt;int,int&gt; &gt;&amp; points, int row, int col, bool val) {
		const int n=grid.size();
		// set grids in the same row and column
		for(int i=0;i&lt;n;++i) {
			if(grid[i][col]!=val)
				points.push_back(pair&lt;int,int&gt;(i,col));
			if(grid[row][i]!=val)
				points.push_back(pair&lt;int,int&gt;(row,i));
			grid[i][col]=val;
			grid[row][i]=val;
		}
		// set diagnal grids
		int x=row;
		int y=col;
		while(x&gt;=0 &amp;&amp; y&gt;=0) {
			if(grid[x][y]!=val)
				points.push_back(pair&lt;int,int&gt;(x,y));
			grid[x][y]=val;
			x--;y--;
		}
		x=row+1; y=col+1;
		while(x&lt;n &amp;&amp; y&lt;n) {
			if(grid[x][y]!=val)
				points.push_back(pair&lt;int,int&gt;(x,y));
			grid[x][y]=val;
			x++;y++;
		}
		x=row-1; y=col+1;
		while(x&gt;=0 &amp;&amp; y&lt;n) {
			if(grid[x][y]!=val)
				points.push_back(pair&lt;int,int&gt;(x,y));
			grid[x][y]=val;
			x--;y++;
		}
		x=row+1; y=col-1;
		while(x&lt;n &amp;&amp; y&gt;=0) {
			if(grid[x][y]!=val)
				points.push_back(pair&lt;int,int&gt;(x,y));
			grid[x][y]=val;
			x++;y--;
		}
	}

	// Set grids to val based on a collection of grids
	void setGrid(vector&lt;vector<bool> &gt;&amp; grid, vector&lt;pair&lt;int,int&gt; &gt;&amp; points, bool val) {
		for(auto&amp; pt:points)
			grid[pt.first][pt.second]=val;
	}

	// Print all solutions, test only
	void printSolution(vector&lt;vector<string> &gt;&amp; trace) {
		cout&lt;&lt;"["&lt;&lt;endl;
		for(int i=0;i&lt;trace.size();++i) {
			cout&lt;&lt;"  [\""&lt;&lt;trace[i][0]&lt;&lt;"\","&lt;&lt;endl;
			for(int j=1;j&lt;trace[i].size();++j) {
				if(j!=trace[i].size()-1)
					cout&lt;&lt;"   \""&lt;&lt;trace[i][j]&lt;&lt;"\","&lt;&lt;endl;
				else
					cout&lt;&lt;"   \""&lt;&lt;trace[i][j]&lt;&lt;"\"]"&lt;&lt;endl;
			}
			cout&lt;&lt;endl;
		}
	}

	// Print the values of all grids in the table, test only
	void printGrid(vector&lt;vector<bool> &gt;&amp; grid,int row,int col,string str) {
		cout&lt;&lt;"("&lt;&lt;row&lt;&lt;","&lt;&lt;col&lt;&lt;")"&lt;&lt;str&lt;&lt;":"&lt;&lt;endl;
		for(int i=0;i&lt;grid.size();++i) {
			for(int j=0;j&lt;grid[0].size();++j) {
				if(grid[i][j])
					cout&lt;&lt;"T ";
				else
					cout&lt;&lt;"F ";
			}
			cout&lt;&lt;endl;
		}
		cout&lt;&lt;endl;
	}
};

</bool></string></bool></bool></int></bool></int></bool></string></string></bool></bool></string></pre>

	</div>

	<div align="right">
        <div class="bshare-custom">
	<span class='st_facebook_large' displayText='Facebook'></span>
	<span class='st_googleplus_large' displayText='Google +'></span>
	<span class='st_twitter_large' displayText='Tweet'></span>
	<span class='st_sina_large' displayText='Sina'></span>
	<span class='st_linkedin_large' displayText='LinkedIn'></span>
	<span class='st_tumblr_large' displayText='Tumblr'></span>
	<span class='st_sharethis_large' displayText='ShareThis'></span>
	<span class='st_blogger_large' displayText='Blogger'></span>
	<span class='st_email_large' displayText='Email'></span>
</div>
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "6e9cb968-ad78-4055-b1e7-1b7ab6751416", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

	</div>

	<!-- page link -->
    <div class="pager">
      <ul>
      
        <li class="previous"><a href="/2014/06/25/combination-sum" title="Combination Sum Problem - A Non-recursive Method">&larr; Previous</a></li>
      

      
        <li class="next"><a href="/2014/06/29/top-n-numbers" title="Top N Numbers">Next &rarr;</a></li>
      
      </ul>
    </div>

	<!--
	<div class="well">
		<script>
var linkwithin_site_id = 2140443;
</script>
<script src="http://www.linkwithin.com/widget.js"></script>
<a href="http://www.linkwithin.com/"><img src="http://www.linkwithin.com/pixel.png" alt="Related Posts Plugin for WordPress, Blogger..." style="border: 0" /></a>

	</div>
	-->
    <div class="well">
		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'boyang'; // required: replace example with your forum shortname
     var disqus_identifier = '/2014/06/27/nqueens';
    var disqus_url = 'http://bo-yang.github.com//2014/06/27/nqueens';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    </div>


</div>




    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> Bo Yang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
	    </script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/google-code-prettify/prettify.js"></script>
  <script src="/assets/run_prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow" class="btn btn-primary" role="button">' + 'Read More &raquo;</a>');
        }
      });
    });
  </script>

  

</body>
</html>

