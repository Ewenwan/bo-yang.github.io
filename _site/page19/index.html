<!DOCTYPE html>
<html lang="en">
<head>
  <title>John Duff - Home </title>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <meta name="verify-v1" content="fI45uNHehVNiO9Dt0Fp7XnsV0Z/ozBTkPoS6RlYAe50=" />
  <meta name="y_key" content="6c948e75a617b12d" />
  <meta name='technorati-claim' content='8QN7CWNH8BSJ' />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" media="screen" href="/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/css/default.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="John Duff's blog" />
</head>

<body class='blog'>
  <div class="container">
    <div class="row">
      <div class="span4 sidebar affix">
        <div class="well">
          <h2 class='site-title'>
            <a href="http://bo-yang.github.io">Bo Yang</a>
          </h2>

		  <p><i>You got to make the back of the fence that nobody will see just as good looking as the front of the fence.</i></p>

          <ul id="navigation" class="clearfix">
            <li class='about'><a href='/about/'>About</a></li>
            <li class='archives'><a href='/archives/'>Archives</a></li>
            <li class="github"><a href="http://github.com/bo-yang" rel='me' class='url'>@github</a></li>
          </ul>
        </div>
      </div>
      <div class="span8 main offset4">
        <div class="well">
          <div id='index'>

  <div class="post">
    <h2><a href="/industry/2010/09/02/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520splashtop%2520remote-%25e8%25ae%25a9%25e4%25bd%25a0%25e5%259c%25a8ipad%25e4%25b8%258a%25e4%25b9%259f%25e8%2583%25bd%25e7%2594%25a8windows%25e4%25b8%258b%25e7%259a%2584%25e5%25ba%2594%25e7%2594%25a8%250d%250a%2520%2520%2520%2520%2520%2520/">Splashtop Remote——让你在iPad上也能用Windows下的应用</a></h2>

    <p>今天看到这样一篇博文：<a href="http://blog.sina.com.cn/s/blog_679720260100ky5a.html?tj=1">在iPad上也能用Windows下的应用？我能！</a></p>
<p>&nbsp;</p>
<p>对于文中介绍的可以在iPad上也能用Windows软件的Splashtop Remote很感兴趣，因为传说Chrome OS也会用类似的机制来解决Windows软件的兼容问题，即&ldquo;一部分运行在PC上，起daemon的作用，另外一个运行在iPad上，跟PC的软件进行通信，使用户能够控制或管理PC上的软件程序和数据。&rdquo; 这应该和VNC起的作用类似。</p>
<p>&nbsp;</p>
<p>估计iPad和即将发布的gPad（Chrome OS Tablet）乃至Android Pad们很快就会利用这种方式开拓市场，甚至蚕食PC市场了。试想如果将来有公司（比如这个DeviceVM）推出一项服务（可以免费，也可收费），为用户提供现成的Windows应用，而用户所需要做的就是在iPad或gPad上安装Splashtop Remote，打开这个应用就可以自动连接到DeviceVM的Windows PC/Server，利用现成的Windows程序了&mdash;&mdash;省去了自己购买并维护PC的很多麻烦，节省了购买大量Windows软件的开支，何乐而不为呢？而且这也正契合了时下的云计算潮流。</p>
<p>&nbsp;</p>
<p>我能想到的问题是，这种方式使用Windows软件的体验会不会大打折扣？因为在使用VNC登录到Mac OS X的时候，即使在局域网内，图像质量很差，操作很不流畅。也许像Splashtop Remote这样的应用可以保证图像的质量，但是网络本身也会成为一个瓶颈，尤其是3G网络。看来在LTE普及之前，这种应用只能使用WIFI了。</p>
<p>&nbsp;</p>
<p>顺便到Apple App Store里看了一下，发现了几张官方的截图，可以看出，图像质量还是有一定的损失的：</p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/053/Purple/c5/a5/f6/mzl.vcvzpnec.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/036/Purple/ff/b6/63/mzl.ncmtyrzu.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/026/Purple/a7/73/4a/mzl.zngpsfkj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/033/Purple/34/71/31/mzl.nzoufixg.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/004/Purple/1c/8b/bf/mzl.phnrdjsj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>


    <small class="meta">September 02, 2010 | <a href='/industry/2010/09/02/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520splashtop%2520remote-%25e8%25ae%25a9%25e4%25bd%25a0%25e5%259c%25a8ipad%25e4%25b8%258a%25e4%25b9%259f%25e8%2583%25bd%25e7%2594%25a8windows%25e4%25b8%258b%25e7%259a%2584%25e5%25ba%2594%25e7%2594%25a8%250d%250a%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/bkup/2010/09/02/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520splashtop%2520remote-%25e8%25ae%25a9%25e4%25bd%25a0%25e5%259c%25a8ipad%25e4%25b8%258a%25e4%25b9%259f%25e8%2583%25bd%25e7%2594%25a8windows%25e4%25b8%258b%25e7%259a%2584%25e5%25ba%2594%25e7%2594%25a8%250d%250a%2520%2520%2520%2520%2520%2520/">Splashtop Remote——让你在iPad上也能用Windows下的应用</a></h2>

    <p>今天看到这样一篇博文：<a href="http://blog.sina.com.cn/s/blog_679720260100ky5a.html?tj=1">在iPad上也能用Windows下的应用？我能！</a></p>
<p>&nbsp;</p>
<p>对于文中介绍的可以在iPad上也能用Windows软件的Splashtop Remote很感兴趣，因为传说Chrome OS也会用类似的机制来解决Windows软件的兼容问题，即&ldquo;一部分运行在PC上，起daemon的作用，另外一个运行在iPad上，跟PC的软件进行通信，使用户能够控制或管理PC上的软件程序和数据。&rdquo; 这应该和VNC起的作用类似。</p>
<p>&nbsp;</p>
<p>估计iPad和即将发布的gPad（Chrome OS Tablet）乃至Android Pad们很快就会利用这种方式开拓市场，甚至蚕食PC市场了。试想如果将来有公司（比如这个DeviceVM）推出一项服务（可以免费，也可收费），为用户提供现成的Windows应用，而用户所需要做的就是在iPad或gPad上安装Splashtop Remote，打开这个应用就可以自动连接到DeviceVM的Windows PC/Server，利用现成的Windows程序了&mdash;&mdash;省去了自己购买并维护PC的很多麻烦，节省了购买大量Windows软件的开支，何乐而不为呢？而且这也正契合了时下的云计算潮流。</p>
<p>&nbsp;</p>
<p>我能想到的问题是，这种方式使用Windows软件的体验会不会大打折扣？因为在使用VNC登录到Mac OS X的时候，即使在局域网内，图像质量很差，操作很不流畅。也许像Splashtop Remote这样的应用可以保证图像的质量，但是网络本身也会成为一个瓶颈，尤其是3G网络。看来在LTE普及之前，这种应用只能使用WIFI了。</p>
<p>&nbsp;</p>
<p>顺便到Apple App Store里看了一下，发现了几张官方的截图，可以看出，图像质量还是有一定的损失的：</p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/053/Purple/c5/a5/f6/mzl.vcvzpnec.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/036/Purple/ff/b6/63/mzl.ncmtyrzu.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/026/Purple/a7/73/4a/mzl.zngpsfkj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/033/Purple/34/71/31/mzl.nzoufixg.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/004/Purple/1c/8b/bf/mzl.phnrdjsj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>


    <small class="meta">September 02, 2010 | <a href='/bkup/2010/09/02/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520splashtop%2520remote-%25e8%25ae%25a9%25e4%25bd%25a0%25e5%259c%25a8ipad%25e4%25b8%258a%25e4%25b9%259f%25e8%2583%25bd%25e7%2594%25a8windows%25e4%25b8%258b%25e7%259a%2584%25e5%25ba%2594%25e7%2594%25a8%250d%250a%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/tcl/tk/unix/linux/2010/08/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520tclexpect%25e4%25b8%25ad%25e5%2588%25a9%25e7%2594%25a8exec%25e8%25b0%2583%25e7%2594%25a8%25e7%25ae%25a1%25e9%2581%2593%2526quot%253b%257c%2526quot%253b%25e5%2592%258cawk%25e7%259a%2584%25e6%25b3%25a8%25e6%2584%258f%25e4%25ba%258b%25e9%25a1%25b9%250d%250a%2520%2520%25/">Tcl/Expect中利用exec调用管道"|"和awk的注意事项</a></h2>

    <p>Tcl/Expect中利用exec调用稍微复杂的shell命令时，经常会遇到一些小问题，常见的就是pipeline(|)和awk。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用多个shell命令并使用|将其串接在一起时，需要注意的是必须在"|"前后加上空格" "，否则tcl/Expect会报奇怪的错。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用awk命令时，需要把awk的' '中的命令改为用" "，并把$1, $2之类的变量改为/$1, /$2。</p>
<p>&nbsp;</p>
<p>下面的ksh命令判断test_process是否在运行：</p>
<p>
<pre>ps -fu bonny|grep -v ps|grep MMCAP|grep -v grep|awk '{print $2}'</pre>
<p>&nbsp;</p>
<p>改为Tcl/Expect后，为：</p>
<p>
<pre>exec ps -fu $myname | grep -v ps | grep COOLrunMMCAP | grep -v grep | awk "{print /$2}"</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>另外，&nbsp;<a href="http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/">http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/</a>&nbsp;列出了一些ksh命令转换为tcl语句时经常遇到的问题（本人未曾验证过，请谨慎使用）。</p>
<p>&nbsp;</p>
<p>Here's some conversion rules that I have proven, if anyone has any more info ( in any fashion ) , please advise.</p>
<p>-----------------------------------------------------------------<br />Rule: Remove "<br />-----------------------------------------------------------------<br />ksh: cat *.passwd 2&gt;/dev/null | cut -d":" -f1 | sort | uniq<br />tcl: exec cat *.passwd 2&gt;/dev/null | cut -d: -f1 | sort | uniq<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '(..$1..)' with "{../$1..}"<br />-----------------------------------------------------------------<br />ksh: ps -eaf | awk '(print $1}' | grep $1 2&gt;&amp;1<br />tcl: exec ps -eaf | awk "{print /$1}" | grep $user_login_to_test<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace "..." with {...}<br />-----------------------------------------------------------------<br />ksh: grep "^$(user_login:" /etc/passwd /etc/shadow 2&gt;&amp;1<br />tcl: exec grep {^$user_login:} /etc/passwd /etc/shadow<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '...' with "..." or {...}<br />-----------------------------------------------------------------<br />ksh: grep 'Version' user.tcl<br />tcl: exec grep {Version} user.tcl<br />tcl: exec grep "Version" user.tcl<br />-----------------------------------------------------------------</p>
<p>&nbsp;</p>
<p>还有就是<a href="http://wiki.tcl.tk/1039">http://wiki.tcl.tk/1039</a>列出了使用exec的一些常见问题。</p>


    <small class="meta">August 03, 2010 | <a href='/tcl/tk/unix/linux/2010/08/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520tclexpect%25e4%25b8%25ad%25e5%2588%25a9%25e7%2594%25a8exec%25e8%25b0%2583%25e7%2594%25a8%25e7%25ae%25a1%25e9%2581%2593%2526quot%253b%257c%2526quot%253b%25e5%2592%258cawk%25e7%259a%2584%25e6%25b3%25a8%25e6%2584%258f%25e4%25ba%258b%25e9%25a1%25b9%250d%250a%2520%2520%25/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/bkup/2010/08/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520tclexpect%25e4%25b8%25ad%25e5%2588%25a9%25e7%2594%25a8exec%25e8%25b0%2583%25e7%2594%25a8%25e7%25ae%25a1%25e9%2581%2593%2526quot%253b%257c%2526quot%253b%25e5%2592%258cawk%25e7%259a%2584%25e6%25b3%25a8%25e6%2584%258f%25e4%25ba%258b%25e9%25a1%25b9%250d%250a%2520%2520%25/">Tcl/Expect中利用exec调用管道"|"和awk的注意事项</a></h2>

    <p>Tcl/Expect中利用exec调用稍微复杂的shell命令时，经常会遇到一些小问题，常见的就是pipeline(|)和awk。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用多个shell命令并使用|将其串接在一起时，需要注意的是必须在"|"前后加上空格" "，否则tcl/Expect会报奇怪的错。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用awk命令时，需要把awk的' '中的命令改为用" "，并把$1, $2之类的变量改为/$1, /$2。</p>
<p>&nbsp;</p>
<p>下面的ksh命令判断test_process是否在运行：</p>
<p>
<pre>ps -fu bonny|grep -v ps|grep MMCAP|grep -v grep|awk '{print $2}'</pre>
<p>&nbsp;</p>
<p>改为Tcl/Expect后，为：</p>
<p>
<pre>exec ps -fu $myname | grep -v ps | grep COOLrunMMCAP | grep -v grep | awk "{print /$2}"</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>另外，&nbsp;<a href="http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/">http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/</a>&nbsp;列出了一些ksh命令转换为tcl语句时经常遇到的问题（本人未曾验证过，请谨慎使用）。</p>
<p>&nbsp;</p>
<p>Here's some conversion rules that I have proven, if anyone has any more info ( in any fashion ) , please advise.</p>
<p>-----------------------------------------------------------------<br />Rule: Remove "<br />-----------------------------------------------------------------<br />ksh: cat *.passwd 2&gt;/dev/null | cut -d":" -f1 | sort | uniq<br />tcl: exec cat *.passwd 2&gt;/dev/null | cut -d: -f1 | sort | uniq<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '(..$1..)' with "{../$1..}"<br />-----------------------------------------------------------------<br />ksh: ps -eaf | awk '(print $1}' | grep $1 2&gt;&amp;1<br />tcl: exec ps -eaf | awk "{print /$1}" | grep $user_login_to_test<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace "..." with {...}<br />-----------------------------------------------------------------<br />ksh: grep "^$(user_login:" /etc/passwd /etc/shadow 2&gt;&amp;1<br />tcl: exec grep {^$user_login:} /etc/passwd /etc/shadow<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '...' with "..." or {...}<br />-----------------------------------------------------------------<br />ksh: grep 'Version' user.tcl<br />tcl: exec grep {Version} user.tcl<br />tcl: exec grep "Version" user.tcl<br />-----------------------------------------------------------------</p>
<p>&nbsp;</p>
<p>还有就是<a href="http://wiki.tcl.tk/1039">http://wiki.tcl.tk/1039</a>列出了使用exec的一些常见问题。</p>


    <small class="meta">August 03, 2010 | <a href='/bkup/2010/08/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520tclexpect%25e4%25b8%25ad%25e5%2588%25a9%25e7%2594%25a8exec%25e8%25b0%2583%25e7%2594%25a8%25e7%25ae%25a1%25e9%2581%2593%2526quot%253b%257c%2526quot%253b%25e5%2592%258cawk%25e7%259a%2584%25e6%25b3%25a8%25e6%2584%258f%25e4%25ba%258b%25e9%25a1%25b9%250d%250a%2520%2520%25/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/bkup/2010/07/22/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520expect_out%2528buffer%2529%25e4%25b8%25ad%25e5%258c%2585%25e5%2590%25absend%25e7%259a%2584%25e6%2595%25b0%25e6%258d%25ae%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">expect_out(buffer)中包含send的数据</a></h2>

    <p>&nbsp;</p>
<div>
<h1 id="zw-129f916d484wZwN43916c">expect_out(buffer)中包含send的数据</h1>
<p id="zw-129f9095e02SqGVnn3916c"><span id="zw-129f9081eab6rVFjl3916c">我一直以为在Expect中一旦执行send之后，</span><span id="zw-129f9081eab0LvB_n3916c">expect_out(buffer)就会被清空，直到有新的数据被填入，而恰恰就是这些数据被用在expect语句中。而今天在调试时发现的问题却令我大吃一惊，原来expect_out(buffer)不会被自动清空，而expect到的数据很可能不是你真正想要的，非常有可能是历史数据。</span><span id="zw-129f9095dc2QusTdp3916c"><a id="zw-129f9081f1cN6cQM93916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378">"expect_out(buffer) has the content of the previous send"</a>&nbsp;</span><span id="zw-129f9099e0e7RHXvZ3916c">一文</span><span id="zw-129f908ec42SOcAlE3916c">也指出了这个问题。</span></p>
<h4></h4>
<p id="zw-129f8fe7303mkLwZ3916c">&nbsp;</p>
<p id="zw-129f9000807KX0na03916c">&nbsp;</p>
<div id="zw-129f900a60bRM8gME3916c"><span id="zw-129f900a60cjSAA9Y3916c">比如在我的代码中，有如下片段：</span></div>
<div id="zw-129f90d0f92fIcFt93916c">
<pre>set prompt "#"
set lockfile "/root/tmp/.cool.lock" 
send "
if /[ -e $lockfile ]; then
        cat $lockfile
else 
        echo /"COOLID: $coolid/" &gt; $lockfile
        echo DONE!
fi
/r"
sleep 1 ;# necessary
expect {
        timeout {
                puts stderr "WARNING: $ME: cannot verify if the Linux AP is locked by other COOL session!";
                exit 2;
        }
       -re "COOLID: (/[1-9](/[0-9])*).*$prompt" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                puts stdout "expect_out(2,string)=$expect_out(2,string)"
                puts stdout "expect_out(3,string)=$expect_out(3,string)"
        }
        "DONE!"  ;# do nothing    
}
</pre>
<p>&nbsp;</p></div>
<div id="zw-129f90da827xtgjkZ3916c">无论$<span id="zw-129f90e1718nSGeGs3916c">lockfile是否存在，expect总会得到COOLID: 68，而expect_out(buffer)的出如下：</span></div>
<div id="zw-129f90b2476dtXxBy3916c"><span id="zw-129f90b2476oxjVv3916c"><br /></span></div>
<div id="zw-129f909c0f6KIKdhr3916c">
<pre>[root@bjvsmcl05 ~]# expect_out(buffer)= 
Last login: Fri Jul 23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]#
expect_out(0,string)=23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234</pre>
<p>&nbsp;</p></div>
<div id="zw-129f900a6154k9vr_3916c"></div>
<div id="zw-129f9105181rk1x3916c"><span id="zw-129f910e606ulQUt93916c">由此可见，由于</span><span id="zw-129f910e6063BF84J3916c">expect_out(buffer)中含有send的</span><span id="zw-129f910e666C0g_Fp3916c">echo "COOLID: 68"</span><span id="zw-129f910e607avGslF3916c">，因此永远都能匹配到这个数据。</span></div>
<div id="zw-129f912e050bsjfk33916c"><span id="zw-129f912e0513SIKJW3916c"><br /></span></div>
<div id="zw-129f912eb9dtLDgK3916c"><span id="zw-129f91d3abebAfTcg3916c">由于没有找到一种可以清空</span><span id="zw-129f91d3ac0nlD1Le3916c">expect_out(buffer)的方法，无法实时地将</span><span id="zw-129f91d3b3fb8YqAR3916c">expect_out(buffer)清空。</span><span id="zw-129f91d3ac3QUsX9u3916c">我能想到的解决方法有两种：一是更改send和expect的内容或方式，避免send的内容中出现expect的模式(pattern)。比如在我的程序中把上述代码段改为：</span></div>
<div id="zw-129f9158fb2IWSJh63916c">
<pre>set lockfile "/root/tmp/.cool.lock"   
send "cat $lockfile/r"
expect {
        -re "COOLID: (/[1-9](/[0-9])*)" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                if { [string compare $expect_out(1,string) $coolid] } {
                        puts stdout "ERROR: $ME: $pcname has been reserverd by COOL session $expect_out(1,string), please choose another Linux PC instead./n"
                        exit 2;
                }
        }
        "cat: $lockfile: No such file or directory*" {
                send "echo /"COOLID: $coolid/" &gt; $lockfile/r"
        }
}</pre>
<p>&nbsp;</p></div>
<div id="zw-129f9158fbfu4Bqbj3916c">就可以正常工作了。</div>
<div id="zw-129f915d6eatVpx_B3916c"></div>
<div id="zw-129f915ddd2JF4vnX3916c"><span id="zw-129f9193cbaAjqmW43916c">另一种方法是按照</span><a id="zw-129f9193cbcDH9aOQ3916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378"><span id="zw-129f9193cbdI49BAL3916c">"expect_out(buffer) has the content of the previous send"</span></a><span id="zw-129f9193cbfZkPuN3916c">的例子中的方法，set prompt，保持原始代码中send的内容不变，将expect的正则表达式改为&nbsp;</span><span id="zw-129f9193d30IyWK1h3916c">-re "fi(</span><span id="zw-129f9193d30nUI-eL3916c">.*)</span><span id="zw-129f9193d30LfTLJL3916c">$prompt"，如此一来希望的输出就在expect_out(1,string)中了，然后利用string或者lsearch命令对匹配到的数据进行分析。</span></div>
<div id="zw-129f91aeeb09SBIGu3916c"><span id="zw-129f91aeeb1poW5U3916c"><br /></span></div>
<div id="zw-129f91af02eanEEu3916c"><span id="zw-129f91af02eiHWs1G3916c">结论：今后在编写Expect脚本时，不仅要考虑每一步的send/expect，也还要考虑到这一步的expect的内容有可能出现在之前的历史数据中。</span></div>
<div><span id="zw-129f91af02eiHWs1G3916c"><br /></span></div>
<p id="zw-129f9158fca-kkq893916c">&nbsp;</p>
</div>
<p>&nbsp;</p>


    <small class="meta">July 22, 2010 | <a href='/bkup/2010/07/22/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520expect_out%2528buffer%2529%25e4%25b8%25ad%25e5%258c%2585%25e5%2590%25absend%25e7%259a%2584%25e6%2595%25b0%25e6%258d%25ae%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/tcl/tk/unix/linux/2010/07/22/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520expect_out%2528buffer%2529%25e4%25b8%25ad%25e5%258c%2585%25e5%2590%25absend%25e7%259a%2584%25e6%2595%25b0%25e6%258d%25ae%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">expect_out(buffer)中包含send的数据</a></h2>

    <p>&nbsp;</p>
<div>
<h1 id="zw-129f916d484wZwN43916c">expect_out(buffer)中包含send的数据</h1>
<p id="zw-129f9095e02SqGVnn3916c"><span id="zw-129f9081eab6rVFjl3916c">我一直以为在Expect中一旦执行send之后，</span><span id="zw-129f9081eab0LvB_n3916c">expect_out(buffer)就会被清空，直到有新的数据被填入，而恰恰就是这些数据被用在expect语句中。而今天在调试时发现的问题却令我大吃一惊，原来expect_out(buffer)不会被自动清空，而expect到的数据很可能不是你真正想要的，非常有可能是历史数据。</span><span id="zw-129f9095dc2QusTdp3916c"><a id="zw-129f9081f1cN6cQM93916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378">"expect_out(buffer) has the content of the previous send"</a>&nbsp;</span><span id="zw-129f9099e0e7RHXvZ3916c">一文</span><span id="zw-129f908ec42SOcAlE3916c">也指出了这个问题。</span></p>
<h4></h4>
<p id="zw-129f8fe7303mkLwZ3916c">&nbsp;</p>
<p id="zw-129f9000807KX0na03916c">&nbsp;</p>
<div id="zw-129f900a60bRM8gME3916c"><span id="zw-129f900a60cjSAA9Y3916c">比如在我的代码中，有如下片段：</span></div>
<div id="zw-129f90d0f92fIcFt93916c">
<pre>set prompt "#"
set lockfile "/root/tmp/.cool.lock" 
send "
if /[ -e $lockfile ]; then
        cat $lockfile
else 
        echo /"COOLID: $coolid/" &gt; $lockfile
        echo DONE!
fi
/r"
sleep 1 ;# necessary
expect {
        timeout {
                puts stderr "WARNING: $ME: cannot verify if the Linux AP is locked by other COOL session!";
                exit 2;
        }
       -re "COOLID: (/[1-9](/[0-9])*).*$prompt" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                puts stdout "expect_out(2,string)=$expect_out(2,string)"
                puts stdout "expect_out(3,string)=$expect_out(3,string)"
        }
        "DONE!"  ;# do nothing    
}
</pre>
<p>&nbsp;</p></div>
<div id="zw-129f90da827xtgjkZ3916c">无论$<span id="zw-129f90e1718nSGeGs3916c">lockfile是否存在，expect总会得到COOLID: 68，而expect_out(buffer)的出如下：</span></div>
<div id="zw-129f90b2476dtXxBy3916c"><span id="zw-129f90b2476oxjVv3916c"><br /></span></div>
<div id="zw-129f909c0f6KIKdhr3916c">
<pre>[root@bjvsmcl05 ~]# expect_out(buffer)= 
Last login: Fri Jul 23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]#
expect_out(0,string)=23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234</pre>
<p>&nbsp;</p></div>
<div id="zw-129f900a6154k9vr_3916c"></div>
<div id="zw-129f9105181rk1x3916c"><span id="zw-129f910e606ulQUt93916c">由此可见，由于</span><span id="zw-129f910e6063BF84J3916c">expect_out(buffer)中含有send的</span><span id="zw-129f910e666C0g_Fp3916c">echo "COOLID: 68"</span><span id="zw-129f910e607avGslF3916c">，因此永远都能匹配到这个数据。</span></div>
<div id="zw-129f912e050bsjfk33916c"><span id="zw-129f912e0513SIKJW3916c"><br /></span></div>
<div id="zw-129f912eb9dtLDgK3916c"><span id="zw-129f91d3abebAfTcg3916c">由于没有找到一种可以清空</span><span id="zw-129f91d3ac0nlD1Le3916c">expect_out(buffer)的方法，无法实时地将</span><span id="zw-129f91d3b3fb8YqAR3916c">expect_out(buffer)清空。</span><span id="zw-129f91d3ac3QUsX9u3916c">我能想到的解决方法有两种：一是更改send和expect的内容或方式，避免send的内容中出现expect的模式(pattern)。比如在我的程序中把上述代码段改为：</span></div>
<div id="zw-129f9158fb2IWSJh63916c">
<pre>set lockfile "/root/tmp/.cool.lock"   
send "cat $lockfile/r"
expect {
        -re "COOLID: (/[1-9](/[0-9])*)" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                if { [string compare $expect_out(1,string) $coolid] } {
                        puts stdout "ERROR: $ME: $pcname has been reserverd by COOL session $expect_out(1,string), please choose another Linux PC instead./n"
                        exit 2;
                }
        }
        "cat: $lockfile: No such file or directory*" {
                send "echo /"COOLID: $coolid/" &gt; $lockfile/r"
        }
}</pre>
<p>&nbsp;</p></div>
<div id="zw-129f9158fbfu4Bqbj3916c">就可以正常工作了。</div>
<div id="zw-129f915d6eatVpx_B3916c"></div>
<div id="zw-129f915ddd2JF4vnX3916c"><span id="zw-129f9193cbaAjqmW43916c">另一种方法是按照</span><a id="zw-129f9193cbcDH9aOQ3916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378"><span id="zw-129f9193cbdI49BAL3916c">"expect_out(buffer) has the content of the previous send"</span></a><span id="zw-129f9193cbfZkPuN3916c">的例子中的方法，set prompt，保持原始代码中send的内容不变，将expect的正则表达式改为&nbsp;</span><span id="zw-129f9193d30IyWK1h3916c">-re "fi(</span><span id="zw-129f9193d30nUI-eL3916c">.*)</span><span id="zw-129f9193d30LfTLJL3916c">$prompt"，如此一来希望的输出就在expect_out(1,string)中了，然后利用string或者lsearch命令对匹配到的数据进行分析。</span></div>
<div id="zw-129f91aeeb09SBIGu3916c"><span id="zw-129f91aeeb1poW5U3916c"><br /></span></div>
<div id="zw-129f91af02eanEEu3916c"><span id="zw-129f91af02eiHWs1G3916c">结论：今后在编写Expect脚本时，不仅要考虑每一步的send/expect，也还要考虑到这一步的expect的内容有可能出现在之前的历史数据中。</span></div>
<div><span id="zw-129f91af02eiHWs1G3916c"><br /></span></div>
<p id="zw-129f9158fca-kkq893916c">&nbsp;</p>
</div>
<p>&nbsp;</p>


    <small class="meta">July 22, 2010 | <a href='/tcl/tk/unix/linux/2010/07/22/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520expect_out%2528buffer%2529%25e4%25b8%25ad%25e5%258c%2585%25e5%2590%25absend%25e7%259a%2584%25e6%2595%25b0%25e6%258d%25ae%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/unix/linux/2010/07/20/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520here%2520document%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">Here Document</a></h2>

    </p>
<p id="zw-129ed8c28af2dvqtt15bea0" class="MsoNormal">
<h1>Here Document</h1></p>
<p>Syntax:</p>
<p><em>command &lt;&lt; label&nbsp;<br />input line 1&nbsp;<br />&hellip;&nbsp;<br />input line n&nbsp;<br />label</em></p>
<p>This allows you to redirect input to a shell script from within the shell script itself.</p>
<ul>
<li>&lt;&lt; label indicates that label marks the end of the here document</li>
<li>label must appear on a line by itself to end the here document</li>
<li>&lt;&lt; 'label' prevents the shell from doing parameter and command substitution in the here document</li>
<li>&lt;&lt;- label deletes leading tabs (but not spaces) from the here document</li>
</ul>
<h2>Here Document Example&nbsp;<br /><span>(from page 189 in "Learning the Korn Shell")</span></h2>
<p>pgmname=$1&nbsp;<br />for user in $(ypcat passwd | cut -f1 -d:)&nbsp;<br />do&nbsp;<br />&nbsp;&nbsp;mail $user &lt;&lt;- EOF<br />&nbsp;&nbsp;Dear user,&nbsp;<br />&nbsp;&nbsp;A new version of $pgmname has been installed&nbsp;<br />&nbsp;&nbsp;in $(whence $pgmname).&nbsp;<br />&nbsp;&nbsp;Regards,&nbsp;<br />&nbsp;&nbsp;Your friendly sysadmin&nbsp;<br />EOF&nbsp;<br />done</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>原文：&nbsp;</span><a href="http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html">http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html</a></p>


    <small class="meta">July 20, 2010 | <a href='/unix/linux/2010/07/20/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520here%2520document%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/bkup/2010/07/20/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520here%2520document%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">Here Document</a></h2>

    </p>
<p id="zw-129ed8c28af2dvqtt15bea0" class="MsoNormal">
<h1>Here Document</h1></p>
<p>Syntax:</p>
<p><em>command &lt;&lt; label&nbsp;<br />input line 1&nbsp;<br />&hellip;&nbsp;<br />input line n&nbsp;<br />label</em></p>
<p>This allows you to redirect input to a shell script from within the shell script itself.</p>
<ul>
<li>&lt;&lt; label indicates that label marks the end of the here document</li>
<li>label must appear on a line by itself to end the here document</li>
<li>&lt;&lt; 'label' prevents the shell from doing parameter and command substitution in the here document</li>
<li>&lt;&lt;- label deletes leading tabs (but not spaces) from the here document</li>
</ul>
<h2>Here Document Example&nbsp;<br /><span>(from page 189 in "Learning the Korn Shell")</span></h2>
<p>pgmname=$1&nbsp;<br />for user in $(ypcat passwd | cut -f1 -d:)&nbsp;<br />do&nbsp;<br />&nbsp;&nbsp;mail $user &lt;&lt;- EOF<br />&nbsp;&nbsp;Dear user,&nbsp;<br />&nbsp;&nbsp;A new version of $pgmname has been installed&nbsp;<br />&nbsp;&nbsp;in $(whence $pgmname).&nbsp;<br />&nbsp;&nbsp;Regards,&nbsp;<br />&nbsp;&nbsp;Your friendly sysadmin&nbsp;<br />EOF&nbsp;<br />done</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>原文：&nbsp;</span><a href="http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html">http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html</a></p>


    <small class="meta">July 20, 2010 | <a href='/bkup/2010/07/20/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520here%2520document%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/industry/2010/07/18/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e6%25b5%2585%25e6%259e%2590apple%2520iphone4%25e5%25a4%25a9%25e7%25ba%25bf%25e9%2597%25ae%25e9%25a2%2598%25e7%259a%2584%25e5%258d%25b1%25e6%259c%25ba%25e5%2585%25ac%25e5%2585%25b3%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">浅析Apple iPhone4天线问题的危机公关</a></h2>

    <p>&nbsp;</p>
<div>
<h1 id="zw-129e3d10a83QJWE-15bea0" style="text-align:center;">浅析A<span id="zw-129e3ac83d3_bPs9e15bea0">pple iPhone4天线问题的危机公关</span></h1>
<p id="zw-129e3ac83d3CFDfYy15bea0">&nbsp;</p>
<p id="zw-129e3ace966fegbrD15bea0"><span id="zw-129e3ace967cO2dP15bea0">iPhone4的天线问题甫一曝光，乔帮主就故态复萌了，拿出25年前打死不认亲生女儿的尽头，摆出死猪不怕开水烫的嘴脸，直言这个问题是由于用户的握手机的姿势不对引起的，言外之意就是碰到问题的这些用户太白痴，连如何正确握手机都得要别人教。很不幸的是，敝人也是习惯左手握手机，也是被乔帮主鄙视的那群人之一。</span></p>
<p id="zw-129e3bfa69dUjg1BQ15bea0">乔帮主的言论客观上激起了媒体和更多用户的不满，一大撮人巴不得Apple出事呢，现在苦苦等待了好几年的机会终于来到了，岂有坐视的道理？于是媒体铺天盖地的报道iPhone4的天线问题，科技专栏作家不断发表自己的看法，评测公司不断发布最新的评测&hellip;&hellip;</p>
<p id="zw-129e3c45695rq97mN15bea0">Apple深知此事不能不了了之，于是又宣称会尽快推出新的固件来修正之前iPhone的信号显示的bug&mdash;&mdash;iPhone4的信号之所以在握住某个点之后会大幅下降，主要原因是之前的信号显示是被夸大了的，也就是说之前的信号其实本来没有那么好，iPhone会故意将信号条设为满格，给用户以iPhone信号良好的假象。我相信这样做的绝不只Apple一家，其他厂家肯定也会搞这种小动作，只是程度不同而已。</p>
<p id="zw-129e3c5287eFTOTLj15bea0">但很快就有新的分析和测试出炉，固件升级不可能解决iPhone4掉话的问题，因为这个问题是由硬件引起的，确切而言是天线的设计缺陷&mdash;&mdash;软件不可能修复这种硬件的缺陷。而直到此时，Apple还没有同意免费为用户提供可以解决掉话问题的iPhone4保护套，用户还不得不掏30美元去买保护套。</p>
<p id="zw-129e3c8ff4erCaAr315bea0"><span id="zw-129e3d0c290zcxAbx15bea0">媒体继续穷追猛打，Apple必须得给出一个说法了。于是本周五，乔帮主专门召开了一个发布会来解释iPhone4的信号问题。一向喜欢在最后5分钟报道米国人民生活于水深火热之中的《新闻联播》当然不会放弃这样一个好机会，专门报道了这个消息&mdash;&mdash;</span><span id="zw-129e3d0c317LKBufn15bea0">迷信水果出品的一小撮不明真相的群众们，你们该醒醒了！即便牛B如iPhone4者，照样问题多多！还是赶紧买我天朝自产的XX吧！&hellip;&hellip;</span></p>
<p id="zw-129e3b99ae6BemeBk15bea0"><span id="zw-129e3d5aac4iEW14D15bea0">感谢CCAV，在我吃饭的时候报道了这条消息，吃完饭后我赶紧上网仔细看了看相关报道。今天在新浪科技上看到了《</span><a id="zw-129e4b8ff5frYBH3215bea0" title="直播实录：苹果iPhone 4信号问题发布会" href="http://tech.sina.com.cn/t/2010-07-17/01104438749.shtml" target="_blank"><span id="zw-129e4b8ff5eyLK11U15bea0">直播实录：苹果iPhone 4信号问题发布会</span></a><span id="zw-129e4b8ff5eNw8vUx15bea0">》。看完之后，坦白讲，我被乔帮主的真诚感动了。下面简单分析一下乔帮主的思路。</span></p>
<p id="zw-129e3d5b65dLO6jCz15bea0">&nbsp;</p>
<div id="zw-129e490e626TplBJT15bea0"><span id="zw-129e490e627NPEeNZ15bea0">首先，在所有智能手机中iPhone4拥有最好的销量和最佳的口碑&mdash;&mdash;iPhone4天赋异禀，瑕不掩瑜&mdash;&mdash;先定好基调很重要。</span></div>
<div id="zw-129e490f1dfAY5D2x15bea0"><span id="zw-129e490f1dfS9Qoiq15bea0"><br /></span></div>
<div id="zw-129e490e6272R8F15bea0"><span id="zw-129e490e627t0Jes415bea0">所有的手机都不是完美的，iPhone4不是，其他手机也不是，iPhone4存在的天线问题在其他手机上照样存在&mdash;&mdash;老乔我阴沟里翻船了，你们在岸上的也休想有好日子过！空口无凭，图片为证，老乔把其他手机的信号锐减的情况逐一摆在大家面前。需要注意的是老乔在演讲中提到说类似的问题也存在在诺基亚手机中，但在presentation中却不见又诺记的图片，因此我怀疑Apple至今肯定还没有诺记信号问题的切实证据，老乔故意制造烟雾弹。也有另外一种可能是，在乔帮主眼中，就诺基亚那样低劣的工业设计，根本不配是Apple的对手，因此在presentation中放它一码。</span></div>
<p id="zw-129e490e62eIdY0Ue15bea0">&nbsp;</p>
<p id="zw-129e490e62eNfX3gi15bea0">&nbsp;</p>
<div id="zw-129e49bafa92zPQZ-15bea0"><span id="zw-129e49bafaahdOOuP15bea0">接下来乔帮主介绍了Apple在手机天线上的投入&mdash;&mdash;神秘的&ldquo;black&rdquo;实验室、过硬的技术人员和大量的资金投入&mdash;&mdash;两层含义：我们很重视手机天线的设计的，尽管iPhone4的天线存在问题，但绝对不可能是大问题；我们有这么大的投入尚不能解决的问题，其他公司又怎么能彻底解决呢？</span></div>
<div id="zw-129e49bafaaUZbLpI15bea0"></div>
<div id="zw-129e49bafab_EUqk15bea0"><span id="zw-129e49bafabFvyYtb15bea0">然后乔帮主拿出了hard data来说明iPhone4的问题，除了掉话率iPhone4比iPhone 3GS稍高一点之外，返修率和退货率都要低很多。在这里，乔帮主的下面这张slide制作的实在是太有水平了，不仔细看怎么都不觉得他是在承认iPhone4的问题，分明是在炫耀他的成绩嘛！</span></div>
<div id="zw-129e49bafabCPL2At15bea0"><img src="http://i0.sinaimg.cn/IT/2010/0717/201071723455.jpeg" border="0" alt="" hspace="0" vspace="0" /></div>
<p id="zw-129e49bafb06hOzSx15bea0">&nbsp;</p>
<p id="zw-129e4a1188ftS6F15bea0">其实iPhone4的这些数据很难说明问题，因为一是因为它上市的时间太短了，而且上市的地区有限（iPhone 3GS是在欧美多国同时上市的，而iPhone4只有少数几个国家）；再者就是天线信号显示条都可以随意更改，这数据又有何不可呢？</p>
<div id="zw-129e4adebdb9JDl4Y15bea0"></div>
<div id="zw-129e4adebdcVQ5Xz15bea0"><span id="zw-129e4adebdcT8Nwro15bea0">至于问题的解决方法，乔帮主终于同意了免费为用户提供手机套&mdash;&mdash;这是对他们最为有利的方案，如果接受媒体和业内人士的召回的建议，Apple的损失将是惨重的。为了进一步打消某些人仍然抱有的召回的幻想，乔帮主在Q&amp;A的环节中干脆暗示召回也很难解决问题，原因就是这是智能手机的通病，不可能在短期内有最终解决方案。</span></div>
<div id="zw-129e4adebdcth46IY15bea0"></div>
<div id="zw-129e4adebdcmY6Yds15bea0"><span id="zw-129e4adebddh5-O0815bea0">最后，乔帮主竟然主动爆出了正在调查iPhone4的距离感应器的问题&mdash;&mdash;如果有谁还幻想着在天线问题过去之后再炒作距离感应器的问题，还是省省吧！</span></div>
<div id="zw-129e4adebddBfU2VJ15bea0"></div>
<div id="zw-129e4adebdeVf30_J15bea0"><span id="zw-129e4adebdecOwZat15bea0">另外，乔帮主还深情的自我表白：&ldquo;我们这样做的原因是，我们爱自己的用户；如果我们把事情搞砸了，我们会自我检讨，并更加努力地工作。当我们取得成功时，我们所获得的奖励就是留住了用户。或许我们本应让公关人员来打发这些麻烦事，但我们没有，而是亲自来解决。所以，在过去22天时间里，我们一直都努力解决这个问题。我们认为，已经抓住了问题的核心。&rdquo;</span></div>
<div id="zw-129e4adebdeXJLvPH15bea0"></div>
<div id="zw-129e4adebdfA85PY215bea0"><span id="zw-129e4adebdfcUIB8Z15bea0">这是一个堪称经典的危机公关演讲！</span></div>
<div id="zw-129e4aeace8Bm15Ac15bea0"><span id="zw-129e4aeace8bX2vv15bea0"><br /></span></div>
<div id="zw-129e4aeaf80JHU7o15bea0"><span id="zw-129e4aeaf80v6SWKE15bea0">联想起最近国内的唐俊面对&ldquo;学历门&rdquo;的态度，汪晖教授面对&ldquo;抄袭门&rdquo;的反应，乔帮主的水平实在比他们高出一个档次&mdash;&mdash;既承认了自己的错误，又捎带打击了对手，既安抚了消费者和媒体，又能使自己的利益最大化。谢谢乔帮主又给我们上了一课！</span></div>
<div><span id="zw-129e4aeaf80v6SWKE15bea0"><br /></span></div>
<p id="zw-129e4adebe7O4HTKQ15bea0">PS:</p>
<p>&nbsp;</p>
<p>根据Apple的声明，很多人推测Apple很可能在10月份推出重新设计的iPhone4.我认为这很有可能，因Steve Jobs不可能容忍有瑕疵的产品在市场上销售太久。另外，至于有很多人质疑乔帮主在iPhone4发部前就已经知道它的天线问题，我觉得可能性也不是很大，凭着乔帮主要求Mac开发者搞半年才能拿出一个入他老人家法眼的的滚动条而最终发布时又不得不把这滚动条放弃的高要求，很难想象他会容忍有问题的iPhone流入市场&mdash;&mdash;即使事先他真的已经知道了这个问题，估计那也是离WWDC很近的时间内才知道的，箭在弦上不得不发了&hellip;&hellip;</p>
</div>
<p>&nbsp;</p>


    <small class="meta">July 18, 2010 | <a href='/industry/2010/07/18/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e6%25b5%2585%25e6%259e%2590apple%2520iphone4%25e5%25a4%25a9%25e7%25ba%25bf%25e9%2597%25ae%25e9%25a2%2598%25e7%259a%2584%25e5%258d%25b1%25e6%259c%25ba%25e5%2585%25ac%25e5%2585%25b3%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

  <div class="post">
    <h2><a href="/bkup/2010/07/18/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e6%25b5%2585%25e6%259e%2590apple%2520iphone4%25e5%25a4%25a9%25e7%25ba%25bf%25e9%2597%25ae%25e9%25a2%2598%25e7%259a%2584%25e5%258d%25b1%25e6%259c%25ba%25e5%2585%25ac%25e5%2585%25b3%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/">浅析Apple iPhone4天线问题的危机公关</a></h2>

    <p>&nbsp;</p>
<div>
<h1 id="zw-129e3d10a83QJWE-15bea0" style="text-align:center;">浅析A<span id="zw-129e3ac83d3_bPs9e15bea0">pple iPhone4天线问题的危机公关</span></h1>
<p id="zw-129e3ac83d3CFDfYy15bea0">&nbsp;</p>
<p id="zw-129e3ace966fegbrD15bea0"><span id="zw-129e3ace967cO2dP15bea0">iPhone4的天线问题甫一曝光，乔帮主就故态复萌了，拿出25年前打死不认亲生女儿的尽头，摆出死猪不怕开水烫的嘴脸，直言这个问题是由于用户的握手机的姿势不对引起的，言外之意就是碰到问题的这些用户太白痴，连如何正确握手机都得要别人教。很不幸的是，敝人也是习惯左手握手机，也是被乔帮主鄙视的那群人之一。</span></p>
<p id="zw-129e3bfa69dUjg1BQ15bea0">乔帮主的言论客观上激起了媒体和更多用户的不满，一大撮人巴不得Apple出事呢，现在苦苦等待了好几年的机会终于来到了，岂有坐视的道理？于是媒体铺天盖地的报道iPhone4的天线问题，科技专栏作家不断发表自己的看法，评测公司不断发布最新的评测&hellip;&hellip;</p>
<p id="zw-129e3c45695rq97mN15bea0">Apple深知此事不能不了了之，于是又宣称会尽快推出新的固件来修正之前iPhone的信号显示的bug&mdash;&mdash;iPhone4的信号之所以在握住某个点之后会大幅下降，主要原因是之前的信号显示是被夸大了的，也就是说之前的信号其实本来没有那么好，iPhone会故意将信号条设为满格，给用户以iPhone信号良好的假象。我相信这样做的绝不只Apple一家，其他厂家肯定也会搞这种小动作，只是程度不同而已。</p>
<p id="zw-129e3c5287eFTOTLj15bea0">但很快就有新的分析和测试出炉，固件升级不可能解决iPhone4掉话的问题，因为这个问题是由硬件引起的，确切而言是天线的设计缺陷&mdash;&mdash;软件不可能修复这种硬件的缺陷。而直到此时，Apple还没有同意免费为用户提供可以解决掉话问题的iPhone4保护套，用户还不得不掏30美元去买保护套。</p>
<p id="zw-129e3c8ff4erCaAr315bea0"><span id="zw-129e3d0c290zcxAbx15bea0">媒体继续穷追猛打，Apple必须得给出一个说法了。于是本周五，乔帮主专门召开了一个发布会来解释iPhone4的信号问题。一向喜欢在最后5分钟报道米国人民生活于水深火热之中的《新闻联播》当然不会放弃这样一个好机会，专门报道了这个消息&mdash;&mdash;</span><span id="zw-129e3d0c317LKBufn15bea0">迷信水果出品的一小撮不明真相的群众们，你们该醒醒了！即便牛B如iPhone4者，照样问题多多！还是赶紧买我天朝自产的XX吧！&hellip;&hellip;</span></p>
<p id="zw-129e3b99ae6BemeBk15bea0"><span id="zw-129e3d5aac4iEW14D15bea0">感谢CCAV，在我吃饭的时候报道了这条消息，吃完饭后我赶紧上网仔细看了看相关报道。今天在新浪科技上看到了《</span><a id="zw-129e4b8ff5frYBH3215bea0" title="直播实录：苹果iPhone 4信号问题发布会" href="http://tech.sina.com.cn/t/2010-07-17/01104438749.shtml" target="_blank"><span id="zw-129e4b8ff5eyLK11U15bea0">直播实录：苹果iPhone 4信号问题发布会</span></a><span id="zw-129e4b8ff5eNw8vUx15bea0">》。看完之后，坦白讲，我被乔帮主的真诚感动了。下面简单分析一下乔帮主的思路。</span></p>
<p id="zw-129e3d5b65dLO6jCz15bea0">&nbsp;</p>
<div id="zw-129e490e626TplBJT15bea0"><span id="zw-129e490e627NPEeNZ15bea0">首先，在所有智能手机中iPhone4拥有最好的销量和最佳的口碑&mdash;&mdash;iPhone4天赋异禀，瑕不掩瑜&mdash;&mdash;先定好基调很重要。</span></div>
<div id="zw-129e490f1dfAY5D2x15bea0"><span id="zw-129e490f1dfS9Qoiq15bea0"><br /></span></div>
<div id="zw-129e490e6272R8F15bea0"><span id="zw-129e490e627t0Jes415bea0">所有的手机都不是完美的，iPhone4不是，其他手机也不是，iPhone4存在的天线问题在其他手机上照样存在&mdash;&mdash;老乔我阴沟里翻船了，你们在岸上的也休想有好日子过！空口无凭，图片为证，老乔把其他手机的信号锐减的情况逐一摆在大家面前。需要注意的是老乔在演讲中提到说类似的问题也存在在诺基亚手机中，但在presentation中却不见又诺记的图片，因此我怀疑Apple至今肯定还没有诺记信号问题的切实证据，老乔故意制造烟雾弹。也有另外一种可能是，在乔帮主眼中，就诺基亚那样低劣的工业设计，根本不配是Apple的对手，因此在presentation中放它一码。</span></div>
<p id="zw-129e490e62eIdY0Ue15bea0">&nbsp;</p>
<p id="zw-129e490e62eNfX3gi15bea0">&nbsp;</p>
<div id="zw-129e49bafa92zPQZ-15bea0"><span id="zw-129e49bafaahdOOuP15bea0">接下来乔帮主介绍了Apple在手机天线上的投入&mdash;&mdash;神秘的&ldquo;black&rdquo;实验室、过硬的技术人员和大量的资金投入&mdash;&mdash;两层含义：我们很重视手机天线的设计的，尽管iPhone4的天线存在问题，但绝对不可能是大问题；我们有这么大的投入尚不能解决的问题，其他公司又怎么能彻底解决呢？</span></div>
<div id="zw-129e49bafaaUZbLpI15bea0"></div>
<div id="zw-129e49bafab_EUqk15bea0"><span id="zw-129e49bafabFvyYtb15bea0">然后乔帮主拿出了hard data来说明iPhone4的问题，除了掉话率iPhone4比iPhone 3GS稍高一点之外，返修率和退货率都要低很多。在这里，乔帮主的下面这张slide制作的实在是太有水平了，不仔细看怎么都不觉得他是在承认iPhone4的问题，分明是在炫耀他的成绩嘛！</span></div>
<div id="zw-129e49bafabCPL2At15bea0"><img src="http://i0.sinaimg.cn/IT/2010/0717/201071723455.jpeg" border="0" alt="" hspace="0" vspace="0" /></div>
<p id="zw-129e49bafb06hOzSx15bea0">&nbsp;</p>
<p id="zw-129e4a1188ftS6F15bea0">其实iPhone4的这些数据很难说明问题，因为一是因为它上市的时间太短了，而且上市的地区有限（iPhone 3GS是在欧美多国同时上市的，而iPhone4只有少数几个国家）；再者就是天线信号显示条都可以随意更改，这数据又有何不可呢？</p>
<div id="zw-129e4adebdb9JDl4Y15bea0"></div>
<div id="zw-129e4adebdcVQ5Xz15bea0"><span id="zw-129e4adebdcT8Nwro15bea0">至于问题的解决方法，乔帮主终于同意了免费为用户提供手机套&mdash;&mdash;这是对他们最为有利的方案，如果接受媒体和业内人士的召回的建议，Apple的损失将是惨重的。为了进一步打消某些人仍然抱有的召回的幻想，乔帮主在Q&amp;A的环节中干脆暗示召回也很难解决问题，原因就是这是智能手机的通病，不可能在短期内有最终解决方案。</span></div>
<div id="zw-129e4adebdcth46IY15bea0"></div>
<div id="zw-129e4adebdcmY6Yds15bea0"><span id="zw-129e4adebddh5-O0815bea0">最后，乔帮主竟然主动爆出了正在调查iPhone4的距离感应器的问题&mdash;&mdash;如果有谁还幻想着在天线问题过去之后再炒作距离感应器的问题，还是省省吧！</span></div>
<div id="zw-129e4adebddBfU2VJ15bea0"></div>
<div id="zw-129e4adebdeVf30_J15bea0"><span id="zw-129e4adebdecOwZat15bea0">另外，乔帮主还深情的自我表白：&ldquo;我们这样做的原因是，我们爱自己的用户；如果我们把事情搞砸了，我们会自我检讨，并更加努力地工作。当我们取得成功时，我们所获得的奖励就是留住了用户。或许我们本应让公关人员来打发这些麻烦事，但我们没有，而是亲自来解决。所以，在过去22天时间里，我们一直都努力解决这个问题。我们认为，已经抓住了问题的核心。&rdquo;</span></div>
<div id="zw-129e4adebdeXJLvPH15bea0"></div>
<div id="zw-129e4adebdfA85PY215bea0"><span id="zw-129e4adebdfcUIB8Z15bea0">这是一个堪称经典的危机公关演讲！</span></div>
<div id="zw-129e4aeace8Bm15Ac15bea0"><span id="zw-129e4aeace8bX2vv15bea0"><br /></span></div>
<div id="zw-129e4aeaf80JHU7o15bea0"><span id="zw-129e4aeaf80v6SWKE15bea0">联想起最近国内的唐俊面对&ldquo;学历门&rdquo;的态度，汪晖教授面对&ldquo;抄袭门&rdquo;的反应，乔帮主的水平实在比他们高出一个档次&mdash;&mdash;既承认了自己的错误，又捎带打击了对手，既安抚了消费者和媒体，又能使自己的利益最大化。谢谢乔帮主又给我们上了一课！</span></div>
<div><span id="zw-129e4aeaf80v6SWKE15bea0"><br /></span></div>
<p id="zw-129e4adebe7O4HTKQ15bea0">PS:</p>
<p>&nbsp;</p>
<p>根据Apple的声明，很多人推测Apple很可能在10月份推出重新设计的iPhone4.我认为这很有可能，因Steve Jobs不可能容忍有瑕疵的产品在市场上销售太久。另外，至于有很多人质疑乔帮主在iPhone4发部前就已经知道它的天线问题，我觉得可能性也不是很大，凭着乔帮主要求Mac开发者搞半年才能拿出一个入他老人家法眼的的滚动条而最终发布时又不得不把这滚动条放弃的高要求，很难想象他会容忍有问题的iPhone流入市场&mdash;&mdash;即使事先他真的已经知道了这个问题，估计那也是离WWDC很近的时间内才知道的，箭在弦上不得不发了&hellip;&hellip;</p>
</div>
<p>&nbsp;</p>


    <small class="meta">July 18, 2010 | <a href='/bkup/2010/07/18/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e6%25b5%2585%25e6%259e%2590apple%2520iphone4%25e5%25a4%25a9%25e7%25ba%25bf%25e9%2597%25ae%25e9%25a2%2598%25e7%259a%2584%25e5%258d%25b1%25e6%259c%25ba%25e5%2585%25ac%25e5%2585%25b3%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520/#disqus_thread'>View Comments</a></small>
  </div>

</div>

<div class='paging'>
  
    <a href='/page20' class='older'>Older Posts</a>
  

  
    <a href='/page18' class='newer'>Newer Posts</a>
  

  
  <div class='clear'></div>
</div>

        </div>
      </div>

      <div id="bottom" class="span8 offset4">
        <div class="well">
          <a href="/about/">About</a> |
          <a href="/archives/">Archives</a> |
          <a href="/atom.xml">feed</a>
        </div>
      </div>
    </div>
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="/javascripts/bootstrap.min.js"></script>

  <!-- Google Analytics Code -->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-9947336-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 
          'http://www') + '.google-analytics.com/ga.js';
      ga.setAttribute('async', 'true');
      document.documentElement.firstChild.appendChild(ga);
    })();

  </script>
</body>
</html>

