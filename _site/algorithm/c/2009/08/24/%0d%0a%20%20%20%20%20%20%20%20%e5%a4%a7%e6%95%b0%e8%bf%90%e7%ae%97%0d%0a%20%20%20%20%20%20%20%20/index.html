<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bo Yang - 大数运算 </title>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <meta name="verify-v1" content="fI45uNHehVNiO9Dt0Fp7XnsV0Z/ozBTkPoS6RlYAe50=" />
  <meta name="y_key" content="6c948e75a617b12d" />
  <meta name='technorati-claim' content='8QN7CWNH8BSJ' />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" media="screen" href="/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/css/default.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Bo Yang's blog" />
</head>

<body class='blog'>
  <div class="container">
    <div class="row">
      <div class="span4 sidebar affix">
        <div class="well">
          <h2 class='site-title'>
            <a href="http://bo-yang.github.io">Bo Yang</a>
          </h2>

		  <p><i>You got to make the back of the fence that nobody will see just as good looking as the front of the fence.</i></p>

          <ul id="navigation" class="clearfix">
            <li class='about'><a href='/about/'>About</a></li>
            <li class='archives'><a href='/archives/'>Archives</a></li>
            <li class="github"><a href="http://github.com/bo-yang" rel='me' class='url'>@github</a></li>
          </ul>
        </div>
      </div>
      <div class="span8 main offset4">
        <div class="well">
          <div class="post">
    <h1>大数运算</h1>
    <p>下面这段程序包含了大数的加、减、乘运算的代码，除法运算尚在研究中。</p>
<p>&nbsp;</p>
<p>
<pre>/*
 * =====================================================================================
 *
 *       Filename:  LargeNumOp.c
 *
 *    Description:  The regular version of Large Number Multiplication.
 *
 *        Version:  1.0
 *        Created:  08/23/2009 07:02:48 PM
 *       Revision:  none
 *       Compiler:  gcc
 *
 *         Author:  Bonn Yang 
 *        Company:  
 *
 * =====================================================================================
 */
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
/* 
 * Large number multiplication. 
 *	a*b=c
 * The product stores in c.
 */ 
void multiply(char* a,char* b,char* c)
{
    int i,j,ca,cb,* s;
    ca=strlen(a);
    cb=strlen(b);
    s=(int*)malloc(sizeof(int)*(ca+cb));
    for (i=0;i&lt;ca+cb;i++)
        s[i]=0;
    for (i=0;i&lt;ca;i++)
        for (j=0;j&lt;cb;j++)
            s[i+j+1]+=(a[i]-'0')*(b[j]-'0');
    for (i=ca+cb-1;i&gt;=0;i--)
        if (s[i]&gt;=10)
        {
            s[i-1]+=s[i]/10;
            s[i]%=10;
        }
    i=0;
    while (s[i]==0)
        i++;
    for (j=0;i&lt;ca+cb;i++,j++)
        c[j]=s[i]+'0';
    c[j]='/0';
    free(s);
}
/* Large number addition 
 * 		a+b=c
 */
void add(char* a, char* b, char* c)
{
	int i,j,ca,cb,rlen,* s;
    ca=strlen(a);
    cb=strlen(b);
	rlen=((ca&gt;cb)?ca:cb)+1;		/* len of result */
    s=(int*)malloc(sizeof(int)*rlen);
    for (i=0;i&lt;rlen;i++)
        s[i]=0;
	if(ca&gt;cb)
	{
    	for(i=0;i&lt;ca-cb;i++)
			s[i+1]=a[i]-'0';
		for(i=ca-cb;i&lt;ca;i++)
			s[i+1]=(a[i]-'0')+(b[i-ca+cb]-'0');
	} 
	else 
	{
		for(i=0;i&lt;cb-ca;i++)
			s[i+1]=b[i]-'0';
		for(i=cb-ca;i&lt;cb;i++)
			s[i+1]=(a[i-cb+ca]-'0')+(b[i]-'0');
	} 
	
    for (i=rlen-1;i&gt;=0;i--)
        if (s[i]&gt;=10)
        {
            s[i-1]+=s[i]/10;
            s[i]%=10;
        }
    i=0;
    while (s[i]==0)
        i++;
	for (j=0;i&lt;rlen;i++,j++)
        c[j]=s[i]+'0';
    c[j]='/0';
    free(s);
}
/* Large number substraction 
 * 		a-b=c
 */
void sub(char* a,char* b,char* c)
{
	int i,j,ca,cb,rlen,* s;
    ca=strlen(a);
    cb=strlen(b);
	rlen=((ca&gt;cb)?ca:cb)+1;		/* len of result, the first byte is negative or positive sign */
    s=(int*)malloc(sizeof(int)*rlen);
    for (i=0;i&lt;rlen;i++)
        s[i]=0;
	if(ca&gt;cb)
	{
		s[0]='+';
    	for(i=ca-1;i&gt;=ca-cb;i--)
		{
			if(a[i]&gt;b[i-ca+cb])
			{
				s[i+1]=(a[i]-'0')-(b[i-ca+cb]-'0');
			}
			else if(a[i]&lt;b[i-ca+cb])
			{
				s[i+1]=(a[i]-'0'+10)-(b[i-ca+cb]-'0');
				a[i-1]-=1;
			}
			else
				s[i+1]=0;
		}
		for(i=ca-cb-1;i&gt;=1;i--)
		{
			if(a[i]&gt;0)
			{
				s[i+1]=(a[i]-'0');
			}
			else if(a[i]&lt;0)
			{
				s[i+1]=a[i]-'0'+10;
				a[i-1]-=1;
			}
			else
				s[i+1]=0;
		}
		s[1]=a[i]-'0';
	} 
	else if(ca&lt;cb)
	{
		s[0]='-';
		for(i=cb-1;i&gt;cb-ca-1;i--)
		{
			if(b[i]&gt;a[i-cb+ca])
			{
				s[i+1]=(b[i]-'0')-(a[i-cb+ca]-'0');
			}
			else if(b[i]&lt;a[i-ca+cb])
			{
				s[i+1]=(b[i]-'0'+10)-(a[i-cb+ca]-'0');
				b[i-1]-=1;
			}
			else
				s[i+1]=0;
		}
		for(i=cb-ca-1;i&gt;=1;i--)
		{
			if(b[i]&gt;0)
			{
				s[i+1]=(b[i]-'0');
			}
			else if(b[i]&lt;0)
			{
				s[i+1]=b[i]-'0'+10;
				b[i-1]-=1;
			}
			else
				s[i+1]=0;
		}
		s[1]=b[i]-'0';
	} 
	else	/* ca==cb */
	{
		if(strcmp(a,b)&gt;0)		/* a&gt;b */
		{
			s[0]='+';
			for(i=ca-1;i&gt;=1;i--)
			{
				if(a[i]&gt;b[i])
				{
					s[i+1]=(a[i]-'0')-(b[i]-'0');
				}
				else if(a[i]&lt;b[i])
				{
					s[i+1]=(a[i]-'0'+10)-(b[i]-'0');
					a[i-1]-=1;
				}
				else
					s[i+1]=0;
			}
			s[1]=(a[i]-'0')-(b[i]-'0');
		}
		else if(strcmp(a,b)&lt;0)	/* a&lt;b */
		{
			s[0]='-';
			for(i=ca-1;i&gt;=1;--i)
			{
				if(b[i]&gt;a[i])
				{
					s[i+1]=(b[i]-'0')-(a[i]-'0');
				}
				else if(b[i]&lt;a[i])
				{
					s[i+1]=(b[i]-'0'+10)-(a[i]-'0');
					b[i-1]-=1;
				}
				else
					s[i+1]=0;
			}
			s[1]=(b[i]-'0')-(a[i]-'0');
		}
		else					/* a==b */
		{
			c[0]='+';
			c[1]='0';
			c[2]='/0';
			free(s);
		}
	}
	c[0]=s[0];
    i=1;j=1;
    while ((s[i]==0) &amp;&amp; (i&lt;rlen))
        i++;
	if(i!=rlen)	/* result is not zero */
	{
		for (j=1;i&lt;rlen;i++,j++)
		{
			if(s[i]&lt;0)
				c[j]='0'-s[i];
			else
        		c[j]=s[i]+'0';
		}
	} else {	/* result is zero */
		c[j++]='0';
	}
    c[j]='/0';
    free(s);
}
int main()
{
	char a[1024]={'/0'};
	char b[1024]={'/0'};
	char c[1024]={'/0'};
	printf(&quot;Enter two numbers:/n&quot;);
	gets(a);
	gets(b);
	multiply(a,b,c);
	printf(&quot;%s * %s = %s/n&quot;,a,b,c);
	add(a,b,c);
	printf(&quot;%s + %s = %s/n&quot;,a,b,c);
	sub(a,b,c);
	printf(&quot;%s - %s = %s/n&quot;,a,b,c);
	
	return 0;
}
</pre></p>
<p>&nbsp;</p>

</div>

<small class="meta">Posted August 24, 2009</small>

<div id="comments">
  <h3>Comments</h3>

  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'boyang';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        </div>
      </div>

      <div id="bottom" class="span8 offset4">
        <div class="well">
          <a href="/about/">About</a> |
          <a href="/archives/">Archives</a> |
          <a href="/atom.xml">feed</a>
        </div>
      </div>
    </div>
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="/javascripts/bootstrap.min.js"></script>

  <!-- Google Analytics Code -->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-9947336-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 
          'http://www') + '.google-analytics.com/ga.js';
      ga.setAttribute('async', 'true');
      document.documentElement.firstChild.appendChild(ga);
    })();

  </script>
</body>
</html>

