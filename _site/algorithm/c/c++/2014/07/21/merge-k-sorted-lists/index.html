<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Merge K Sorted Lists &#8211; Bo's Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Bo&#39;s blog.">
    <meta name="author" content="Bo Yang">
    <meta name="keywords" content="Algorithm, C/C++">
    <link rel="canonical" href="http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Bo's Blog" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?201602012235" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    

    <!-- Google Prettify -->
    <link href="http://www.bo-yang.net//assets/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">

    <!-- MathJax -->
    
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <!-- Verifications -->
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Merge K Sorted Lists">
    <meta property="og:description" content="Bo&#39;s blog.">
    <meta property="og:url" content="http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/">
    <meta property="og:site_name" content="Bo&#39;s Blog">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@bonnyang" />
    
    <meta name="twitter:title" content="Merge K Sorted Lists" />
    <meta name="twitter:description" content="Bo's blog." />
    <meta name="twitter:url" content="http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-50551633-1', 'auto');
       ga('send', 'pageview');
    </script>
    
</head>

<body class="site">

	
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
        <a href="http://www.bo-yang.net/" class="site-title"><b>Bo's Blog</b></a>
      <nav class="site-nav">
        
    

    

    
        <a href="/archive/">Archive</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    

    

    

    
        <a href="/tags/">Tags</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    
        <a href="/about/">About Me</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    
        <a href="/contact/">Contact</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="social-icons-right">
    
      <a class="fa fa-github" href="https://github.com/bo-yang"></a>
    
    
    
      <a class="fa fa-stack-overflow" href="https://stackoverflow.com/users/boyang"></a>
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
      <a class="fa fa-twitter" href="https://twitter.com/bonnyang"></a>
    
    
    
    
    
      <a class="fa fa-envelope" href="mailto:bonny95@gmail.com"></a>
    
    
      <a class="fa fa-linkedin" href="https://www.linkedin.com/in/boyanglink"></a>
    
    
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Merge K Sorted Lists</h1>
  <span class="post-meta">Jul 21, 2014</span><br>
  
  <span class="post-meta small">
  
    3 minute read
  
  </span>
</div>

<article class="post-content">
  <h4 id="contents">Contents</h4>

<ol>
  <li><a href="#naive_method">Naive Method</a></li>
  <li><a href="#divide_conquer">Divide-and-Conquer Algorithm</a></li>
  <li><a href="#heap">Non-Recursive Method</a></li>
</ol>

<p>The <a href="https://oj.leetcode.com/problems/merge-k-sorted-lists/">Merge <code class="highlighter-rouge">k</code> Sorted Lists</a> is:</p>

<blockquote>
  <p>Merge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p>
</blockquote>

<p>In this problem, the sorted lists are stored in a vector, i.e. <code class="highlighter-rouge">vector&lt;ListNode*&gt;</code>. Assume the longest list contains <code class="highlighter-rouge">n</code> elements.</p>

<h3 id="a-namenaivemethodnaive-methoda"><a name="naive_method">Naive Method</a></h3>

<p>The naive method of merging <code class="highlighter-rouge">k</code> sorted lists is: iteratively compare the head elements of the <code class="highlighter-rouge">k</code> lists, find the smallest node, append this node to the merged list and forward that list by one step. Then repeat above step until all lists reach the end. Obviously, since in every iteration <code class="highlighter-rouge">k</code> comparisons are needed, and the longest list has <code class="highlighter-rouge">n</code> elements, therefore, the time complexity is \( O(k^{nk}) \) - the worst case is all lists have <code class="highlighter-rouge">n</code> elements, so for the total <code class="highlighter-rouge">nk</code> elements, totally \( k^{nk} \) comparisons are needed to merge them into one list.</p>

<h3 id="a-namedivideconquerdivide-and-conquer-algorithma"><a name="divide_conquer">Divide-and-Conquer Algorithm</a></h3>

<p>Other than exponential time complexity, a much better method is to use divide-and-conquer. Since merging two sorted lists is easy, we can recursively divide the <code class="highlighter-rouge">k</code> lists into two parts until there are no more than two lists. Then we can use a merge method similiar to the merge sort to merge the two lists together.</p>

<p>Assume the longest list contains <code class="highlighter-rouge">n</code> elements, the time required for dividing and merging lists is \( T(k)=2T(k/2)+O(nk) \). According to the Master Theorem, the time complexity is \( O(nk \log k) \). The space complexity of this algorithm is \( O(1) \).</p>

<p>Following is my C++ implementation of the divide-conquer method.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class Solution {
public:
    ListNode *mergeKLists(vector&lt;ListNode *&gt; &amp;lists) {
		if(lists.size()==0)
            return NULL;
        if(lists.size()==1)
            return lists[0];

		return divideConquerLists(lists,0,lists.size()-1);
    }

	ListNode* divideConquerLists(vector&lt;ListNode *&gt; &amp;lists, int start, int end) {
		if(start+1&lt;end) {
			int mid=(start+end)/2;
			ListNode* head1=divideConquerLists(lists,start,mid);
			ListNode* head2=divideConquerLists(lists,mid+1,end);
			return mergeTwoLists(head1,head2);
		} else if(start+1==end) {
			return mergeTwoLists(lists[start],lists[end]);
		} else if(start==end) {
			return lists[start];
		}
	}

	ListNode* mergeTwoLists(ListNode* head1, ListNode* head2) {
		if(head1==NULL)
			return head2;
		if(head2==NULL)
			return head1;
	
		ListNode* pre_head=new ListNode(-1);
		ListNode* pre=pre_head;
		ListNode* node1=head1;
		ListNode* node2=head2;
		while(node1!=NULL &amp;&amp; node2!=NULL) {
			if(node1-&gt;val &lt; node2-&gt;val) {
				pre-&gt;next=node1;
				node1=node1-&gt;next;
			} else {
				pre-&gt;next=node2;
				node2=node2-&gt;next;
			}
			pre=pre-&gt;next;
		}
		while(node1!=NULL) {
			pre-&gt;next=node1;
			node1=node1-&gt;next;
			pre=pre-&gt;next;
		}
		while(node2!=NULL) {
			pre-&gt;next=node2;
			node2=node2-&gt;next;
			pre=pre-&gt;next;
		}
		pre-&gt;next=NULL;

		ListNode* head=pre_head-&gt;next;
		delete pre_head;

		return head;
	}
};
</code></pre>
</div>

<h3 id="a-nameheapnon-recursive-methoda"><a name="heap">Non-Recursive Method</a></h3>

<p>In addition to the recursive divide-conquer method, there is also a non-recursive method. We can use a maximum <code class="highlighter-rouge">k</code>-element heap(in C++, <code class="highlighter-rouge">priority_queue</code>) to merge the <code class="highlighter-rouge">k</code> lists. The strategy is:</p>

<ol>
  <li>Create a heap to store <code class="highlighter-rouge">ListNode*</code>, which should sort list nodes in the ascending order or node values.</li>
  <li>Insert the first node(head) of each list into the heap, so that we store all the <code class="highlighter-rouge">k</code> entries in the heap.</li>
  <li>Get the top element in heap and add in to the merged list.</li>
  <li>If the top element of heap is the last node in a list, pop it and go to step 3.</li>
  <li>If the top element of heap has followers, pop it and push its following node into heap.</li>
  <li>Go to step 3 until the heap is empty.</li>
</ol>

<p>To create a heap meet step’1 requirement, we need to create a structure/class that overloads the operator <code class="highlighter-rouge">()</code>, so that we can compare two list nodes based on their values. Such structure/class is required by the <code class="highlighter-rouge">priority_queue</code> template. Instead of a struct, I would rather use a lambda function to do so. Unfortunately, lambda function still cannot be used as the comparison object in <code class="highlighter-rouge">priority_queue</code>.</p>

<p>For a <code class="highlighter-rouge">k</code>-element <code class="highlighter-rouge">priority_queue</code>, an insertion requires \( O(\log k) \) time. Since we need to do such insertion for at most \(nk\) times, therefore the time complexity for this method is also \( O(nk \log k) \). Obviously, the space complexity of this algorithm is \( O(k) \).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class Solution {
public:
	// comparison structure, required by priority_queue template
	struct greaterListNode{ 
		bool operator() (ListNode* x, ListNode* y) {return x-&gt;val &gt; y-&gt;val;}
	};

    ListNode *mergeKLists(vector&lt;ListNode *&gt; &amp;lists) {
		if(lists.size()==0)
			return NULL;
		if(lists.size()==1)
			return lists[0];

		ListNode* pre_head=new ListNode(-1);
		ListNode* pre=pre_head;
		std::priority_queue&lt;ListNode*, vector&lt;ListNode*&gt;, greaterListNode&gt; pq;

		// Insert entries of every list into heap
		for(auto&amp; lst:lists)
			if(lst!=NULL)
				pq.push(lst);

		// Recursively parse every element in lists
		while(!pq.empty()) {
			pre-&gt;next=pq.top();
			pre=pre-&gt;next;
			pq.pop();

			if(pre!=NULL &amp;&amp; pre-&gt;next!=NULL)
				pq.push(pre-&gt;next);
		}

		ListNode* head=pre_head-&gt;next;
		delete pre_head;
		return head;
    }
};
</code></pre>
</div>

<h3 id="references">References:</h3>

<ol>
  <li><a href="http://blog.csdn.net/linhuanmars/article/details/19899259">Merge k Sorted Lists – LeetCode</a></li>
  <li><a href="http://www.cplusplus.com/reference/queue/priority_queue/">std::priority_queue</a></li>
  <li><a href="http://www.cplusplus.com/reference/functional/greater/">std::greater</a></li>
</ol>

</article>


  <div class="share-page">
  Share this post!

  <div class="share-links">
    
      <a class="fa fa-facebook" href="https://facebook.com/sharer.php?u=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/" rel="nofollow" target="_blank" title="Share on Facebook"></a>
    

    
      <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=Merge K Sorted Lists&url=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/" rel="nofollow" target="_blank" title="Share on Twitter"></a>
    

    
      <a class="fa fa-google-plus" href="https://plus.google.com/share?url=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/" rel="nofollow" target="_blank" title="Share on Google+"></a>
    

    
      <a class="fa fa-linkedin" href="http://www.linkedin.com/shareArticle?url=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/&title=Merge K Sorted Lists" rel="nofollow" target="_blank" title="Share on LinkedIn"></a>
    

    

    
      <a class="fa fa-tumblr" href="http://www.tumblr.com/share/link?url=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/&name=Merge K Sorted Lists" rel="nofollow" target="_blank" title="Share on Tumblr"></a>
    

    
      <a class="fa fa-reddit" href="http://reddit.com/submit?url=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/&title=Merge K Sorted Lists" rel="nofollow" target="_blank" title="Share on Reddit"></a>
    

    

    
      <a class="fa fa-hacker-news" onclick="parent.postMessage('submit','*')" href="https://news.ycombinator.com/submitlink?u=http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/&t=Merge K Sorted Lists" rel="nofollow" target="_blank" title="Share on Hacker News"></a>
    
  </div>
</div>





<center><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Banner_728x90 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-4220046549022535"
     data-ad-slot="5852972202"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50551633-1', 'auto');
  ga('send', 'pageview');

</script>



  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'boyang';
    var disqus_identifier = '/algorithm/c/c++/2014/07/21/merge-k-sorted-lists';
    var disqus_title      = 'Merge K Sorted Lists';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



  <div class="fb-comments" data-href="http://www.bo-yang.net//algorithm/c/c++/2014/07/21/merge-k-sorted-lists/" data-width="100%" data-numposts="10"></div>



  <h3 class="related-post-title">Related Posts</h3>
  
    <div class="post ml2">
      <a href="/network/c/c++/click/2016/01/26/gen-hex-dump/" class="post-link">
        <h4 class="post-title">Generate Wireshark-Understandable Hexdump</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/2015/08/31/centos7-install-tftp-server/" class="post-link">
        <h4 class="post-title">A Complete Guide For Installing TFTP Server In CentOS 7</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/2015/08/20/linux-system-log-2/" class="post-link">
        <h4 class="post-title">How To Use Local Facilities For Logging?</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/openwrt/2015/05/27/retrieve-last-log/" class="post-link">
        <h4 class="post-title">Retrieve Last Log After Crash</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/openwrt/2015/04/02/customize-linux-system-log-timestamp/" class="post-link">
        <h4 class="post-title">Customizing OpenWRT System Log Timestamp</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/2015/03/30/debug-kernel-space-memory-leak/" class="post-link">
        <h4 class="post-title">Debug Kernel Space Memory Leak</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/unix/linux/2015/01/12/linux-system-log/" class="post-link">
        <h4 class="post-title">Linux System Log</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/network/2015/01/07/click-notes-click-language/" class="post-link">
        <h4 class="post-title">Click Notes II - Click Script Language</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/notes/network/2014/12/23/click-notes-overview/" class="post-link">
        <h4 class="post-title">Click Notes I - Overview</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/unix/linux/notes/2014/12/19/remote-local-linux-develop-env-2/" class="post-link">
        <h4 class="post-title">Building Remote+Local *nix Develop Environment(II)</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  


      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
      <small>
      <p>&copy; 2007-2016 by <a href="http://www.bo-yang.net/">Bo Yang. </a></p>
         
      Theme crafted with &lt;3 by <a href="http://johnotander.com">John Otander</a> (<a href="https://twitter.com/4lpine">@4lpine</a>).<br>
      &lt;/&gt; available on <a href="https://github.com/johnotander/pixyll">Github</a>.
    </small>
  </div>
</footer>

</body>
</html>
