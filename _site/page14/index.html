
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <title>Bo Yang | Bo's Blog</title>
  
  <meta name="author" content="boyang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">

  <meta name="wumiiVerification" content="b53186bf-1c2c-42e8-babc-8628eb14dd59" />
  <!-- using baidu cdn instead
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  -->
  <link href="http://libs.baidu.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet">


  <!-- Google Prettify -->
  <link href="/assets/themes/clear/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/themes/clear/css/style.css" rel="stylesheet" type="text/css" media="all" />
  <!-- using baidu cdn instead
  <script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
  -->

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="/">bo-yang</a>
        <ul class="nav">
          <li><a href="/archive.html">Archive</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/messages.html">Messages</a></li>
        </ul>
        <ul class="pull-right">
          <li>
            <form class="navbar-search" method="get" action="http://www.google.com/search" target="google_window">
              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
              <input type="hidden" name="ie" value="UTF-8" />
              <input type="hidden" name="oe" value="UTF-8" />
              <input type="hidden" name="hl" value="zh-CN" />
              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
              <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
            </form>
          </li>
        </ul>
        <ul class="nav pull-right">
          <li><a href="/atom.xml">RSS</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container page-container">
    <div class="content">
      
<div class="page-header">
  <h1>Bo Yang  <small>Beginner's mind.</small></h1>
</div>

<div class="row-fluid page-body">
  <div class="span12">
    

<div class="row-fluid page-body">

  <div class="span9 left">
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/03/05/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520perl%25e6%2595%25b0%25e5%2580%25bc%25e8%25bd%25ac%25e6%258d%25a2%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">Perl数值转换</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-03-05</strong> with tags <a href="/tags.html#Perl-ref" rel="nofollow">Perl</a>
        </p>
        
        <div class="post_at_index thepost">
        </p>
<p>As always with Perl there is more than one way to do it. Below are a few examples of approaches to making common conversions between number representations. This is intended to be representational rather than exhaustive.</p>
<p>Some of the examples below use the Bit::Vector module from CPAN. The reason you might choose Bit::Vector over the perl built in functions is that it works with numbers of ANY size, that it is optimized for speed on some operations, and for at least some programmers the notation might be familiar.</p>
<dl>
<dt><a name="How-do-I-convert-hexadecimal-into-decimal">How do I convert hexadecimal into decimal</a></dt>
<dd>
<p>Using perl's built in conversion of 0x notation:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = 0xDEADBEEF;
    $dec = sprintf("%d", $int);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using the hex function:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = hex("DEADBEEF");
    $dec = sprintf("%d", $int);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using pack:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = unpack("N", pack("H8", substr("0" x 8 . "DEADBEEF", -8)));
    $dec = sprintf("%d", $int);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using the CPAN module Bit::Vector:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new_Hex(32, "DEADBEEF");
    $dec = $vec-&gt;to_Dec();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</dd>
<dt><a name="How-do-I-convert-from-decimal-to-hexadecimal">How do I convert from decimal to hexadecimal</a></dt>
<dd>
<p>Using sprint:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $hex = sprintf("%X", 3735928559);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using unpack</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $hex = unpack("H*", pack("N", 3735928559));  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using Bit::Vector</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new_Dec(32, -559038737);
    $hex = $vec-&gt;to_Hex();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>And Bit::Vector supports odd bit counts:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new_Dec(33, 3735928559);
    $vec-&gt;Resize(32); # suppress leading 0 if unwanted
    $hex = $vec-&gt;to_Hex();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</dd>
<dt><a name="How-do-I-convert-from-octal-to-decimal">How do I convert from octal to decimal</a></dt>
<dd>
<p>Using Perl's built in conversion of numbers with leading zeros:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = 033653337357; # note the leading 0!
    $dec = sprintf("%d", $int);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using the oct function:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = oct("33653337357");
    $dec = sprintf("%d", $int);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using Bit::Vector:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new(32);
    $vec-&gt;Chunk_List_Store(3, split(//, reverse "33653337357"));
    $dec = $vec-&gt;to_Dec();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</dd>
<dt><a name="How-do-I-convert-from-decimal-to-octal">How do I convert from decimal to octal</a></dt>
<dd>
<p>Using sprintf:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $oct = sprintf("%o", 3735928559);  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using Bit::Vector</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new_Dec(32, -559038737);
    $oct = reverse join('', $vec-&gt;Chunk_List_Read(3));  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</dd>
<dt><a name="How-do-I-convert-from-binary-to-decimal">How do I convert from binary to decimal</a></dt>
<dd>
<p>Perl 5.6 lets you write binary numbers directly with the 0b notation:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>	$number = 0b10110110;  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using pack and ord</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $decimal = ord(pack('B8', '10110110'));  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using pack and unpack for larger strings</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $int = unpack("N", pack("B32",
	substr("0" x 32 . "11110101011011011111011101111", -32)));
    $dec = sprintf("%d", $int);

    # substr() is used to left pad a 32 character string with zeros.  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using Bit::Vector:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $vec = Bit::Vector-&gt;new_Bin(32, "11011110101011011011111011101111");
    $dec = $vec-&gt;to_Dec();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</dd>
<dt><a name="How-do-I-convert-from-decimal-to-binary">How do I convert from decimal to binary</a></dt>
<dd>
<p>Using unpack;</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    $bin = unpack("B*", pack("N", 3735928559));  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using Bit::Vector:</p>
<p>&nbsp;</p>
<table border="0" cellspacing="0" cellpadding="1" width="100%" bgcolor="#000000">
<tbody>
<tr>
<td align="middle">
<table border="0" cellspacing="0" cellpadding="4" width="100%" bgcolor="#e8e8e8">
<tbody>
<tr>
<td>
<pre>    use Bit::Vector;
    $vec = Bit::Vector-&gt;new_Dec(32, -559038737);
    $bin = $vec-&gt;to_Bin();  </pre>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The remaining transformations (e.g. hex -&gt; oct, bin -&gt; hex, etc.) are left as an exercise to the inclined reader.</p>
</dd>
</dl>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/03/05/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520perl%25e6%2589%2593%25e5%258d%25b0%25e6%2594%25b6%25e5%2588%25b0%25e7%259a%2584socket%25e6%25b6%2588%25e6%2581%25af%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">PERL打印收到的Socket消息</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-03-05</strong> with tags <a href="/tags.html#Perl-ref" rel="nofollow">Perl</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>&nbsp;</p>
<div>
<h1>PERL打印收到的Socket消息</h1>
<div>利用Perl的Select(),sysread()和syswrite()收到的消息将以二进制的形式存储到$buffer中，因此如果直接打印$buffer的内容将得到乱码。要将二进制内容转换为十六进制数串，则必须使用unpack()函数，即：</div>
<div>my $hexstr=unpack("H*",$buffer);</div>
<div>而此时如果打印$hexstr将得到一系列的十六进制数串（数串的长度是接收到的字节数的两倍），仍然难以阅读。因此，有必要将十六进制数串每两个数字进行拆分并加前缀&ldquo;0x&rdquo;以便阅读。此时需要借助正则表达式进行模式匹配，方法为:</div>
<div>my @msg=($hexstr =~ m/../g);</div>
<div>其中.用以匹配一个字符。</div>
<div></div>
<div>示例代码如下：</div>
<div>
<pre>##################################################################
#               DumpMsg
#
# Dump received message in hex mode.
#
# Format: DumpMsg($type, $msglen, $msg);
#
# input:        $type= 'MSC' | 'BSC'
#               $msglen= msg length
#               $msg= received msg
#
# output:       Print received msg to stderr and log in hex type
##################################################################
sub DumpMsg {
    my $type=$_[0];
    my $msglen=$_[1];
    CoolMisc::coolprint("Received message from $type: $msglen bytes/n" );
    LogPrint("Received message from $type: $msglen bytes/n");
    # change the received message from bin to hex string.
    # my @msg=split(/../,unpack("H*", $_[2]),$msglen);
    my $tmp = unpack("H*", $_[2]);
    my @msg = ( $tmp =~ m/../g );
    # print the message to stdout and log file.
    for(my $i=0;$i&lt;$msglen;$i++) {
        print "0x$msg[$i] ";
        syswrite($ROUTELOG,"0x$msg[$i] ");
        if ($i%8 ==7) {
            print "/n";
            syswrite($ROUTELOG,"/n");
        }
    }
    print "/n";
    syswrite($ROUTELOG,"/n");
}
</pre>
<p>&nbsp;</p></div>
<div></div>
<div></div>
<div>参考文献：</div>
<div>1. Perl Doc-Data::Numbers&nbsp;<a href="http://perl.active-venture.com/pod/perlfaq4-datanumber.html">http://perl.active-venture.com/pod/perlfaq4-datanumber.html</a></div>
<div>2. Perl函数pack/unpack:<a href="http://hi.baidu.com/xemoaya/blog/item/7ea20008f8d23ed563d98660.html">http://hi.baidu.com/xemoaya/blog/item/7ea20008f8d23ed563d98660.html</a>&nbsp;</div>
<div>3.&nbsp;<span><strong><a href="http://stackoverflow.com/questions/372370/how-can-i-split-a-string-into-chunks-of-two-characters-each-in-perl">How can I split a string into chunks of two characters each in Perl?</a></strong></span></div>
<div><strong><br /></strong></div>
</div>
<p>&nbsp;</p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/03/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520unix%2520commands%2520used%2520to%2520debug%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">UNIX Commands Used to Debug</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-03-03</strong> with tags <a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
        </p>
        
        <div class="post_at_index thepost">
        <div>
<h1>UNIX Commands Used to Debug</h1>
<div></p>
<div>
<h3>1. truss</h3>
<div>bjbldc:/home/bonny &gt;2&gt; truss -p 6535</div>
<div>read(11, 0xFFBED6C8, 1024) &nbsp; &nbsp; &nbsp;(sleeping...)</div>
<div></div>
</div>
<h3>2. ps -fu &lt;user_name&gt;</h3>
</div>
<div>bjbldc:/home/bonny &gt;&gt; ps -fu bonny</div>
<div>&nbsp;&nbsp; &nbsp; UID &nbsp; PID &nbsp;PPID &nbsp;C &nbsp; &nbsp;STIME TTY &nbsp; &nbsp; &nbsp;TIME CMD</div>
<div>&nbsp;&nbsp; bonny &nbsp;9006 &nbsp;9005 &nbsp;0 &nbsp; Feb 26 ?? &nbsp; &nbsp; &nbsp; 0:01 /usr/dt/bin/dtterm</div>
<div>&nbsp;&nbsp; bonny 19743 &nbsp;8910 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 dtfile -session dtstaGjf</div>
<div>&nbsp;&nbsp; bonny &nbsp;8784 &nbsp;8776 &nbsp;0 &nbsp; Feb 16 ? &nbsp; &nbsp; &nbsp; &nbsp;0:13 dtwm</div>
<div>&nbsp;&nbsp; bonny &nbsp;8911 &nbsp;8776 &nbsp;0 &nbsp; Feb 16 ?? &nbsp; &nbsp; &nbsp; 0:01 /usr/dt/bin/dtterm -session dt_.a</div>
<div>q4t -C -ls</div>
<div>&nbsp;&nbsp; bonny 18994 &nbsp;8784 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dtexec -open 0 -ttpro</div>
<div>cid 2.19cDSU 01 8751 1289637095 1 1 39237 135.</div>
<div>&nbsp;&nbsp; bonny 25275 &nbsp; &nbsp; 1 &nbsp;0 &nbsp; Feb 25 ? &nbsp; &nbsp; &nbsp; &nbsp;0:11 gvim BMAcpMsgpr.c</div>
<div>&nbsp;&nbsp; bonny 25106 &nbsp;8911 &nbsp;0 &nbsp; Feb 25 pts/186 &nbsp;0:00 -ksh</div>
<div></div>
<h3>3. ptree &lt;user_name&gt;</h3>
<div>
<div>bjbldc:/home/bonny &gt;&gt; ptree bonny</div>
<div>195 &nbsp; /usr/sbin/inetd -s</div>
<div>&nbsp;&nbsp;6224 &nbsp;in.rshd</div>
<div>&nbsp;&nbsp; &nbsp;6225 &nbsp;dtterm -xrm *workspaceList: COOL msc-s COOL/ msc-s -title COOL msc-s Installing</div>
<div>&nbsp;&nbsp; &nbsp; &nbsp;6252 &nbsp;tail -f /bld/bonny/coolxdir_2/logs/Mar02.18:42:41/APs/31/COOLAPLOG</div>
<div>&nbsp;&nbsp;6254 &nbsp;in.rshd</div>
<div>&nbsp;&nbsp; &nbsp;6256 &nbsp;dtterm -xrm *workspaceList: COOL msc-s COOL/ msc-s -title COOL msc-s Installing</div>
<div>&nbsp;&nbsp; &nbsp; &nbsp;6276 &nbsp;tail -f /bld/bonny/coolxdir_2/logs/Mar02.18:42:41/APs/33/COOLAPLOG</div>
<div>&nbsp;&nbsp;6278 &nbsp;in.rshd</div>
<div>&nbsp;&nbsp; &nbsp;6279 &nbsp;dtterm -xrm *workspaceList: COOL msc-s COOL/ msc-s -title COOL msc-s Installing</div>
<div>&nbsp;&nbsp; &nbsp; &nbsp;6300 &nbsp;tail -f /bld/bonny/coolxdir_2/logs/Mar02.18:42:41/APs/35/COOLAPLOG</div>
<div>&nbsp;&nbsp;6297 &nbsp;in.rshd</div>
<div>&nbsp;&nbsp; &nbsp;6298 &nbsp;/usr/bin/ksh /opt/cool/tools/lib/COOLvirtenv -r /bld/bonny/coolxdir_2/APs/31 -a</div>
<div>&nbsp;&nbsp; &nbsp; &nbsp;6535 &nbsp;/usr/bin/ksh /opt/cool/tools/lib/COOLstartAP -sL -c80 -Wcool01 -Fcoolap23 -dOWL</div>
<div>&nbsp;&nbsp;6335 &nbsp;in.rshd</div>
<div>&nbsp;&nbsp; &nbsp;6336 &nbsp;/usr/bin/ksh /opt/cool/tools/lib/COOLvirtenv -r /bld/bonny/coolxdir_2/APs/35 -a</div>
<div>&nbsp;&nbsp; &nbsp; &nbsp;6627 &nbsp;/usr/bin/ksh /opt/cool/tools/lib/COOLstartAP -sA -c80 -Wcool01 -Fcoolap09 -dOWL</div>
<div></div>
<h3>4. uptime</h3>
<div>
<div>&nbsp;cool01:/home/bonny &gt;&gt; uptime</div>
<div>&nbsp;10:17pm &nbsp;up 18:10, &nbsp;2 users, &nbsp;load average: 0.03, 0.01, 0.06</div>
<div></div>
<h3>5. uname</h3>
<div>
<div>cool01:/home/bonny &gt;127&gt; uname -a</div>
<div>SunOS cool01 5.8 Generic_117350-58 sun4u sparc SUNW,UltraAX-i2</div>
<div></div>
<div>
<div>bjbldc:sc4.2/SUNWspro/bin &gt;&gt; uname -n</div>
<div>bjbldc</div>
<div></div>
<h3>6. nmake</h3>
<div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; nmake GLIB10=N -n -k -f mytstmk dumpit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div>
<div>+ set +x</div>
<div>+ cd /bld/bonny/1apx10</div>
<div>+ /bin/pwd</div>
<div>+ set -x</div>
<div>+ : "STARTING ecpc NMAKE IN ROOT `silent date '+%m/%d/%y %H:%M:%S'`"</div>
<div>+ print FMS_GOLDEN_HDRLIB=</div>
<div>FMS_GOLDEN_HDRLIB=</div>
<div>+ rm -f&nbsp;</div>
<div>+ : "COMPLETED ecpc NMAKE IN ROOT `silent date '+%m/%d/%y %H:%M:%S'`"</div>
<div></div>
<h3>7. lb</h3>
<div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; lb -iA -mapbld</div>
<div></div>
<div>&nbsp;LB Pool Status for apbld &nbsp;(03/02/09 23:58:21):</div>
<div></div>
<div>&nbsp;MACH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RTP &nbsp;%AV &nbsp;RSP &nbsp;CPUF &nbsp;MLA IMLA &nbsp;PLA &nbsp;LA1 &nbsp; LA5 &nbsp; LA15</div>
<div>bjbldb &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1400 &nbsp; 99 &nbsp; 1 &nbsp;1406 &nbsp;20.2 &nbsp;20 &nbsp;0.08 &nbsp;0.06 &nbsp;0.08 &nbsp;0.30</div>
<div>bjbldc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1394 &nbsp; 99 &nbsp; 3 &nbsp;1406 &nbsp;20.2 &nbsp;20 &nbsp;0.17 &nbsp;0.16 &nbsp;0.20 &nbsp;0.29</div>
<div>bjbldd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1363 &nbsp; 96 &nbsp; 2 &nbsp;1406 &nbsp;20.2 &nbsp;20 &nbsp;0.61 &nbsp;0.60 &nbsp;0.63 &nbsp;0.69</div>
<div>------------------------------------------------------------------------------</div>
<div>AVERAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1385 &nbsp; 98 &nbsp; - &nbsp;1406 &nbsp;20.2 &nbsp;20 &nbsp;0.29 &nbsp;0.27 &nbsp;0.30 &nbsp;0.43</div>
<div>TOTAL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4157 &nbsp; 98 &nbsp; 3 &nbsp;4218 &nbsp;60.6 &nbsp;60 &nbsp;0.86 &nbsp;0.82 &nbsp;0.91 &nbsp;1.28</div>
<div></div>
<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;apbld : &nbsp;98% available &nbsp; (98% available IMLA)&nbsp;</div>
<div></div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; lb -m bjbldc nmake GLIB10=N -n -k -f mytstmk dumpit</div>
<div>+ set +x</div>
<div>+ cd /bld/bonny/1apx10</div>
<div>+ /bin/pwd</div>
<div>+ set -x</div>
<div>+ : "STARTING ecpc NMAKE IN ROOT `silent date '+%m/%d/%y %H:%M:%S'`"</div>
<div>+ print FMS_GOLDEN_HDRLIB=</div>
<div>FMS_GOLDEN_HDRLIB=</div>
<div>+ rm -f&nbsp;</div>
<div>+ : "COMPLETED ecpc NMAKE IN ROOT `silent date '+%m/%d/%y %H:%M:%S'`"</div>
<div></div>
<div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; lb -iA -m CoolServers.ngnap</div>
<div></div>
<div>&nbsp;LB Pool Status for coolservers.ngnap &nbsp;(03/03/09 00:15:06):</div>
<div></div>
<div>&nbsp;MACH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RTP &nbsp;%AV &nbsp;RSP &nbsp;CPUF &nbsp;MLA IMLA &nbsp;PLA &nbsp;LA1 &nbsp; LA5 &nbsp; LA15</div>
<div>coolap26 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1361 &nbsp; 94 &nbsp;21 &nbsp;1440 &nbsp;10.0 &nbsp;10 &nbsp;0.54 &nbsp;0.52 &nbsp;0.52 &nbsp;0.52</div>
<div>coolap14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp; 1 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap01 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp; 2 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.03 &nbsp;0.00 &nbsp;0.01 &nbsp;0.01</div>
<div>coolap12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp; 4 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap09 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp; 5 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap21 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp; 6 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap19 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;11 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap13 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;13 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;14 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;16 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap23 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;17 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap25 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698 &nbsp; 99 &nbsp;19 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>coolap02 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp; 3 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.07 &nbsp;0.01 &nbsp;0.04 &nbsp;0.10</div>
<div>coolap18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp; 7 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.06 &nbsp;0.04 &nbsp;0.04 &nbsp;0.06</div>
<div>coolap07 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp; 8 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.06 &nbsp;0.05 &nbsp;0.11 &nbsp;0.23</div>
<div>coolap05 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp; 9 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.07 &nbsp;0.05 &nbsp;0.05 &nbsp;0.10</div>
<div>coolap10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp;10 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.07 &nbsp;0.05 &nbsp;0.05 &nbsp;0.07</div>
<div>coolap20 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 695 &nbsp; 99 &nbsp;15 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.06 &nbsp;0.02 &nbsp;0.04 &nbsp;0.06</div>
<div>coolap08 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 693 &nbsp; 99 &nbsp;12 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.10 &nbsp;0.08 &nbsp;0.10 &nbsp;0.21</div>
<div>coolap17 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 691 &nbsp; 98 &nbsp;18 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;0.13 &nbsp;0.11 &nbsp;0.13 &nbsp;0.12</div>
<div>coolap11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 623 &nbsp; 89 &nbsp;20 &nbsp; 700 &nbsp;10.0 &nbsp;10 &nbsp;1.09 &nbsp;0.96 &nbsp;0.39 &nbsp;0.26</div>
<div>------------------------------------------------------------------------------</div>
<div>AVERAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;724 &nbsp; 98 &nbsp; - &nbsp; 735 &nbsp;10.0 &nbsp;10 &nbsp;0.12 &nbsp;0.09 &nbsp;0.07 &nbsp;0.09</div>
<div>TOTAL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;15216 &nbsp; 98 &nbsp;21 15440 210.0 210 &nbsp;2.48 &nbsp;1.89 &nbsp;1.48 &nbsp;1.84</div>
<div></div>
<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;coolservers.ngnap : &nbsp;98% available &nbsp; (98% available IMLA)&nbsp;</div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; lb -iA -m coolservers</div>
<div></div>
<div>&nbsp;LB Pool Status for coolservers &nbsp;(03/03/09 00:31:49):</div>
<div></div>
<div>&nbsp;MACH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RTP &nbsp;%AV &nbsp;RSP &nbsp;CPUF &nbsp;MLA IMLA &nbsp;PLA &nbsp;LA1 &nbsp; LA5 &nbsp; LA15</div>
<div>cool01 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 660 &nbsp; 99 &nbsp; 1 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>cool11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 660 &nbsp; 99 &nbsp; 6 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>cool05 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 660 &nbsp; 99 &nbsp; 8 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>cool13 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 660 &nbsp; 99 &nbsp; 9 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.03 &nbsp;0.01 &nbsp;0.00 &nbsp;0.01</div>
<div>cool02 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 660 &nbsp; 99 &nbsp;12 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.03 &nbsp;0.02 &nbsp;0.01 &nbsp;0.01</div>
<div>cool09 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 659 &nbsp; 99 &nbsp;10 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;0.04 &nbsp;0.01 &nbsp;0.01 &nbsp;0.03</div>
<div>cool08 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 642 &nbsp; 99 &nbsp; 2 &nbsp; 644 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>cool07 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 642 &nbsp; 99 &nbsp; 5 &nbsp; 644 &nbsp;10.0 &nbsp;10 &nbsp;0.02 &nbsp;0.00 &nbsp;0.00 &nbsp;0.01</div>
<div>cool10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 641 &nbsp; 99 &nbsp;11 &nbsp; 644 &nbsp;10.0 &nbsp;10 &nbsp;0.03 &nbsp;0.01 &nbsp;0.00 &nbsp;0.01</div>
<div>cool14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 591 &nbsp; 89 &nbsp; 3 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;1.07 &nbsp;1.05 &nbsp;1.03 &nbsp;1.04</div>
<div>cool12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 589 &nbsp; 88 &nbsp; 7 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;1.10 &nbsp;1.08 &nbsp;1.06 &nbsp;1.17</div>
<div>cool03 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 376 &nbsp; 56 &nbsp; 4 &nbsp; 662 &nbsp;10.0 &nbsp;10 &nbsp;4.32 &nbsp;4.14 &nbsp;3.36 &nbsp;2.59</div>
<div>------------------------------------------------------------------------------</div>
<div>AVERAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;620 &nbsp; 94 &nbsp; - &nbsp; 658 &nbsp;10.0 &nbsp;10 &nbsp;0.56 &nbsp;0.53 &nbsp;0.46 &nbsp;0.41</div>
<div>TOTAL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7440 &nbsp; 94 &nbsp;12 &nbsp;7890 120.0 120 &nbsp;6.72 &nbsp;6.32 &nbsp;5.47 &nbsp;4.91</div>
<div></div>
<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;coolservers : &nbsp;94% available &nbsp; (94% available IMLA)&nbsp;</div>
<div></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h3>8.&nbsp;timex&nbsp;</h3>
<div>timex- time a &nbsp;command; &nbsp;report &nbsp;process &nbsp;data &nbsp;and &nbsp;system&nbsp;activity.</div>
<div></p>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; timex ping cool01</p>
<div>cool01 is alive</div>
<div></div>
<div>real &nbsp; &nbsp; &nbsp; &nbsp;0.01</div>
<div>user &nbsp; &nbsp; &nbsp; &nbsp;0.01</div>
<div>sys &nbsp; &nbsp; &nbsp; &nbsp; 0.00</div>
<div></div>
<h3>9. remsh</h3>
<div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; remsh bjbldd ps -fu bonny</div>
<div>&nbsp;&nbsp; &nbsp; UID &nbsp; PID &nbsp;PPID &nbsp;C &nbsp; &nbsp;STIME TTY &nbsp; &nbsp; &nbsp;TIME CMD</div>
<div>&nbsp;&nbsp; bonny 29793 29752 &nbsp;0 22:18:04 pts/179 &nbsp;0:00 rlogin bjbldc</div>
<div>&nbsp;&nbsp; bonny 15715 15669 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 dtfile -session dtstaGjf</div>
<div>&nbsp;&nbsp; bonny 23825 23779 &nbsp;0 00:38:20 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/bin/remsh cool01 eval set -aSTART[0]=/home/bonny/.env[</div>
<div>&nbsp;&nbsp; bonny &nbsp;2409 15716 &nbsp;0 16:05:08 pts/41 &nbsp; 0:00 -ksh</div>
<div>&nbsp;&nbsp; bonny 14037 &nbsp; &nbsp; 1 &nbsp;0 16:33:12 ? &nbsp; &nbsp; &nbsp; &nbsp;0:01 gvim COOLein2ap</div>
<div>&nbsp;&nbsp; bonny 15542 15541 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /opt/exp/lib/vnc/vncconfig.bin -nowin</div>
<div>&nbsp;&nbsp; bonny 29545 29543 &nbsp;0 22:17:05 pts/195 &nbsp;0:00 /bin/ksh</div>
<div>&nbsp;&nbsp; bonny 23779 &nbsp;2666 &nbsp;0 00:38:19 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/bin/remsh cool01 eval set -aSTART[0]=/home/bonny/.env[</div>
<div>&nbsp;&nbsp; bonny 24503 24502 &nbsp;0 20:49:36 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/clear3bemlab -i -p -lab bonny</div>
<div>&nbsp;&nbsp; bonny 15498 &nbsp; &nbsp; 1 &nbsp;1 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;2:04 Xvnc :10 -desktop bjbldd:10 () -httpd /opt/exp/lib/vnc/clas</div>
<div>&nbsp;&nbsp; bonny 23776 &nbsp; &nbsp; 1 &nbsp;0 00:38:19 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/tools/lib/GetDynCOOLID UNAME=coolap01 CO</div>
<div>&nbsp;&nbsp; bonny 24175 24174 &nbsp;0 20:40:11 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/clear3bemlab -i -p -lab bonny</div>
<div>&nbsp;&nbsp; bonny 13782 13780 &nbsp;0 16:28:08 pts/180 &nbsp;0:00 /bin/ksh</div>
<div>&nbsp;&nbsp; bonny 24502 24343 &nbsp;0 20:49:36 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e apollo -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 15668 &nbsp; &nbsp; 1 &nbsp;0 &nbsp; Feb 26 pts/118 &nbsp;0:00 /usr/dt/bin/ttsession</div>
<div>&nbsp;&nbsp; bonny 23482 &nbsp; &nbsp; 1 &nbsp;0 00:38:15 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/tools/lib/GetDynCOOLID UNAME=cool01</div>
<div>&nbsp;&nbsp; bonny 19606 &nbsp; &nbsp; 1 &nbsp;0 17:06:00 ? &nbsp; &nbsp; &nbsp; &nbsp;0:12 gvim /apx/ecpc33/OFC5L33.0/1apx10/rules/tps.mk</div>
<div>&nbsp;&nbsp; bonny &nbsp;2666 &nbsp; &nbsp; 1 &nbsp;0 16:07:01 ? &nbsp; &nbsp; &nbsp; &nbsp;0:11 /opt/cool/tools/lib/TclPro1.5/solaris-sparc/bin/wish8.3 -f&nbsp;</div>
<div>&nbsp;&nbsp; bonny 28765 15692 &nbsp;0 22:14:32 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dtexec -open 0 -ttprocid 2.19fbdI 01 15668 1289</div>
<div>&nbsp;&nbsp; bonny 13970 13969 &nbsp;0 13:45:33 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e athena -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 28767 28765 &nbsp;0 22:14:32 ?? &nbsp; &nbsp; &nbsp; 0:00 /usr/dt/bin/dtterm</div>
<div>&nbsp;&nbsp; bonny 24588 24587 &nbsp;0 20:51:46 pts/41 &nbsp; 0:00 rlogin cool01</div>
<div>&nbsp;&nbsp; bonny 14189 14162 &nbsp;2 13:45:39 ? &nbsp; &nbsp; &nbsp; 40:47 rm -rf /opt/cool2b/bonny/APs/21</div>
<div>&nbsp;&nbsp; bonny 15717 15669 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:01 /usr/dt/bin/sdtperfmeter -f -H -t cpu -t disk -s 1 -name fp</div>
<div>&nbsp;&nbsp; bonny 14126 14125 &nbsp;0 13:45:39 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/clear3bemlab -i -p -lab bonny</div>
<div>&nbsp;&nbsp; bonny 15637 15635 &nbsp;0 &nbsp; Feb 26 pts/118 &nbsp;0:00 -ksh -c &nbsp; &nbsp; &nbsp;unset DT; &nbsp; &nbsp; DISPLAY=bjbldd:10; &nbsp; &nbsp; &nbsp; /usr/dt</div>
<div>&nbsp;&nbsp; bonny 15716 15669 &nbsp;0 &nbsp; Feb 26 ?? &nbsp; &nbsp; &nbsp; 0:03 /usr/dt/bin/dtterm -session dt_.aq4t -C -ls</div>
<div>&nbsp;&nbsp; bonny 23483 23482 &nbsp;0 00:38:15 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 sleep 1800</div>
<div>&nbsp;&nbsp; bonny 29752 29750 &nbsp;0 22:17:55 pts/179 &nbsp;0:00 /bin/ksh</div>
<div>&nbsp;&nbsp; bonny 24132 24019 &nbsp;0 20:40:08 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 tail +0f /tmp/ldcool.24019/log.ldcool_bonny_bonny</div>
<div>&nbsp;&nbsp; bonny 15541 &nbsp; &nbsp; 1 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /opt/exp/bin/ksh /opt/exp/lib/vnc/vncconfig -nowin</div>
<div>&nbsp;&nbsp; bonny 29750 29749 &nbsp;0 22:17:55 ?? &nbsp; &nbsp; &nbsp; 0:01 /usr/dt/bin/dtterm</div>
<div>&nbsp;&nbsp; bonny 19600 &nbsp; &nbsp; 1 &nbsp;0 17:05:59 pts/180 &nbsp;0:00 cscope -dl -f /apx/ecpc33/OFC5L33.0/1apx10/cscope/cscope.ou</div>
<div>&nbsp;&nbsp; bonny 15692 15669 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:15 dtwm</div>
<div>&nbsp;&nbsp; bonny 15634 &nbsp; &nbsp; 1 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dsdm</div>
<div>&nbsp;&nbsp; bonny 29570 29569 &nbsp;0 22:17:09 pts/195 &nbsp;0:00 rlogin cool01</div>
<div>&nbsp;&nbsp; bonny 29794 29793 &nbsp;0 22:18:04 pts/179 &nbsp;0:00 rlogin bjbldc</div>
<div>&nbsp;&nbsp; bonny 13879 &nbsp; &nbsp; 1 &nbsp;0 16:29:06 pts/180 &nbsp;0:00 cscope -dl -f /apx/ecpc33/OFC5L33.0/1apx10/cscope/cscope.ou</div>
<div>&nbsp;&nbsp; bonny 14082 13970 &nbsp;0 13:45:38 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 tail +0f /tmp/ldcool.13970/log.ldcool_bonny_bonny</div>
<div>&nbsp;&nbsp; bonny 24019 24018 &nbsp;0 20:40:07 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e apollo -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 23823 23779 &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:00 &lt;defunct&gt;</div>
<div>&nbsp;&nbsp; bonny 14289 &nbsp; &nbsp; 1 &nbsp;0 16:38:04 ? &nbsp; &nbsp; &nbsp; &nbsp;0:19 gvim /opt/nwstools/bin/getnmakevar</div>
<div>&nbsp;&nbsp; bonny 15533 &nbsp; &nbsp; 1 &nbsp;0 &nbsp; Feb 26 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /usr/dt/bin/Xsession</div>
<div>&nbsp;&nbsp; bonny 28773 28767 &nbsp;0 22:14:33 pts/78 &nbsp; 0:00 /bin/ksh</div>
<div>&nbsp;&nbsp; bonny 29542 15692 &nbsp;0 22:17:05 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dtexec -open 0 -ttprocid 2.19fbdI 01 15668 1289</div>
<div>&nbsp;&nbsp; bonny 15669 15637 &nbsp;0 &nbsp; Feb 26 pts/118 &nbsp;0:00 /usr/dt/bin/dtsession</div>
<div>&nbsp;&nbsp; bonny 14162 14126 &nbsp;0 13:45:39 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/tools/bin/rmv_coolap -C /opt/cool2b/bonn</div>
<div>&nbsp;&nbsp; bonny 23777 23776 &nbsp;0 00:38:19 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 sleep 1800</div>
<div>&nbsp;&nbsp; bonny 24562 24503 &nbsp;1 20:49:36 ? &nbsp; &nbsp; &nbsp; 17:28 rm -rf APs</div>
<div>&nbsp;&nbsp; bonny 29569 29545 &nbsp;0 22:17:09 pts/195 &nbsp;0:00 rlogin cool01</div>
<div>&nbsp;&nbsp; bonny 24232 24175 &nbsp;3 20:40:11 ? &nbsp; &nbsp; &nbsp; 15:44 rm -rf APs</div>
<div>&nbsp;&nbsp; bonny 14125 13970 &nbsp;0 13:45:39 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e athena -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 15635 15533 &nbsp;0 &nbsp; Feb 26 pts/118 &nbsp;0:00 /usr/dt/bin/sdt_shell -c &nbsp; &nbsp; &nbsp;unset DT; &nbsp; &nbsp; DISPLAY=bjbldd:</div>
<div>&nbsp;&nbsp; bonny 13779 15692 &nbsp;0 16:28:08 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dtexec -open 0 -ttprocid 2.19fbdI 01 15668 1289</div>
<div>&nbsp;&nbsp; bonny 13882 &nbsp; &nbsp; 1 &nbsp;0 16:29:07 ? &nbsp; &nbsp; &nbsp; &nbsp;0:10 gvim coolit</div>
<div>&nbsp;&nbsp; bonny 14034 &nbsp; &nbsp; 1 &nbsp;0 16:33:12 pts/180 &nbsp;0:00 cscope -dl -f /apx/ecpc33/OFC5L33.0/1apx10/cscope/cscope.ou</div>
<div>&nbsp;&nbsp; bonny 14286 &nbsp; &nbsp; 1 &nbsp;0 16:38:03 pts/180 &nbsp;0:00 cscope -dl -f /apx/ecpc33/OFC5L33.0/1apx10/cscope/cscope.ou</div>
<div>&nbsp;&nbsp; bonny 29749 15692 &nbsp;0 22:17:55 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /usr/dt/bin/dtexec -open 0 -ttprocid 2.19fbdI 01 15668 1289</div>
<div>&nbsp;&nbsp; bonny 24343 24342 &nbsp;0 20:49:33 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e apollo -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 24460 24343 &nbsp;0 20:49:35 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 tail +0f /tmp/ldcool.24343/log.ldcool_bonny_bonny</div>
<div>&nbsp;&nbsp; bonny 29543 29542 &nbsp;0 22:17:05 ?? &nbsp; &nbsp; &nbsp; 0:01 /usr/dt/bin/dtterm</div>
<div>&nbsp;&nbsp; bonny 13780 13779 &nbsp;0 16:28:08 ?? &nbsp; &nbsp; &nbsp; 0:00 /usr/dt/bin/dtterm</div>
<div>&nbsp;&nbsp; bonny 24174 24019 &nbsp;0 20:40:11 ? &nbsp; &nbsp; &nbsp; &nbsp;0:00 /bin/ksh /opt/cool/bin/ldcool -u bonny -e apollo -o is41 -l</div>
<div>&nbsp;&nbsp; bonny 24587 &nbsp;2409 &nbsp;0 20:51:46 pts/41 &nbsp; 0:00 rlogin cool01</div>
<div>bjbldb:bld/bonny/1apx10 &gt;&gt; remsh bjbldd ps -fu bonny | grep nmake</div>
<div>&nbsp;&nbsp; bonny 14289 &nbsp; &nbsp; 1 &nbsp;0 16:38:04 ? &nbsp; &nbsp; &nbsp; &nbsp;0:19 gvim /opt/nwstools/bin/getnmakevar</div>
</div>
</div>
</div>
</div>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/03/03/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520apple%2520store%25e7%259a%2584%25e9%2594%2599%25e8%25af%25af%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">Apple Store的错误</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-03-03</strong> with tags <a href="/tags.html#Personal-ref" rel="nofollow">Personal</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>今天在Apple4us上看到Apple将于今晚发布新的产品，并且Apple Store的网页正在升级，已经无法正常显示产品信息，于是就随便打开看了一看。想不到不看则以，一看还真让我深感意外: Apple竟然做起了张冠李戴、分裂我中华国土的勾当！</p>
<p>&nbsp;</p>
<p>尽管本人对Apple景仰已久，但大是大非面前岂能是非不分？遂给Apple发邮件一封,内容如下：</p>
<p><a name="英文开始"></a></p>
<div>Dear Sir/Ms. ,</div>
<div></div>
<div>I found something confusing in the webpage <a href="http://store.apple.com/">http://store.apple.com/</a>(following "You can contact our telesales team at the following numbers:").</div>
<div></div>
<div></div>
<div>The logo of Taiwan is not appropriate: you add two Chinese characters "日本" above "Taiwan", which will confuse many people. Taiwan is a part of China, so you should add "中国" instead.</div>
<div></div>
<div></div>
<div>I sincerely remind you about this negligence and hope you can change the logo as soon as possible.</div>
<div></div>
<div>Thank you in advance!<br />
Best wishes!</div>
<div><a name="英文结束"></a></div>
<div></div>
<div>我们还是对Apple的行为拭目以待吧。</div>
<div></div>
<div></div>
<div><img src="http://docs.google.com/File?id=dd6nw3mt_239gjv5ggfw_b" alt="Apple的错误" width="800" height="481" /></div>
<p>&nbsp;</p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/02/17/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e7%25bd%2591%25e9%25a1%25b5%25e5%258f%2596%25e8%25af%258d%25e5%25b9%25b6%25e8%25b0%2583%25e7%2594%25a8google%2520translate%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">网页取词并调用Google Translate</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-02-17</strong> with tags <a href="/tags.html#Cloud Computing-ref" rel="nofollow">Cloud Computing</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>1. translate.html</p>
<p>&nbsp;</p>
<p>
<pre>&lt;html&gt; 
  &lt;head&gt;     
    &lt;mce:script src="http://graphics8.nytimes.com/js/common.js" mce_src="http://graphics8.nytimes.com/js/common.js" type="text/javascript"&gt;&lt;/mce:script&gt; 
    &lt;mce:script type="text/javascript" language="JavaScript" src="file:///C:/Documents%20and%20Settings/bonny/My%20Documents/GoogleApps/FreeTranslator/altClickToSearch.js" mce_src="file:///C:/Documents%20and%20Settings/bonny/My%20Documents/GoogleApps/FreeTranslator/altClickToSearch.js"&gt;&lt;/mce:script&gt;
    &lt;mce:script type="text/javascript" src="http://www.google.com/jsapi" mce_src="http://www.google.com/jsapi"&gt;&lt;/mce:script&gt;
    &lt;link href="http://www.google.com/uds/modules/elements/transliteration/api.css" mce_href="http://www.google.com/uds/modules/elements/transliteration/api.css"
      type="text/css" rel="stylesheet"/&gt; 
    &lt;mce:script type="text/javascript"&gt;&lt;!--
 
    
    google.load("language", "1");
 
    function initialize() {
      var text = document.getElementById("text").innerHTML;
      google.language.detect(text, function(result) {
        if (!result.error &amp;&amp; result.language) {
          google.language.translate(text, result.language, "en",
                                    function(result) {
            var translated = document.getElementById("translation");
            if (result.translation) {
              translated.innerHTML = result.translation;
            }
          });
        }
      });
    }
    google.setOnLoadCallback(initialize);
 
    
// --&gt;&lt;/mce:script&gt; 
  &lt;/head&gt; 
  &lt;body&gt; 
    &lt;div id="text"&gt;你好，见到你很高兴!&lt;/div&gt; 
      &lt;div id="translation"&gt;&lt;/div&gt; 
    &lt;p&gt;Detection of Unicode font rendering supportNew!
Browsers and operating systems may or may not have the support for rendering particular Unicode fonts. You can detect whether the user using your webpage has support for rendering the fonts of a given language in a readable way or not using the font rendering support detection API. Please note that this works correctly for Unicode fonts alone. If your webpage renders using non-Unicode fonts, this function will not be useful for you. If font rendering support is not present for a given language, there are several solutions available to fix this - please read this article for more information.&lt;/p&gt; 
   &lt;textarea id="transliterateTextarea" style="width:600px;height:200px"&gt;</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>2. altClickToSearch.js</p>
<p>&nbsp;</p>
<p>
<pre>NYTD.require("http://graphics8.nytimes.com/js/app/lib/prototype/1.6.0.2/prototype.js", function(){NYTD.WordReference.initialize();});
NYTD.WordReference = (function(){
  
  var selection, selectionText, selectionButton, newRange;
  
  function handleClick(event) {
    if (selectionButton){
      cleanUp();
    }
    
    selection = getSelection();
    selectionText = selection &amp;&amp; selection.toString();
    if (selectionText) {
      window.setTimeout(insertButton, 0);
      event.stop();
    }
  }
  
  function getSelection() {
    return Try.these(
      function() { return window.getSelection() },
      function() { return document.getSelection() },
      function() { 
        var selection = document.selection &amp;&amp; document.selection.createRange();
        selection.toString = function() { return this.text };
        return selection;
      }
    ) || false;
  }
  
  function insertButton() {
    
    selectionButton = new Element(
        'span', {
          'className':'nytd_selection_button',
          'id':'nytd_selection_button',
          'title':'Lookup Word',
          'style': 'margin:-20px 0 0 -20px; position:absolute; background:url
(http://graphics8.nytimes.com/images/global/word_reference/ref_bubble.png);width:25px;height:29px;cursor:pointer;_background-image: none;filter: 
progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://graphics8.nytimes.com/images/global/word_reference/ref_bubble.png", sizingMethod="image");'
        }
    )
      
    if (Prototype.Browser.IE) {
      var tmp = new Element('div');
      tmp.appendChild(selectionButton);
      newRange = selection.duplicate();
      newRange.setEndPoint( "StartToEnd", selection);
      newRange.pasteHTML(tmp.innerHTML);
      selectionButton = $('nytd_selection_button');
    }
    else {
      var range = selection.getRangeAt(0);
      newRange = document.createRange();
      newRange.setStart(selection.focusNode, range.endOffset);
      newRange.insertNode(selectionButton);
    }
    
    Element.observe(selectionButton, 'mouseup', exportSelection, true);
    
  }
  
  function cleanUp() {
    selection = null;
    selectionButton.stopObserving('mouseup', exportSelection);
    newRange &amp;&amp; newRange.pasteHTML &amp;&amp; newRange.pasteHTML('');
    newRange = null;
    selectionButton.remove();
    selectionButton = null;
    selectionText = '';
  }
  
  function exportSelection(event) {
 //    var url = 'http://www.google.com/dictionary?langpair=en|zh-CN&amp;q=' + encodeURIComponent(selectionText) + '&amp;hl=zh-CN&amp;aq=f';
 //   var newwin = window.open(url,'answersdotcom','height=450,width=820,location=false,menubar=false,toolbar=false,status=false,resizable, scrollbars');
//    if (newwin) newwin.focus();
//    event.stop();
	google.language.translate(selectionText, "en", "zh-CN", function(result) {
  	if (!result.error) {
    		alert(encodeURIComponent(selectionText) +":"+result.translation);
  	}
	
	});
  }
  
  return {
    initialize: function() {
      document.observe('mouseup', handleClick, false);
    }
  };
  
})();</pre>
<p>&nbsp;</p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/02/10/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%2520google%25e8%2580%2581%25e7%259f%25a3%25ef%25bc%258c%25e8%2583%25bd%25e4%25b8%258d%25e5%25ae%2595%25e5%2590%25a6%25ef%25bc%259f%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">Google老矣，能不宕否？</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-02-10</strong> with tags <a href="/tags.html#Industry-ref" rel="nofollow">Industry</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>&nbsp;</p>
<div>
<h1 style="text-align:center;"><span>Goolge老矣，能不宕否？</span></h1>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>金融风暴来袭，</span>&nbsp;Google<span>难以独善其身本在我意料之中，但令我感到意外的是</span>Google<span>竟也裁员，更令我大跌眼镜的是</span>Google<span>的各项服务质量竟直线下降</span>:&nbsp;<span>许多常用的服务下线（如</span>Google Notes<span>），宕机不断（</span>Goolge Apps<span>，</span>Gmail<span>啊），</span>Android<span>雷声大雨点小（连</span>Android<span>的创始人都出走了）,Chrome发展缓慢&hellip;&hellip;</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>我应该算</span>Google<span>的忠实</span>Fans<span>了：我一直在用</span>Google Documents, Gmail, Google&nbsp; Map, Google Earth, Google Notes, Chrome, Google Finance, Google Reader, iGoogle, Picasa, Youtube<span>&hellip;&hellip;</span>&nbsp;<span>还准备研究一下</span>Google Apps<span>，</span>&nbsp;<span>下载了</span>Android SDK&nbsp;<span>并且编了一个</span>hello world<span>程序，但由于没有时间就没有继续。当然就更不要说</span>Google Search<span>了。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>以前，</span>Google<span>每推出一项新的服务都会令人眼前一亮，即便今天</span>google&nbsp;<span>仍然占据着新闻媒体的头条。对于这样一个诞生不过十年，上市不过五年的</span>Baby Giant<span>而言，媒体、用户给予它的赞誉、光环实在是太多了。而</span>Google<span>也确实不负众望，推出了一个又一个服务。但随着服务的增加，人们开始迷惑：</span>Google<span>到底要干什么？一大堆杂七杂八的在线服务，相互之间并没有任何根本的联系，难免让人一头雾水。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Google<span>也感觉到了用户的迷惑，于是在</span>2008<span>年初抛出了&ldquo;云计算&rdquo;的概念。当然，云计算早已有之，而且第一个推出商业云计算平台的也不是</span>Google<span>而是</span>Amazon<span>。但无论如何，</span>Google<span>的云计算确实能够从某种程度上解释它的一系列服务，但细细想来却也有些牵强，毕竟有些服务很难往云计算上靠拢，比如</span>Picasa&nbsp;<span>等桌面软件；另一方面，把搜索引擎、网络邮箱等等都归结为云计算，未免有些宽泛，如此一来岂不是所有推出网络邮箱的公司都可以算作云计算服务商？那云计算岂不是也没有多大的技术含量？尽管我很早就对&ldquo;网格计算&rdquo;心向往之，对于云计算也是非常期待，但我对</span>Google<span>云计算的一些定义表示怀疑。业界短期内也不能就&ldquo;云计算&rdquo;达成共识，现在还只是处于概念炒作阶段。毕竟</span>Google<span>的迅猛发展很大程度上是通过并购实现的，</span>Picasa<span>本来并不是</span>Google<span>的产品。对于</span>Google<span>云计算总体的感觉是比较粗糙。但我坚信在所有口口声声要做云计算的公司中，</span>Google<span>无疑是最有技术实力的一个。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>由于</span>Google<span>的优势在于网络，本能的要将所有的服务放在&ldquo;云&rdquo;上，尽可能的摆脱&ldquo;端&rdquo;的束缚。而微软恰恰相反，微软的云计算理念是尽可能的延缓应用向&ldquo;云&rdquo;的迁移，延缓&ldquo;端&rdquo;（</span>Windows<span>）的寿命。只有&ldquo;云&rdquo;而没有&ldquo;端&rdquo;，则&ldquo;云&rdquo;就成了断线的风筝，无法为用户所使用。而</span>Google<span>又要慢慢绕开微软的&ldquo;端&rdquo;，因此便于去年</span>9<span>月份推出了</span>Chrome<span>浏览器，要用自己的浏览器去取代操作系统，所有的云端应用都可以在</span>Chrome<span>上完成。而且</span>Chrome<span>本身的设计就融入了操作系统的理念，其意图相当明显。</span>Google<span>的确很高明，推出</span>Chrome<span>的目的并不是真的要花大力气加入浏览器的竞争，即便</span>Chrome<span>失败了或者市场占用率很低（这几乎是可以肯定的，毕竟优秀如</span>Firefox<span>者深耕多年也只落得</span>20%<span>的占有率），也能加剧浏览器的竞争，促进浏览器的发展，从而加速网络应用的普及。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>可就是这样一款颇具战略意义的产品，其表现却有些令人失望。</span>Chrome<span>的优点自不待言，但缺点也很明显：自身兼容性较差&mdash;&mdash;</span>Google<span>已经有很多应用，但这些应用有时竟然不能使用（最令我不能容忍的就是半年过去了谷歌金山词霸仍然不支持</span>Chrome<span>屏幕取词）；网页显示的极为丑陋&mdash;&mdash;很多网页在</span>IE<span>下面非常漂亮（</span>HTML<span>标准的网页），但</span>Chrome<span>现实出来就很难看，同样大小的竟然显示的有大有小、有粗有细；地址栏不够只能&mdash;&mdash;和Firefox的地址栏相比，尽管Chrome有自己的优势（集成搜索），但明显没有Firefox的智能；收藏夹很难找到&mdash;&mdash;这其实是一个用户习惯的问题，我很欣赏</span>Google<span>的简洁明快，但</span>Google<span>没有把收藏夹放在显著的位置而且如果不打开新的标签页就很难找到，这一点我实在有点想不通。另外，</span>Chrome<span>的</span>Linux<span>版本迟迟没有发布，也着实令人不爽。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>说到</span>Google<span>的&ldquo;端&rdquo;，就不得不再捎带谈一谈</span>Google Android<span>。</span>Android<span>本来也不是</span>google<span>的产品，</span>Google<span>貌似于</span>2004<span>年收购了</span>Android<span>公司，并继续在此基础上开发</span>Android<span>手机操作系统。</span>Android<span>本来可以是一款划时代的手机操作系统，可惜生不逢时，风头被</span>iPhone<span>占尽。</span>Google<span>于去年也仿照</span>Apple Store<span>推出了</span>Android Store<span>，尽管条件比</span>Apple Store<span>优惠的多，但至今里面的应用不足</span>1000<span>个。也许是因为很难在手机领域有重大突破，</span>Google<span>已经将</span>Andorid<span>的重心转到了</span>netbook<span>上面（离职的前</span>Goolge Andoid<span>负责人披露），据说有人轻松的将</span>Android<span>移植到</span>EeePC<span>上。但</span>netbook<span>上的竞争对手又何其之多：</span>Moblin<span>，</span>Ubuntu<span>，</span>WindowsXP/Windows 7<span>&hellip;&hellip;尽管出师不利，</span>Google<span>已经决定在移动领域大展拳脚了。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Google<span>近来的表现，愈发显示出其龙钟老态。先是股价大跌、取消福利、员工离职，然后就是部分产品下线，随后又有取消年终奖（每人发了一部</span>G1<span>），紧接着就是把所有网页误认为恶意网页，始终伴随整个过程的就是宕机宕机&hellip;&hellip;</span>&nbsp;<span>负面消息不断涌现。显然，金融危机下的</span>Google&nbsp;<span>已经进入到了一个内外交困的关键阶段。曾经那个朝气蓬勃&ldquo;永不不作恶&rdquo;的</span>Google<span>，已经由当年的初出茅庐逐渐长大成熟，所有微软们、</span>yahoo<span>们遇到过的和没遇到过的问题都摆在了它的面前。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>最近</span>Twitter<span>风头正劲，有人语言</span>Twitter<span>将取代</span>Google<span>，因为</span>Twitter<span>对于实时新闻的搜索要好于</span>Google<span>。昨晚试了一下</span>Twitter<span>，注册只需几步，但浪费了我</span>40<span>分钟的时间也没有注册成功&mdash;&mdash;先是验证码以图片的形式出现，仔细看半天也看不懂是什么，听语音更是不懂，换了好几个验证码总算看清了也注册完成了，结果等到真正需要登录时却又说我用户名和密码错误！</span>My God!&nbsp;<span>也许我才疏学浅，我目前实在看不出</span>Twitter<span>有什么能力打败</span>Google<span>。今天</span>Google<span>真正的威胁还是来自它自己&hellip;&hellip;</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">【说明】：欢迎讨论，转载请注明出处&hellip;&hellip;</p>
</div>
<p>&nbsp;</p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/02/07/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520%25e4%25b9%258c%25e9%25be%2599%25e8%25ae%25b0%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">乌龙记</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-02-07</strong> with tags <a href="/tags.html#Personal-ref" rel="nofollow">Personal</a>
        </p>
        
        <div class="post_at_index thepost">
        <br />
<h1 style="text-align:center;">&nbsp;乌龙记</h1>
<div>
<div>
<p>&nbsp;</p>
<p>过去两个月一直都在忙一个Feature（我们公司把一个大项目分解成很多小功能，每个小功能叫做一个Feature），这也是我工作以来真正意义上的第一个Feature，总体而言，累并快乐着。&nbsp;</p>
<p>&nbsp;</p>
<p>公司是电信设备商，我去年7月一进公司就听说了并且逐渐感受到了公司产品的复杂&mdash;&mdash;既有历史的客观原因，也有人为的主观因素。通过做这个feature，才真正体会到了什么叫&ldquo;浩如烟海&rdquo;，哪个是&ldquo;沧海一粟&rdquo;。其实一开始在另外一个Team，等到快要真正开始做项目时又被转到了现在的team。现在做的是公司无线产品的仿真软件，已经由美国人做了十几年了，去年开始将一部分功能转移到中国做，而我就成了中国新组建的这个Team的一员。</p>
<p>&nbsp;</p>
<p>尽管公司已有百余年的历史，而且奠定了现在通用的好多计算机/通信技术，但公司的传统却是身教重于言传，言传胜过文档，而文档却又七零八落。美国的同事给我们培训的时候我们问的最多的就是&ldquo;文档在哪里&rdquo;，而美国的同事回答最多就是&ldquo;Reading the code&rdquo;。尽管公司现在已今非昔比，但公司里其实还是有很多牛人的，通过看code就知道，因为我经常看不懂。</p>
<p>&nbsp;</p>
<p>产品的code只是很小的一个方面，作为一个电信厂商，有很多更重要的东西需要Care，销售、管理、运营等我不熟悉的方面我就不谈了（因为无话可谈），但就软件而言（硬件我也不太懂），系统架构、代码管理、配置工具等等缺一不可。而这些东西在工作中又时常用到，人多手杂，天长日久也难免会出各种各样的问题。</p>
<p>&nbsp;</p>
<p>第一次做feature，最难的不是实现feature，而是熟悉一大套工具和流程。即便是feature本身也大多不是非常有创意或技术含量的东西，本应是对现有产品的尽可能的仿真却由于各种原因蜕变成了现实与模拟的妥协，而我们要做的事就是在各种铜墙铁壁中找出一条夹缝，然后在夹缝中求生存。做产品的仿真软件，有时要截弯取直，有时又不得不曲径通幽，变化之间，奇妙无穷。</p>
<p>&nbsp;</p>
<p>由于是公司内部用的仿真软件，因此不像电信产品那样要求稳定性、可靠性，只要能用来做测试就行了。一旦出了问题，重启一下软件继续。但是也正因为质量上要求不高，问题也是非常的多，每天都有很多用户发邮件找我们解决问题。同时我们又得不断开发新的feature以支持产品测试，每个人的压力还是很大的。我们刚接手，一个人也就当半个人用，可美国的那些同事，最少的也已经做了十年了，在经历了身边同事不断被裁掉的劫波之后，肩上的担子也越来越重。忙中也就难免会出错。</p>
<p>&nbsp;</p>
<p>前两天我在测试自己的Feature时，发现了一个问题，就是将产品中代码和我们自己代码build出来Product在用的时候一直出问题。看log并且反复测试了一天最后终于发现了问题的所在：产品中改了一个struct的定义，增加了一个成员，而我们的代码中没有做相应更改。于是就把我的发现发邮件告诉了美国的Mentor。晚上在家里加班时，美国的mentor在MOC（Microsoft Office Communicator，一款企业IM软件，说实话做的非常一般）上问我具体情况，我告诉了他我的判断。他起初很怀疑我的判断，我就演示给他看，他终于承认了这个问题的存在，但还是试图找出一种他更愿意接受的原因。用了两个小时，最终证明确实不是我们的问题，而是产品team造成的。Mentor查看了那个文件修改的历史，发现了一个不是我们team的人改了那个文件，于是告诉我可以问问那个人是否改过源文件。那天晚上我睡觉时已经凌晨3：50了。第二天白天我给那个人发了一封邮件，可是始终没有得到回复。</p>
<p>&nbsp;</p>
<p>第二天晚上，美国的Mentor和我查找产品team的负责人，由于公司team太多，每个team相对独立，很是费了一番力气。找到以后，mentor告诉我可以联系那个负责人。因为已经很晚了，于是我说我明天给他发邮件，可是mentor说他可以帮我立刻发邮件确认一下。由于那个产品也是由美国人负责，很快邮件得到恢复，说那人已经不再负责那个产品了，让我们联系另外一个人。我们有联系了另外一个人，那个人说他是manager，具体技术问题联系他的一个手下的员工。Mentor在MOC上加了那个产品的owner，由于之前有默契，Mentor和我组团忽悠产品owner，希望他们能调整一下那个struct新加入成员的顺序，把它加到最后，那样对我们的影响是最小的。尽管我们很卖力的忽悠，但人家认定现在已经不好改了，而且我们仿真软件就应该服务于产品，不能本末倒置，无果。于是mentor让我着手改我们的代码，而且越快解决越好。那天晚上睡觉时意识凌晨4：00多。</p>
<p>&nbsp;</p>
<p>第三天白天下午我才去上班，上午在睡觉。刚到公司就有一个人给我打电话，问我关于那个struct的问题。原来那人已经再上一个release对我们的代码做了private的更改，上一个release的更改已经提交，只是这个release的还没有提交，要等到产品的代码提交后才可以。可是现在产品已经提交了，他们却并不知道，只能等到下一个load在提交了。难怪一个月以来没有用户反应这个问题，而在最新的release中我却碰到了问题呢。形势豁然开朗，终于不用我们再负责这个问题了。立马发邮件给mentor，告诉他这个好消息。</p>
<p>&nbsp;</p>
<p>晚上mentor回复我的邮件，深表欣慰。他说那人提交代码的时候应该找我们team的人作为inspector，他找了吗？我回复说应该没有，不然我们应该会知道更改的。没想到mentor很快又发邮件给我说他想起来了，那个人确实找我们team做inspect了，那个inspector就是他&mdash;&mdash;我的mentor！我顿时无语，只好给他恢复了&ldquo;OMG！^_^&rdquo;。</p>
<p>&nbsp;</p>
<p>这种骑驴找驴的乌龙事件尽管耽误了我们不少时间，但想想也很有意思，因此尽管已经很晚了，我还是坚持把它记下来（其实我的生物钟已经和格林威治时间同步了，再修炼一段时间估计去美国就不用倒时差了^_^）。</p>
<div></div>
</div>
</div>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/01/13/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520perl%2520notes%2528iii%2529%2520-%2520introduction%2520to%2520berkeley%2520sockets%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">Perl Notes(III) -- Introduction To Berkeley Sockets</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-01-13</strong> with tags <a href="/tags.html#Network/Telecom-ref" rel="nofollow">Network/Telecom</a>, <a href="/tags.html#Perl-ref" rel="nofollow">Perl</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>
<span class="Apple-style-span" style="color:rgb(0,0,0);font-family:Verdana;font-size:13px;"><br />
<h3 style="font-size:12pt;">3 Introduction To Berkeley Sockets<br /></h3>
<h4 style="font-size:10pt;"><a name="3_1_Berkeley_Sockets__7180656138807535" id="3_1_Berkeley_Sockets__7180656138807535"></a>3.1 Basic Concepts</h4>
<h5 style="font-size:8pt;"></h5>
<h5 style="font-size:8pt;"><a name="3_1_1_Binary_versus_Text_Orien" id="3_1_1_Binary_versus_Text_Orien"></a>3.1.1 Binary versus Text-Oriented Protocols<br /></h5>
<p></span>
<p class="docText" style="margin:0;">Before they can exchange information across the network, hosts have a fundamental choice to make. They can exchange data either in binary form or as human-readable text. The choice has far-reaching ramifications.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">To understand this, consider exchanging the number 1984. To exchange it as text, one host sends the other the string <tt>1984</tt>, which, in the common ASCII character set, corresponds to the four hexadecimal bytes <tt>0x31</tt> <tt>0x39</tt> <tt>0x38</tt> <tt>0x34</tt>. These four bytes will be transferred in order across the network, and (provided the other host also speaks ASCII) will appear at the other end as "1984".</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">However, 1984 can also be treated as a number, in which case it can fit into the two-byte integer represented in hexadecimal as <tt>0x7C0</tt>. If this number is already stored in the local host as a number, it seems sensible to transfer it across the network in its native two-byte form rather than convert it into its four-byte text representation, transfer it, and convert it back into a two-byte number at the other end. Not only does this save some computation, but it uses only half as much network capacity.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Unfortunately, there's a hitch. Different computer architectures have different ways of storing integers and floating point numbers. Some machines use two-byte integers, others four-byte integers, and still others use eight-byte integers. This is called <span class="Apple-style-span" style="font-weight:bold;">word size</span>. Furthermore, computer architectures have two different conventions for storing integers in memory. In some systems, called <span class="Apple-style-span" style="font-weight:bold;">big-endian</span> architectures, the most significant part of the integer is stored in the first byte of a two-byte integer. On such systems, reading from low to high, 1984 is represented in memory as the two bytes:</p>
<pre>0x07    0xC0
low  -&gt; high
</pre>
<p class="docText" style="margin:0;">On <span class="Apple-style-span" style="font-weight:bold;">little-endian</span> architectures, this convention is reversed, and 1984 is stored in the opposite orientation:</p>
<pre>0xC0    0x07
low  -&gt; high
</pre>
<p class="docText" style="margin:0;">These architectures are a matter of convention, and neither has a significant advantage over the other. The problem comes when transferring such data across the network, because this byte pair has to be transferred serially as two bytes. Data in memory is sent across the network from low to high, so for big-endian machines the number 1984 will be transferred as <tt>0x07 0xC0</tt>, while for little-endian machines the numbers will be sent in the reverse order. As long as the machine at the other end has the same native word size and byte order, these bytes will be correctly interpreted as 1984 when they arrive. However, if the recipient uses a different byte order, then the two bytes will be interpreted in the wrong order, yielding hexadecimal <tt>0xC007</tt>, or decimal 49,159. Even worse, if the recipient interprets these bytes as the top half of a four-byte integer, it will end up as <tt>0xC0070000</tt>, or 3,221,684,224. Someone's anniversary party is going to be very late.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Because of the potential for such binary chaos, text-based protocols are the norm on the Internet. All the common protocols convert numeric information into text prior to transferring them, even though this can result in more data being transferred across the net. Some protocols even convert data that doesn't have a sensible text representation, such as audio files, into a form that uses the ASCII character set, because this is generally easier to work with. By the same token, a great many protocols are line-oriented, meaning that they accept commands and transmit data in the form of discrete lines, each terminated by a commonly agreed-upon newline sequence.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">A few protocols, however, are binary. Examples include Sun's Remote Procedure Call (<span class="Apple-style-span" style="font-weight:bold;">RPC</span>) system, and the Napster peer-to-peer file exchange protocol. Such protocols have to be exceptionally careful to represent binary data in a common format.<span class="Apple-style-span" style="text-decoration:underline;"> For integer numbers, there is a commonly recognized network format. In network format, a "short" integer is represented in two big-endian bytes, while a "long" integer is represented with four big-endian bytes.</span> Perl's <tt>pack()</tt> and <tt>unpack ()</tt> functions provide the ability to convert numbers into network format and back again.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Floating point numbers and more complicated things like data structures have no commonly accepted network representation. When exchanging binary data, each protocol has to work out its own way of representing such data in a platform-neutral fashion.</p>
<h5 style="font-size:8pt;"><a name="3_1_2_Berkeley_Sockets_" id="3_1_2_Berkeley_Sockets_"></a>3.1.2 Berkeley Sockets<br /></h5>
<p class="docText" style="margin:0;">Berkeley sockets are part of an application programming interface (API) that specifies the data structures and function calls that interact with the operating system's network subsystem. Berkeley sockets are part of an API, not a specific protocol, which defines how the programmer interacts with an idealized network.</p>
<h4 style="font-size:10pt;"><a name="3_2_The_Anatomy_of_a_Socket__8158409828320146" id="3_2_The_Anatomy_of_a_Socket__8158409828320146"></a>3.2 The Anatomy of a Socket<br /></h4>
<p class="docText" style="margin:0;">
<p class="docText" style="margin:0;">A socket is an endpoint for communications, a portal to the outside world that we can use to send outgoing messages to other processes, and to receive incoming traffic from processes interested in sending messages to us.</p>
<p class="docText" style="margin:0;">To create a socket, we need to provide the system with a minimum of three pieces of information.</p>
<p style="margin:0;">
<h5 style="font-size:8pt;"><a name="3_2_1_The_Socket_s_Domain__19930865615606308" id="3_2_1_The_Socket_s_Domain__19930865615606308"></a>3.2.1 The Socket's Domain<br /></h5>
<p class="docText" style="margin:0;">The <span class="docEmphasis">domain</span> defines the family of networking protocols and addressing schemes that the socket will support. The domain is selected from a small number of integer constants defined by the operating system and exported by Perl's Socket module. There are only two common domains</p>
<p style="margin:0;">
<p style="margin:0;">
<p>
<div style="text-align:center;margin-top:0;margin-bottom:0;">Table 3.1. Common Socket Domains</div>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Constant</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_INET</tt></td>
<td class="docTableCell" valign="top">The Internet protocols</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_UNIX</tt></td>
<td class="docTableCell" valign="top">Networking within a single host</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">In addition to these domains, there are many others including <tt>AF_APPLETALK</tt>, <tt>AF_IPX</tt>, and <tt>AF_X25</tt>, each corresponding to a particular addressing scheme. <tt>AF_INET6</tt>, corresponding to the long addresses of TCP/IP version 6, will become important in the future, but is not yet supported by Perl. The <tt>AF_</tt> prefix stands for "address family." In addition, there is a series of "protocol family" constants starting with the <tt>PF_</tt> prefix.</p>
<h5 style="font-size:8pt;"><a name="3_2_2_The_Socket_s_Type__09139745496213436" id="3_2_2_The_Socket_s_Type__09139745496213436"></a>3.2.2 The Socket's Type<br /></h5>
<p style="margin:0;">
<p style="margin:0;">The socket type identifies the basic properties of socket communications.</p>
<p style="margin:0;">
<p style="margin:0;">
<p>
<div style="text-align:center;margin-top:0;margin-bottom:0;">Table 3.2. Constants Exported by Socket</div>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Constant</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>SOCK_STREAM</tt></td>
<td class="docTableCell" valign="top">A continuous stream of data</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>SOCK_DGRAM</tt></td>
<td class="docTableCell" valign="top">Individual packets of data</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>SOCK_RAW</tt></td>
<td class="docTableCell" valign="top">Access to internal protocols and interfaces</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Perl fully supports the <tt>SOCK_STREAM</tt> and <tt>SOCK_DGRAM</tt> socket types. <tt>SOCK_RAW</tt> is supported through an add-on module named Net::Raw.</p>
<h5 style="font-size:8pt;"><a name="3_2_3_The_Socket_s_Protocol__21901176124811172" id="3_2_3_The_Socket_s_Protocol__21901176124811172"></a>3.2.3 The Socket's Protocol<br /></h5>
<p class="docText" style="margin:0;">Like the domain and socket type, the protocol is a small integer. However, the protocol numbers are not available as constants, but instead must be looked up at run time using the Perl <span class="docEmphasis">getprotobyname()</span> function.</p>
<p class="docText" style="margin:0;"></p>
<div style="text-align:center;margin-top:0;margin-bottom:0;">Table 3.3. Some Socket Protocols</div>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Protocol</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>tcp</tt></td>
<td class="docTableCell" valign="top">Transmission Control Protocol for stream sockets</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>udp</tt></td>
<td class="docTableCell" valign="top">User Datagram Protocol for datagram sockets</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>icmp</tt></td>
<td class="docTableCell" valign="top">Internet Control Message Protocol</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>raw</tt></td>
<td class="docTableCell" valign="top">Creates IP packets manually</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The TCP and UDP protocols are supported directly by the Perl sockets API. You can get access to the ICMP and raw protocols via the Net::ICMP and Net::Raw third-party modules.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">
<p class="docText" style="margin:0;">The allowed combinations of socket domain, type, and protocol are few. <tt>SOCK_STREAM</tt> goes with TCP, and <tt>SOCK_DGRAM</tt> goes with UDP. Also notice that the <tt>AF_UNIX</tt> address family doesn't use a named protocol, but a pseudoprotocol named <tt>PF_UNSPEC</tt> (for "unspecified").</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">
<p style="margin:0;">
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<caption></caption>
<p style="margin:0;">Table 3.4. Allowed Combinations of Socket Type and Protocol in the INET and UNIX Domains</p>
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Domain</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Type</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Protocol</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_INET</tt></td>
<td class="docTableCell" valign="top"><tt>SOCK_STREAM</tt></td>
<td class="docTableCell" valign="top">tcp</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_INET</tt></td>
<td class="docTableCell" valign="top"><tt>SOCK_DGRAM</tt></td>
<td class="docTableCell" valign="top">udp</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_UNIX</tt></td>
<td class="docTableCell" valign="top"><tt>SOCK_STREAM</tt></td>
<td class="docTableCell" valign="top"><tt>PF_UNSPEC</tt></td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>AF_UNIX</tt></td>
<td class="docTableCell" valign="top"><tt>SOCK_DGRAM</tt></td>
<td class="docTableCell" valign="top"><tt>PF_UNSPEC</tt></td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<h5 style="font-size:8pt;"><a name="3_2_4_Datagram_Sockets_" id="3_2_4_Datagram_Sockets_"></a>3.2.4 Datagram Sockets<br /></h5>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="font-weight:bold;">Datagram-type sockets provide for the transmission of connectionless, unreliable, unsequenced messages.</span> The UDP is the chief datagram-style protocol used by the Internet protocol family.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">
<p class="docText" style="margin:0;">As the diagram in <a class="docLink">Figure 3.2</a> shows, datagram services resemble the postal system. Like a letter or a telegram, each datagram in the system carries its destination address, its return address, and a certain amount of data. The Internet protocols will make the best effort to get the datagram delivered to its destination.</p>
<p style="margin:0;"></p>
<p style="margin:0;">Figure 3.2. Datagram sockets provide connectionless, unreliable, unsequenced transmission of message</p>
<h5 class="docFigureTitle" style="font-size:8pt;"><a name="ch03fig02"></a></h5>
<p class="docText" style="margin:0;">
<div id="kkjg" style="text-align:center;margin-top:0;margin-bottom:0;padding:1em 0;"><img src="http://docs.google.com/File?id=dd6nw3mt_216fwpbb2gn_b" style="width:500px;height:318px;" /></div>
<p style="margin:0;">
<p class="docText" style="margin:0;">There is no long-term relationship between the sending socket and the recipient socket: A client can send a datagram off to one server, then immediately turn around and send a datagram to another server using the same socket. But the connectionless nature of UDP comes at a price. Like certain countries' postal systems, it is very possible for a datagram to get "lost in the mail." A client cannot know whether a server has received its message until it receives an acknowledgment in reply. Even then, it can't know for sure that a message was lost, because the server might have received the original message and the acknowledgment got lost!</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Datagrams are neither synchronized nor flow controlled. If you send a set of datagrams out in a particular order, they might not arrive in that order. Because of the vagaries of the Internet, the first datagram may go by one route, and the second one may take a different path. If the second route is faster than the first one, the two datagrams may arrive in the opposite order from which they were sent. It is also possible for a datagram to get duplicated in transit, resulting in the same message being received twice.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Because of the connectionless nature of datagrams, there is no flow control between the sender and the recipient. If the sender transmits datagrams faster than the recipient can process them, the recipient has no way to signal the sender to slow down, and will eventually start to discard packets.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="text-decoration:underline;">Although a datagram's delivery is not reliable, its contents are. </span>Modern implementations of UDP provide each datagram with a checksum that ensures that its data portion is not corrupted in transit.</p>
<p style="margin:0;">
<p style="margin:0;">
<p style="margin:0;">
<p style="margin:0;">
<p style="margin:0;">
<h5 style="font-size:8pt;"><a name="3_2_5_Stream_Sockets_" id="3_2_5_Stream_Sockets_"></a>3.2.5 Stream Sockets<br /></h5>
<p class="docText" style="margin:0;">The other major paradigm is stream sockets, implemented in the Internet domain as the TCP protocol. <span class="Apple-style-span" style="font-weight:bold;">Stream sockets provide sequenced, reliable bidirectional communications via byte-oriented streams. </span>As depicted in <a class="docLink">Figure 3.3</a>, stream sockets resemble a telephone conversation. Clients connect to servers using their address, the two exchange data for a period of time, and then one of the pair breaks off the connection.</p>
<p class="docText" style="margin:0;"></p>
<p style="margin:0;">Figure 3.3. Stream sockets provide sequenced, reliable, bidirectional communications</p>
<h5 class="docFigureTitle" style="font-size:8pt;"><a name="ch03fig03"></a></h5>
<p class="docText" style="margin:0;">
<div id="doch" style="text-align:center;margin-top:0;margin-bottom:0;padding:1em 0;"><img src="http://docs.google.com/File?id=dd6nw3mt_217c9kt3zft_b" style="width:500px;height:51px;" /></div>
<p style="margin:0;">
<p class="docText" style="margin:0;">Reading and writing to stream sockets is a lot like reading and writing to a file. There are no arbitrary size limits or record boundaries, although you can impose a record-oriented structure on the stream if you like. Because stream sockets are sequenced and reliable, you can write a series of bytes into a socket secure in the knowledge that they will emerge at the other end in the correct order, provided that they emerge at all ("reliable" does not mean immune to network errors).</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="text-decoration:underline;">TCP also implements flow control. </span>Unlike UDP, where the danger of filling the data-receiving buffer is very real, TCP automatically signals the sending host to suspend transmission temporarily when the reading host is falling behind, and to resume sending data when the reading host is again ready. This flow control happens behind the scenes and is ordinarily invisible.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Although it looks and acts like a continuous byte stream, the TCP protocol is actually implemented on top of a datagram-style service, in this case the low-level IP protocol. <span class="Apple-style-span" style="text-decoration:underline;">IP packets are just as unreliable as UDP datagrams, </span>so behind the scenes TCP is responsible for keeping track of packet sequence numbers, acknowledging received packets, and retransmitting lost packets.</p>
<h5 style="font-size:8pt;"><a name="3_2_6_Datagram_versus_Stream_S" id="3_2_6_Datagram_versus_Stream_S"></a>3.2.6 Datagram versus Stream Sockets<br /></h5>
<p class="docText" style="margin:0;">With all its reliability problems, you might wonder why anyone uses UDP. The answer is that most client/server programs on the Internet use TCP stream sockets instead. In most cases, TCP is the right solution for you, too.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">There are some circumstances, however, in which UDP might be a better choice. For example, time servers use UDP datagrams to transmit the time of day to clients who use the information for clock synchronization. If a datagram disappears in transit, it's neither necessary nor desirable to retransmit it because by the time it arrives it will no longer be relevant.</p>
<p class="docText" style="margin:0;">UDP is also preferred when the interaction between one host and the other is very short. The length of time to set up and take down a TCP connection is about eightfold greater than the exchange of a single byte of data via UDP (for details, see [Stevens 1996]). If relatively small amounts of data are being exchanged, the TCP setup time will dominate performance. Even after a TCP connection is established, each transmitted byte consumes more bandwidth than UDP because of the additional overhead for ensuring reliability.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Another common scenario occurs when a host must send the same data to many places; for example, it wants to transmit a video stream to multiple viewers. The overhead to set up and manage a large number of TCP connections can quickly exhaust operating system resources, because a different socket must be used for each connection. In contrast, sending a series of UDP datagrams is much more sparing of resources. The same socket can be reused to send datagrams to many hosts.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="text-decoration:underline;">Whereas TCP is always a one-to-one connection, UDP also allows one-to-many and many-to-many transmissions.</span> At one end of the spectrum, you can address a UDP datagram to the "broadcast address," broadcasting a message to all listening hosts on the local area network. At the other end of the spectrum, you can target a message to a predefined group of hosts using the "multicast" facility of modern IP implementations. These advanced features are covered in <a class="docLink">Chapters 20</a> and <a class="docLink">21</a>.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The Internet's DNS is a common example of a UDP-based service. It is responsible for translating hostnames into IP addresses, and vice versa, using a loose-knit network of DNS servers. If a client does not get a response from a DNS server, it just retransmits its request. The overhead of an occasional lost datagram outweighs the overhead of setting up a new TCP connection for each request. Other common examples of UDP services include Sun's Network File System (NFS) and the Trivial File Transfer Protocol (TFTP). The latter is used by diskless workstations during boot in order to load their operating system over the network. UDP was originally chosen for this purpose because its implementation is relatively small. Therefore, UDP fit more easily into the limited ROM space available to workstations at the time the protocol was designed.</p>
<h4 style="font-size:10pt;"><a name="3_3_Socket_Addressing_" id="3_3_Socket_Addressing_"></a>3.3 Socket Addressing<br /></h4>
<p class="docText" style="margin:0;">For the UNIX domain, which can be used only between two processes on the same host machine, addresses are simply paths on the host's filesystem, such as <tt>/usr/tmp/log</tt>. For the Internet domain, each socket address has three parts: the IP address, the port, and the protocol.</p>
<h5 style="font-size:8pt;"><a name="3_3_1_IP_Addresses_" id="3_3_1_IP_Addresses_"></a>3.3.1 IP Addresses<br /></h5>
<p class="docText" style="margin:0;">
<p class="docText" style="margin:0;">Many of Perl's networking calls require you to work with IP addresses in the form of packed binary strings. IP addresses can be converted manually to binary format and back again using <tt>pack()</tt> and <tt>unpack()</tt> with a template of "C4" (four unsigned characters). For example, here's how to convert 18.157.0.125 into its packed form and then reverse the process:</p>
<pre>($a,$b,$c,$d)      = split //./, '18.157.0.125';
$packed_ip_address = pack 'C4',$a,$b,$c,$d;
($a,$b,$c,$d)      = unpack 'C4',$packed_ip_address;
$dotted_ip_address = join '.', $a,$b,$c,$d;</pre>
<p class="docText" style="margin:0;">Most hosts have two addresses, the "<span class="Apple-style-span" style="font-weight:bold;">loopback" address</span> 127.0.0.1 (often known by its symbolic name "localhost") and its <span class="Apple-style-span" style="font-weight:bold;">public Internet address</span>. The loopback address is associated with a device that loops transmissions back onto itself, allowing a client on the host to make an outgoing connection to a server running on the same host. Although this sounds a bit pointless, it is a powerful technique for application development, because it means that you can develop and test software on the local machine without access to the network.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The public Internet address is associated with the host's network interface card, such as an Ethernet card. The address is either assigned to the host by the network administrator or, in systems with dynamic host addressing, by a Boot Protocol (BOOTP) or Dynamic Host Configuration Protocol (DHCP) server. If a host has multiple network interfaces installed, each one can  have a distinct IP address. It's also possible for a single interface to be configured to use several addresses. </p>
<h5 style="font-size:8pt;"><a name="3_3_2_Reserved_IP_Addresses_Su" id="3_3_2_Reserved_IP_Addresses_Su"></a>3.3.2 Reserved IP Addresses, Subnets, and Netmasks<br /></h5>
<p class="docText" style="margin:0;">In order for a packet of information to travel from one location to another across the Internet, it must hop across a series of physical networks. For example, a packet leaving your desktop computer must travel across your LAN (local area network) to a modem or router, then across your Internet service provider's (ISP) regional network, then across a backbone to another ISP's regional network, and finally to its destination machine.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Network routers keep track of how the networks interconnect, and are responsible for determining the most efficient route to get a packet from point A to point B. However, if IP addresses were allocated ad hoc, this task would not be feasible because each router would have to maintain a map showing the locations of all IP addresses. Instead, IP addresses are allocated in contiguous chunks for use in organizational and regional networks.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">For example, my employer, the Cold Spring Harbor Laboratory (CSHL), owns the block of IP addresses that range from 143.48.0.0 through 143.48.255.255 (this is a so-called class B address). When a backbone router sees a packet addressed to an IP address in this range, it needs only to determine how to get the packet into CSHL's network. It is then the responsibility of CSHL's routers to get the packet to its destination. In practice, CSHL and other large organizations split their allocated address ranges into several subnets and use routers to interconnect the parts.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">A computer that is sending out an IP packet must determine whether the destination machine is directly reachable (e.g., over the Ethernet) or whether the packet must be directed to a router that interconnects the local network to more distant locations. The basic decision is whether the packet is part of the local network or part of a distant network.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">To make this decision possible, <span class="Apple-style-span" style="text-decoration:underline;">IP addresses are arbitrarily split into a </span><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="text-decoration:underline;">host part</span></span><span class="Apple-style-span" style="text-decoration:underline;"> and a </span><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="text-decoration:underline;">network part</span></span>. For example, in CSHL's network, the split occurs after the second byte: the network part is 143.48. and the host part is the rest. So 143.48.0.0 is the first address in CSHL's network, and 143.48.255.255 is the last.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="text-decoration:underline;">To describe where the network/host split occurs for routing purposes, networks use a netmask, which is a bitmask with 1s in the positions of the network part of the IP address.</span> Like the IP address itself, the netmask is usually written in dotted-quad form. Continuing with our example, CSHL has a netmask of 255.255.0.0, which, when written in binary, is 11111111,11111111,00000000,00000000.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Historically, IP networks were divided into three classes on the basis of their netmasks (<a class="docLink">Table 3.5)</a>. Class A networks have a netmask of 255.0.0.0 and approximately 16 million hosts. Class B networks have a netmask of 255.255.0.0 and some 65,000 hosts, and class C networks use the netmask 255.255.255.0 and support 254 hosts (as we will see, the first and last host numbers in a network range are unavailable for use as a normal host address).</p>
<p class="docText" style="margin:0;"></p>
<p><a name="ch03table05"></a>
<p style="margin:0;"></p>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<caption></caption>
<p style="margin:0;">Table 3.5. Address Classes and Their Netmasks</p>
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Class</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Netmask</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Example Address</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Network Park</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Host Part</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">A</td>
<td class="docTableCell" valign="top">255.0.0.0</td>
<td class="docTableCell" valign="top">120.155.32.5</td>
<td class="docTableCell" valign="top">120.</td>
<td class="docTableCell" valign="top">155.32.5</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">B</td>
<td class="docTableCell" valign="top">255.255.0.0</td>
<td class="docTableCell" valign="top">128.157.32.5</td>
<td class="docTableCell" valign="top">128.157.</td>
<td class="docTableCell" valign="top">32.5</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">C</td>
<td class="docTableCell" valign="top">255.255.255.0</td>
<td class="docTableCell" valign="top">192.66.12.56</td>
<td class="docTableCell" valign="top">192.66.12.</td>
<td class="docTableCell" valign="top">56</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">As the Internet has become more crowded, however, networks have had to be split up in more flexible ways. It's common now to see netmasks that don't end at byte boundaries. For example, the netmask 255.255.255.128 (binary 11111111,11111111,11111111,10000000) splits the last byte in half, creating a set of 126-host networks. The modern Internet routes packets based on this more flexible scheme, called <span class="Apple-style-span" style="font-weight:bold;">Classless Inter-Domain Routing (CIDR)</span>. C<span class="Apple-style-span" style="text-decoration:underline;">IDR uses a concise convention to describe networks in which the network address is followed by a slash and an integer containing the number of 1s in the mask</span>. For example, CSHL's network is described by the CIDR address 143.48.0.0/16. CIDR is described in detail in RFCs 1517 through 1520, and in the FAQs listed in <a class="docLink">Appendix D</a>.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Figuring out the network and broadcast addresses can be confusing when you work with netmasks that do not end at byte boundaries. The Net::Netmask module, available on CPAN, provides facilities for calculating these values in an intuitive way. You'll also find a short module that I wrote, Net::NetmaskLite, in Appendix A. You might want to peruse this code in order to learn the relationships among the network address, broadcast address, and netmask.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The first and last addresses in a subnet have special significance and cannot be used as ordinary host addresses. <span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);"><span class="Apple-style-span" style="font-weight:normal;"><span class="Apple-style-span" style="text-decoration:underline;">The first address, sometimes known as the all-zeroes address, is reserved for use in routing tables to denote the network as a whole (</span></span><span class="Apple-style-span" style="text-decoration:underline;">network address</span><span class="Apple-style-span" style="font-weight:normal;"><span class="Apple-style-span" style="text-decoration:underline;">).</span></span> </span></span><span class="Apple-style-span" style="color:rgb(255,0,0);"><span class="Apple-style-span" style="text-decoration:underline;">The last address in the range, known as the all-ones address, is reserved for use as the </span><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="text-decoration:underline;">broadcast address</span></span><span class="Apple-style-span" style="text-decoration:underline;">. IP packets sent to this address will be received by all hosts on the subnet.</span></span> For example, for the network 192.18.4.x (a class C address or 192.18.4.0/24 in CIDR format), the network address is 192.18.4.0 and the broadcast address is 192.18.4.255. </p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">In addition, several IP address ranges have been set aside for special purposes (<a class="docLink">Table 3.6</a>). The class A network 10.x.x.x, the 16 class B networks 172.16.x.x through 172.31.x.x, and the 255 class C addresses 192.168.0.x through 192.168.255.x are reserved for use as internal networks. An organization may use any of these networks internally, but must not connect the network directly to the Internet. The 192.168.x.x networks are used frequently in testing, or placed behind firewall systems that translate all the internal network addresses into a single public IP address. The network addresses 224.x.x.x through 239.x.x.x are reserved for multicasting applications, and everything above 240.x.x.x is reserved for future expansion.</p>
<p class="docText" style="margin:0;"></p>
<p><a name="ch03table06"></a>
<p style="margin:0;"></p>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<caption></caption>
<p style="margin:0;">Table 3.6. Reserved IP Addresses</p>
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Address</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">127.0.0.x</td>
<td class="docTableCell" valign="top">Loopback interface</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">10.x.x.x</td>
<td class="docTableCell" valign="top">Private class A address</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">172.16.x.x–172.32.x.x</td>
<td class="docTableCell" valign="top">Private class B addresses</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top">192.168.0.x–172.168.255.x</td>
<td class="docTableCell" valign="top">Private class C addresses</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Finally, IP address 127.0.0.x is reserved for use as the loopback network. Anything sent to an address in this range is received by the local host.</p>
<p style="margin:0;">
<h5 style="font-size:8pt;"><a name="3_3_3_Network_Ports_" id="3_3_3_Network_Ports_"></a>3.3.3 Network Ports<br /></h5>
<p class="docText" style="margin:0;">Once a message reaches its destination IP address, there's still the matter of finding the correct program to deliver it to. It's common for a host to be running multiple network servers, and it would be impractical, not to say confusing, to deliver the same message to them all. That's where the port number comes in. <span class="Apple-style-span" style="text-decoration:underline;">The port number part of the socket address is an unsigned 16-bit number ranging from 1 to 65535</span>. In addition to its IP address, each active socket on a host is identified by a unique port number; this allows messages to be delivered unambiguously to the correct program. When a program creates a socket, it may ask the operating system to associate a port with the socket. If the port is not being used, the operating system will grant this request, and will refuse other programs access to the port until the port is no longer in use. If the program doesn't specifically request a port, one will be assigned to it from the pool of unused port numbers.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="text-decoration:underline;">There are actually two sets of port numbers, one for use by TCP sockets, and the other for use by UDP-based programs. It is perfectly all right for two programs to be using the same port number provided that one is using it for TCP and the other for UDP.</span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Not all port numbers are created equal. <span class="Apple-style-span" style="color:rgb(0,0,255);"><span class="Apple-style-span" style="text-decoration:underline;">The ports in the range 0 through 1023 are reserved for the use of "</span><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="text-decoration:underline;">well-known</span></span><span class="Apple-style-span" style="text-decoration:underline;">" services, which are assigned and maintained by ICANN, the Internet Corporation for Assigned Names and Numbers.</span></span> For example, TCP port 80 is reserved for use for the HTTP used by Web servers, TCP port 25 is used for the SMTP used by e-mail transport agents, and UDP port 53 is used for the domain name service (DNS). Because these ports are well known, you can be pretty certain that a Web server running on a remote machine will be listening on port 80. On UNIX systems, only the root user (i.e., the superuser) is allowed to create a socket using a reserved port. This is partly to prevent unprivileged users on the system inadvertently running code that will interfere with the operations of the host's network services.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">Most services are either TCP- or UDP-based, but some can communicate with both protocols. In the interest of future compatibility, ICANN usually reserves both the UDP and TCP ports for each service. However, there are many exceptions to this rule. For example, TCP port 514 is used on UNIX systems for remote shell (login) services, while UDP port 514 is used for the system logging daemon.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">In some versions of UNIX, the high-numbered ports in the range 49152 through 65535 are reserved by the operating system for use as "ephemeral" ports to be assigned automatically to outgoing TCP/IP connections when a port number hasn't been explicitly requested. The remaining ports, those in the range 1024 through 49151, are free for use in your own applications, provided that some other service has not already claimed them. It is a good idea to check the ports in use on your machine by using one of the network tools introduced later in this chapter (Network Analysis Tools) before claiming one.</p>
<h5 style="font-size:8pt;"><a name="3_3_4_The_sockaddr_in_Structur" id="3_3_4_The_sockaddr_in_Structur"></a>3.3.4 The <tt><span class="Apple-style-span" style="font-family:Verdana;">sockaddr_in</span></tt> Structure<br /></h5>
<p class="docText" style="margin:0;">A socket address is the combination of the host address and the port, packed together in a binary structure called a <span class="docEmphasis"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="font-family:Georgia;">sockaddr_in</span></span>.</span> This corresponds to a C structure of the same name that is used internally to call the system networking routines. (By analogy, UNIX domain sockets use a packed structure called a <span class="docEmphasis">sockaddr_un.</span>) Functions provided by the standard Perl Socket module allow you to create and manipulate <span class="docEmphasis">sockaddr_in</span> structures easily:</p>
<p class="docText" style="margin:0;"></p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$packed_address = inet_aton($dotted_quad)</span></span></span></p>
<p class="docText" style="margin:0;">Given an IP address in dotted-quad form, this function packs it into binary form suitable for use by <tt>sockaddr_in()</tt>. The function will also operate on symbolic hostnames. If the hostname cannot be looked up, it returns <tt>undef</tt>.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$dotted_quad = inet_ntoa($packed_address)</span></span></span></p>
<p class="docText" style="margin:0;">This function takes a packed IP address and converts it into human-readable dotted-quad form. It does <span class="docEmphasis"><tt>not</tt> </span>attempt to translate IP addresses into hostnames. You can achieve this effect by using <tt>gethostbyaddr()</tt>, discussed later.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$socket_addr = sockaddr_in($port,$address)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">($port,$address) = sockaddr_in($socket_addr)</span></span></span></p>
<p class="docText" style="margin:0;">When called in a scalar context, <tt>sockaddr_in()</tt> takes a port number and a binary IP address and packs them together into a socket address, suitable for use by <tt>socket()</tt>. When called in a list context, <tt>sockaddr_in()</tt> does the opposite, translating a socket address into the port and IP address. The IP address must still be passed through <tt>inet_ntoa()</tt> to obtain a human-readable string.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$socket_addr = pack_sockaddr_in($port,$address)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">($port,$address) = unpack_sockaddr_in($socket_addr)</span></span></span></p>
<p class="docText" style="margin:0;">If you don't like the confusing behavior of <tt>sockaddr_in()</tt>, you can use these two functions to pack and unpack socket addresses in a context-insensitive manner.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">In some references, you'll see a socket's address referred to as its "name." Don't let this confuse you. A socket's address and its name are one and the same.</p>
<p class="docText" style="margin:0;">3.4 </p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/01/13/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520perl%2520notes%2528ii%2529%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">Perl Notes(II)</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-01-13</strong> with tags <a href="/tags.html#Perl-ref" rel="nofollow">Perl</a>, <a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>
     <span class="Apple-style-span" style="color:rgb(0,0,0);font-family:Verdana;font-size:13px;"><span class="Apple-style-span" style="font-size:19px;font-weight:bold;">Part II<span>    Network Programming With Perl</span></span><br />
<h3 style="font-size:12pt;"><a name="1_Input_Output_Basics_" id="1_Input_Output_Basics_"></a>1 Input/Output Basics<br /></h3>
<h4 style="font-size:10pt;"><a name="1_1_Filehandles_" id="1_1_Filehandles_"></a>1.1 Filehandles<br /></h4>
<p></span>
<p class="docText" style="margin:0;">Filehandles are the foundation of networked applications. In this section we review the ins and outs of filehandles. Even if you're an experienced Perl programmer, you might want to scan this section to refresh your memory on some of the more obscure aspects of Perl I/O.</p>
<p><a name="ch01lev2sec7"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_1_Standard_Filehandles_" id="1_1_1_Standard_Filehandles_"></a>1.1.1 Standard Filehandles<br /></h5>
<p class="docText" style="margin:0;">A filehandle connects a Perl script to the outside world. Reading from a filehandle brings in outside data, and writing to one exports data. Depending on how it was created, a filehandle may be connected to a disk file, to a hardware device such as a serial port, to a local process such as a command-line window in a windowing system, or to a remote process such as a network server. It's also possible for a filehandle to be connected to a "bit bucket" device that just sucks up data and ignores it.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">A filehandle is any valid Perl identifier that consists of uppercase and lowercase letters, digits, and the underscore character. Unlike other variables, a filehandle does not have a distinctive prefix (like "$"). So to make them distinct, Perl programmers often represent them in all capital letters, or caps.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">When a Perl script starts, exactly three filehandles are open by default: <tt>STDOUT</tt>, <tt>STDIN</tt>, and <tt>STDERR</tt>. The <tt>STDOUT</tt> filehandle, for "standard output," is the default filehandle for output. Data sent to this filehandle appears on the user's preferred output device, usually the command-line window from which the script was launched. <tt>STDIN</tt>, for "standard input," is the default input filehandle. Data read from this filehandle is taken from the user's preferred input device, usually the keyboard. <tt>STDERR</tt> ("standard error") is used for error messages, diagnostics, debugging, and other such incidental output. By default <tt>STDERR</tt> uses the same output device as <tt>STDOUT</tt>, but this can be changed at the user's discretion. The reason that there are separate filehandles for normal and abnormal output is so that the user can divert them independently; for example, to send normal output to a file and error output to the screen.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">This code fragment will read a line of input from <tt>STDIN</tt>, remove the terminating end-of-line character with the <tt>chomp()</tt> function, and echo it to standard output:</p>
<pre>$input = &lt;STDIN&gt;;
chomp($input);
print STDOUT "If I heard you correctly, you said: $input/n";
</pre>
<p class="docText" style="margin:0;">By taking advantage of the fact that <tt>STDIN</tt> and <tt>STDOUT</tt> are the defaults for many I/O operations, and by combining <tt>chomp()</tt> with the input operation, the same code could be written more succinctly like this:</p>
<pre>chomp($input = &lt;&gt;);
print "If I heard you correctly, you said: $input/n";
</pre>
<p class="docText" style="margin:0;">We review the <tt>&lt;&gt;</tt> and <tt>print()</tt> functions in the next section. Similarly, <tt>STDERR</tt> is the default destination for the <tt>warn()</tt> and <tt>die()</tt> functions.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The user can change the attachment of the three standard filehandles before launching the script. On UNIX and Windows systems, this is done using the redirect metacharacters "&lt;" and "&gt;". For example, given a script named <span class="docEmphasis">muncher.pl</span> this command will change the script's standard input so that it comes from the file <span class="docEmphasis">data.txt</span>, and its standard output so that processed data ends up in <span class="docEmphasis">crunched.txt</span>:</p>
<pre>% <span class="docEmphStrong">muncher.pl &lt;data.txt &gt;crunched.txt</span>
						</pre>
<p class="docText" style="margin:0;">Standard error isn't changed, so diagnostic messages (e.g., from the built-in <tt>warn()</tt> and <tt>die()</tt> functions) appear on the screen.</p>
<p class="docText" style="margin:0;">On Macintosh systems, users can change the source of the three standard filehandles by selecting filenames from a dialog box within the MacPerl development environment.</p>
<p><a name="ch01lev2sec8"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_2_Input_and_Output_Operati" id="1_1_2_Input_and_Output_Operati"></a>1.1.2 Input and Output Operations<br /></h5>
<p class="docText" style="margin:0;">Perl gives you the option of reading from a filehandle one line at a time, suitable for text files, or reading from it in chunks of arbitrary length, suitable for binary byte streams like image files.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">For input, the <tt>&lt;&gt;</tt> operator is used to read from a filehandle in a line-oriented fashion, and <tt>read()</tt> or <tt>sysread()</tt> to read in a byte-stream fashion. For output, <tt>print()</tt> and <tt>syswrite()</tt> are used for both text and binary data (you decide whether to make the output line-oriented by printing newlines).</p>
<p class="docText" style="margin:0;"></p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$line = &lt;FILEHANDLE&gt;</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">@lines = &lt;FILEHANDLE&gt;</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$line &lt;&gt;</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">@lines &lt;&gt;</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>&lt;&gt;</tt> ("angle bracket") operator is sensitive to the context in which it is called. If it is used to assign to a scalar variable, a so-called scalar context, it reads a line of text from the indicated filehandle, returning the data along with its terminating end-of-line character. After reading the last line of the filehandle, <tt>&lt;&gt;</tt> will return <tt>undef</tt>, signaling the end-of-file (EOF) condition.</p>
<p class="docText" style="margin:0;">When <tt>&lt;&gt;</tt> is assigned to an array or used in another place where Perl ordinarily expects a list, it reads <span class="docEmphasis">all</span> lines from the filehandle through to EOF, returning them as one (potentially gigantic) list. This is called a list context.</p>
<p class="docText" style="margin:0;">If called in a "void context" (i.e., without being assigned to a variable),<tt>&lt;&gt;</tt> copies a line into the <tt>$_</tt> global variable. This is commonly seen in <tt>while()</tt> loops, and often combined with pattern matches and other operations that use <tt>$_</tt> implicitly:</p>
<pre>while (&lt;&gt;) {
   print "Found a gnu/n" if /GNU/i;
}
</pre>
<p class="docText" style="margin:0;">The <tt>&lt;FILEHANDLE&gt;</tt> form of this function explicitly gives the filehandle to read from. However, the <tt>&lt;&gt;</tt> form is "magical." If the script was called with a set of file names as command-line arguments, <tt>&lt;&gt;</tt> will attempt to <tt>open()</tt> each argument in turn and will then return lines from them as if they were concatenated into one large pseudofile.</p>
<p class="docText" style="margin:0;">If no files are given on the command line, or if a single file named "-" is given, then <tt>&lt;&gt;</tt> reads from standard input and is equivalent to <tt>&lt;STDIN&gt;</tt>. See the <span class="docEmphasis">perlfunc</span> POD documentation for an explanation of how this works (<tt>pod perlfunc</tt>, as explained in the Preface).</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = read (FILEHANDLE,$buffer,$length [,$offset])</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = sysread (FILEHANDLE,$buffer,$length [,$offset])</span></span></span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The <tt>read()</tt> and <tt>sysread()</tt> functions read data of arbitrary length from the indicated filehandle. Up to <tt>$length</tt> bytes of data will be read, and placed in the <tt>$buffer</tt> scalar variable. Both functions return the number of bytes actually read, numeric 0 on the end of file, or <tt>undef</tt> on an error.</p>
<p class="docText" style="margin:0;">This code fragment will attempt to read 50 bytes of data from <tt>STDIN</tt>, placing the information in <tt>$buffer</tt>, and assigning the number of bytes read to <tt>$bytes</tt>:</p>
<pre>my $buffer;
$bytes = read (STDIN,$buffer,50);
</pre>
<p class="docText" style="margin:0;">By default, the read data will be placed at the beginning of <tt>$buffer</tt>, overwriting whatever was already there. You can change this behavior by providing the optional numeric <tt>$offset</tt> argument, to specify that read data should be written into the variable starting at the specified position.</p>
<p class="docText" style="margin:0;">The main difference between <tt>read()</tt> and <tt>sysread()</tt> is that <tt>read()</tt> uses standard I/O buffering, and <tt>sysread()</tt> does not. This means that <tt>read()</tt> will not return until either it can fetch the exact number of bytes requested or it hits the end of file. The <tt>sysread()</tt> function, in contrast, can return partial reads. It is guaranteed to return at least 1 byte, but if it cannot immediately read the number of bytes requested from the filehandle, it will return what it can. This behavior is discussed in more detail later in the Buffering and Blocking section.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = print FILEHANDLE $data1,$data2,$data3...</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = print $data1,$data2,$data3...</span></span></span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The <tt>print()</tt> function prints a list of data items to a filehandle. In the first form, the filehandle is given explicitly. Notice that there is no comma between the filehandle name and the first data item. In the second form, <tt>print()</tt> uses the current default filehandle, usually <tt>STDOUT</tt>. The default filehandle can be changed using the one-argument form of <tt>select()</tt> (discussed below). If no data arguments are provided, then <tt>print()</tt> prints the contents of <tt>$_</tt>.</p>
<p class="docText" style="margin:0;">If output was successful, <tt>print()</tt> returns a true value. Otherwise it returns false and leaves an error message in the variable named <tt>$!</tt>.</p>
<p class="docText" style="margin:0;">Perl is a parentheses-optional language. Although I prefer using parentheses around function arguments, most Perl scripts drop them with <tt>print()</tt>, and this book follows that convention as well.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = printf $format,$data1,$data2,$data3...</span></span></span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The <tt>printf()</tt> function is a formatted print. The indicated data items are formatted and printed according to the <tt>$format</tt> format string. The formatting language is quite rich, and is explained in detail in Perl's POD documentation for the related <tt>sprintf()</tt> (string formatting) function.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = syswrite (FILEHANDLE,$data [,$length [,$offset]])</span></span></span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The <tt>syswrite()</tt> function is an alternative way to write to a filehandle that gives you more control over the process. Its arguments are a filehandle and a scalar value (avariable or string literal). It writes the data to the filehandle, and returns the number of bytes successfully written.</p>
<p class="docText" style="margin:0;">By default, <tt>syswrite()</tt> attempts to write the entire contents of <tt>$data</tt>, beginning at the start of the string. You can alter this behavior by providing an optional <tt>$length</tt> and <tt>$offset</tt>, in which case <tt>syswrite()</tt> will write <tt>$length</tt> bytes beginning at the position specified by <tt>$offset</tt>.</p>
<p class="docText" style="margin:0;">Aside from familiarity, the main difference between <tt>print()</tt> and <tt>syswrite()</tt> is that the former uses standard I/O buffering, while the latter does not. We discuss this later in the Buffering and Blocking section.</p>
<p class="docText" style="margin:0;">Don't confuse <tt>syswrite()</tt> with Perl's unfortunately named <tt>write()</tt> function. The latter is part of Perl's report formatting package, which we won't discuss further.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$previous = select(FILEHANDLE)</span></span></span></p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">The <tt>select()</tt> function changes the default output filehandle used by print <tt>print ()</tt>. It takes the name of the filehandle to set as the default, and returns the name of the previous default. There is also a version of <tt>select()</tt> that takes four arguments, which is used for I/O multiplexing. We introduce the four-argument version in <a class="docLink">Chapter 8</a>.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">When reading data as a byte stream with <tt>read()</tt> or <tt>sysread()</tt>, a common idiom is to pass <tt>length($buffer)</tt> as the offset into the buffer. This will make <tt>read()</tt> append the new data to  the end of data that was already in the buffer. For example:</p>
<pre>my $buffer;
while (1) {
  $bytes = read (STDIN,$buffer,50,length($buffer));
  last unless $bytes &gt; 0;
}</pre>
<p><span class="Apple-style-span" style="font-size:11px;font-weight:bold;"><a name="ch01lev2sec9"></a></span><br />
<h5 style="font-size:8pt;"><a name="1_1_3_Detecting_the_End_of_Fil" id="1_1_3_Detecting_the_End_of_Fil"></a>1.1.3 Detecting the End of File<br /></h5>
<p class="docText" style="margin:0;">The end-of-file condition occurs when there's no more data to be read from a file or device. When reading from files this happens at the literal end of the file, but the EOF condition applies as well when reading from other devices. When reading from the terminal (command-line window), for example, EOF occurs when the user presses a special key: control-D on UNIX, control-Z on Windows/DOS, and command-. on Macintosh. When reading from a network-attached socket, EOF occurs when the remote machine closes its end of the connection.</p>
<p class="docText" style="margin:0;">The EOF condition is signaled differently depending on whether you are reading from the filehandle one line at a time or as a byte stream. For byte-stream operations with <tt>read()</tt> or <tt>sysread()</tt>, EOF is indicated when the function returns numeric 0. Other I/O errors return <tt>undef</tt> and set <tt>$!</tt> to the appropriate error message. To distinguish between an error and a normal end of file, you can test the return value with <tt>defined():</tt></p>
<pre>while (1) {
  my $bytes = read(STDIN,$buffer,100);
  die "read error" unless defined ($bytes);
  last unless $bytes &gt; 0;
}
</pre>
<p class="docText" style="margin:0;">In contrast, the <tt>&lt;&gt;</tt> operator doesn't distinguish between EOF and abnormal conditions, and returns <tt>undef</tt> in either case. To distinguish them, you can set <tt>$!</tt> to <tt>undef</tt> before performing a series of reads, and check whether it is defined afterward:</p>
<pre>undef $!;
while (defined(my $line = &lt;STDIN&gt;)) {
   $data .= $line;
}
die "Abnormal read error: $!" if defined ($!);
</pre>
<p class="docText" style="margin:0;">When you are using <tt>&lt;&gt;</tt> inside the conditional of a <tt>while()</tt> loop, as shown in the most recent code fragment, you can dispense with the explicit <tt>defined()</tt> test. This makes the loop easier on the eyes:</p>
<pre>while (my $line = &lt;STDIN&gt;) {
   $data .= $line;
}
</pre>
<p class="docText" style="margin:0;">This will work even if the line consists of a single 0 or an empty string, which Perl would ordinarily treat as false. Outside <tt>while()</tt> loops, be careful to use <tt>defined()</tt> to test the returned value for EOF.</p>
<p class="docText" style="margin:0;">Finally, there is the <tt>eof()</tt> function, which explicitly tests a filehandle for the EOF condition:</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$eof = eof(FILEHANDLE)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>eof()</tt> function returns true if the next read on <tt>FILEHANDLE</tt> will return an EOF. Called without arguments or parentheses, as in <tt>eof</tt>, the function tests the last filehandle read from.</p>
<p class="docText" style="margin:0;">When using <tt>while(&lt;&gt;)</tt> to read from the command-line arguments as a single pseudofile, <tt>eof()</tt> has "magical"—or at least confusing—properties. Called with empty parentheses, as in <tt>eof()</tt>, the function returns true at the end of the very last file. Called without parentheses or arguments, as in <tt>eof</tt>, the function returns true at the end of each of the individual files on the command line. See the Perl POD documentation for examples of the circumstances in which this behavior is useful.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">In practice, you do not have to use <tt>eof()</tt> except in very special circumstances, and a reliance on it is often a signal that something is amiss in the structure of your program.</p>
<p><a name="ch01lev2sec10"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_4_Anarchy_at_the_End_of_th" id="1_1_4_Anarchy_at_the_End_of_th"></a>1.1.4 Anarchy at the End of the Line<br /></h5>
<p class="docText" style="margin:0;">When performing line-oriented I/O, you have to watch for different interpretations of the end-of-line character. No two operating system designers can seem to agree on how lines should end in text files. On UNIX systems, lines end with the linefeed character (LF, octal <tt>/012</tt> in the ASCII table); on Macintosh systems, they end with the carriage return character (CR, octal <tt>/015</tt>); and the Windows/DOS designers decided to end each line of text with two characters, a carriage return/linefeed pair (CRLF, or octal <tt>/015/012</tt>). Most line-oriented network servers also use CRLF to terminate lines.</p>
<p class="docText" style="margin:0;">This leads to endless confusion when moving text files between machines. Fortunately, Perl provides a way to examine and change the end-of-line character. The global variable <tt>$/</tt> contains the current character, or sequence of characters, used to signal the end of line. By default, it is set to <tt>/012</tt> on Unix systems, <tt>/015</tt> on Macintoshes, and <tt>/015/012</tt> on Windows and DOS systems.</p>
<p class="docText" style="margin:0;">The line-oriented <tt>&lt;&gt;</tt> input function will read from the specified handle until it encounters the end-of-line character(s) contained in <tt>$/</tt>, and return the line of text with the end-of-line sequence still attached. The <tt>chomp()</tt> function looks for the end-of-line sequence at the end of a text string and removes it, respecting the current value of <tt>$/</tt>.</p>
<p class="docText" style="margin:0;">The string escape <tt>/n</tt> is the <span class="docEmphasis">logical</span> newline character, and means different things on different platforms. For example, <tt>/n</tt> is equivalent to <tt>/012</tt> on UNIX systems, and to <tt>/015</tt> on Macintoshes. (On Windows systems, <tt>/n</tt> is usually <tt>/012</tt>, but see the later discussion of DOS text mode.) In a similar vein, <tt>/r</tt> is the logical carriage return character, which also varies from system to system.</p>
<p class="docText" style="margin:0;">When communicating with a line-oriented network server that uses CRLF to terminate lines, it won't be portable to set <tt>$/</tt> to <tt>/r/n</tt>. Use the explicit string <tt>/015/012</tt> instead. To make this less obscure, the Socket and IO::Socket modules, which we discuss in great detail later, have an option to export globals named <tt>$CRLF</tt> and <tt>CRLF()</tt> that return the correct values.</p>
<p class="docText" style="margin:0;">There is an additional complication when performing line-oriented I/O on Microsoft Windows and DOS machines. For historical reasons, Windows/DOS distinguishes between filehandles in "text mode" and those in "binary mode." In binary mode, what you see is exactly what you get. When you print to a binary filehandle, the data is output exactly as you specified. Similarly, read operations return the data exactly as it was stored in the file.</p>
<p class="docText" style="margin:0;">In text mode, however, the standard I/O library automatically translates LF into CRLF pairs on the way out, and CRLF pairs into LF on the way in. The virtue of this is that it makes text operations on Windows and UNIX Perls look the same—from the programmer's point of view, the DOS text files end in a single <tt>/n</tt> character, just as they do in UNIX. The problem one runs into is when reading or writing binary files—such as images or indexed databases—and the files become mysteriously corrupted on input or output. This is due to the default line-end translation. Should this happen to you, you should turn off character translation by calling <tt>binmode()</tt> on the filehandle.</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">binmode (FILEHANDLE [$discipline])</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>binmode()</tt> function turns on binary mode for a filehandle, disabling character translation. It should be called after the filehandle is opened, but before doing any I/O with it. The single-argument form turns on binary mode. The two-argument form, available only with Perl 5.6 or higher, allows you to turn binary mode on by providing <tt>:raw</tt> as the value of <tt>$discipline</tt>, or restore the default text mode using <tt>:crlf</tt> as the value.</p>
<p class="docText" style="margin:0;"><tt>binmode()</tt> only has an effect on systems like Windows and VMS, where the end-of-line sequence is more than one character. On UNIX and Macintosh systems, it has no effect.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">Another way to avoid confusion over text and binary mode is to use the <tt>sysread()</tt> and <tt>syswrite()</tt> functions, which bypass the character translation routines in the standard I/O library.</p>
<p class="docText" style="margin:0;">A whole bevy of special global variables control other aspects of line-oriented I/O, such as whether to append an end-of-line character automatically to data output with the <tt>print()</tt> statement, and whether multiple data values should be separated by a delimiter. See Appendix B for a brief summary.</p>
<p><a name="ch01lev2sec11"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_5_Opening_and_Closing_File" id="1_1_5_Opening_and_Closing_File"></a>1.1.5 Opening and Closing Files<br /></h5>
<p class="docText" style="margin:0;">In addition to the three standard filehandles, Perl allows you to open any number of additional filehandles. To open a file for reading or writing, use the built-in Perl function <tt>open()</tt> If successful, <tt>open()</tt> gives you a filehandle to use for the read and/or write operations themselves. Once you are finished with the filehandle, call <tt>close()</tt> to close it. This code fragment illustrates how to open the file <span class="docEmphasis">message.txt</span> for writing, write two lines of text to it, and close it:</p>
<pre>open (FH,"&gt;message.txt") or die "Can't open file: $!";
print FH "This is the first line./n";
print FH "And this is the second./n";
close (FH) or die "Can't close file: $!";
</pre>
<p class="docText" style="margin:0;">We call <tt>open()</tt> with two arguments: a filehandle name and the name of the file we wish to open. The filehandle name is any valid Perl identifier consisting of any combination of uppercase and lowercase letters, digits, and the underscore character. To make them distinct, most Perl programmers choose all uppercase letters for filehandles. The " <tt>&gt;</tt> " symbol in front of the filename tells Perl to overwrite the file's contents if it already exists, or to create the file if it doesn't. The file will then be opened for writing.</p>
<p class="docText" style="margin:0;">If <tt>open()</tt> succeeds, it returns a true value. Otherwise, it returns false, causing Perl to evaluate the expression to the right of the <tt>or</tt> operator. This expression simply dies with an error message, using Perl's <tt>$!</tt> global variable to retrieve the last system error message encountered.</p>
<p class="docText" style="margin:0;">We call <tt>print()</tt> twice to write some text to the filehandle. The first argument to <tt>print()</tt> is the filehandle, and the second and subsequent arguments are strings to write to the filehandle. Again, notice that there is no comma between the filehandle and the strings to print. Whatever is printed to a filehandle shows up in its corresponding file. If the filehandle argument to <tt>print()</tt> is omitted, it defaults to <tt>STDOUT</tt>.</p>
<p class="docText" style="margin:0;">After we have finished printing, we call <tt>close()</tt> to close the filehandle. <tt>close()</tt> returns a true value if the filehandle was closed uneventfully, or false if some untoward event, such as a disk filling up, occurred. We check this result code using the same type of <tt>or</tt> test we used earlier.</p>
<p class="docText" style="margin:0;">Let's look at <tt>open()</tt> and <tt>close()</tt> in more detail.</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$success = open(FILEHANDLE,$path)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$success = open(FILEHANDLE,$mode,$path)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>open()</tt> call opens the file given in <tt>$path</tt>, associating it with a designated <tt>FILEHANDLE</tt>. There are both two- and three-argument versions of <tt>open()</tt>. In the three-argument version, which is available in Perl versions 5.6 and higher, a <tt>$mode</tt> argument specifies how the file is to be opened. <tt>$mode</tt> is a one- or two-character string chosen to be reminiscent of the I/O redirection operators in the UNIX and DOS shells. Choices are shown here.</p>
<p style="margin:0;">
<table cellspacing="0" cellpadding="1" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Mode</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>&lt;</tt></td>
<td class="docTableCell" valign="top">Open file for reading</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>&gt;</tt></td>
<td class="docTableCell" valign="top">Truncate file to zero length and open for writing</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>&gt;&gt;</tt></td>
<td class="docTableCell" valign="top">Open file for appending, do not truncate</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>+&gt;</tt></td>
<td class="docTableCell" valign="top">Truncate file and then open for read/write</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>&lt;+</tt></td>
<td class="docTableCell" valign="top">Open file for read/write, do not truncate</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">We can open the file named <span class="docEmphasis">darkstar.txt</span> for reading and associate it with the filehandle <tt>DARKFH</tt> like this:</p>
<pre>open(DARKFH,'&lt;','darkstar.txt');
</pre>
<p class="docText" style="margin:0;">In the two-argument form of <tt>open()</tt>, the mode is appended directly to the filename, as in:</p>
<pre>open(DARKFH,'&lt;darkstar.txt');
</pre>
<p class="docText" style="margin:0;">For readability, you can put any amount of whitespace between the mode symbol and the filename; it will be ignored. If you leave out the mode symbol, the file will be opened for reading. Hence the above examples are all equivalent to this:</p>
<pre>open(DARKFH,'darkstar.txt');
</pre>
<p class="docText" style="margin:0;">If successful, <tt>open()</tt> will return a true value. Otherwise it returns false. In the latter case, the <tt>$!</tt> global will contain a human-readable message indicating thecause of the error.</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$success = close(FH);</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>close()</tt> function closes a previously opened file, returning true if successful, or false otherwise. In the case of an error, <span class="Apple-style-span" style="text-decoration:underline;">the error message can again be found in </span><tt><span class="Apple-style-span" style="text-decoration:underline;"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(255,0,0);">$!</span></span></span></tt><span class="Apple-style-span" style="text-decoration:underline;">.</span></p>
<p class="docText" style="margin:0;">When your program exits, any filehandles that are still open will be closed automatically.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">The three-argument form of <tt>open()</tt> is used only rarely. However, it has the virtue of not scanning the filename for special characters the way that the two-argument form does. This lets you open files whose names contain leading or trailing whitespace, "&gt;" characters, and other weird and arbitrary data. The filename "-" is special. When opened for reading, it tells Perl to open standard input. When opened for writing, it tells Perl to open standard output.</p>
<p class="docText" style="margin:0;">If you call <tt>open()</tt> on a filehandle that is already open, it will be automatically closed and then reopened on the file that you specify. Among other things, this call can be used to reopen one of the three standard filehandles on the file of your choice, changing the default source or destination of the <tt>&lt;&gt;</tt>, <tt>print()</tt>, and <tt>warn()</tt> functions. We will see an example of this shortly.</p>
<p class="docText" style="margin:0;">As with the <tt>print()</tt> function, many programmers drop the parentheses around <tt>open()</tt> and <tt>close()</tt>. For example, this is the most common idiom for opening a file:</p>
<pre>open DARKSTAR,"darkstar.txt" or die "Couldn't open darkstar.txt: $!"
</pre>
<p class="docText" style="margin:0;">I don't like this style much because it leads to visual ambiguity (does the <tt>or</tt> associate with the string "darkstar.txt" or with the <tt>open()</tt> function?). However, I do use this style with<tt>close()</tt>, <tt>print()</tt>, and <tt>return()</tt> because of their ubiquity.</p>
<p class="docText" style="margin:0;">The two-argument form of <tt>open()</tt> has a lot of magic associated with it (too much magic, some would say). The full list of magic behavior can be found in the <span class="docEmphasis">perlfunc</span> and <span class="docEmphasis">perlopentut</span> POD documentation. However, one trick is worth noting because we use it in later chapters. You can <span class="docEmphasis">duplicate</span> a filehandle by using it as the second argument to <tt>open()</tt> with the sequence <tt>&gt;&amp;</tt> or <tt>&lt;&amp;</tt> prepended to the beginning. <tt>&gt;&amp;</tt> duplicates filehandles used for writing, and <tt>&lt;&amp;</tt> duplicates those used for reading:</p>
<pre>open (OUTCOPY,"&gt;&amp;STDOUT");
open (INCOPY,"&lt;&amp;STDOUT");
</pre>
<p class="docText" style="margin:0;">This example creates a new filehandle named <tt>OUTCOPY</tt> that is attached to the same device as <tt>STDOUT</tt>. You can now write to <tt>OUTCOPY</tt> and it will have the same effect as writing to <tt>STDOUT</tt>. This is useful when you want to replace one or more of the three standard filehandles temporarily, and restore them later. For example, this code fragment will temporarily reopen <tt>STDOUT</tt> onto a file, invoke the system <span class="docEmphasis">date</span> command (using the <tt>system()</tt> function, which we discuss in more detail in <a class="docLink">Chapter 2</a>), and then restore the previous value of <tt>STDOUT</tt>. When <span class="docEmphasis">date</span> runs, its standard output is opened on the file, and its output appears there rather than in the command window:</p>
<pre>#!/usr/bin/perl
# file: redirect.pl

print "Redirecting STDOUT/n";
open (SAVEOUT,"&gt;&amp;STDOUT");
open (STDOUT,"&gt;test.txt") or die "Can't open test.txt: $!";

print "STDOUT is redirected/n";
system "date";

open (STDOUT,"&gt;&amp;SAVEOUT");
print "STDOUT restored/n";
</pre>
<p class="docText" style="margin:0;">When this script runs, its output looks like this:</p>
<pre>% redirect.pl
Redirecting STDOUT
STDOUT restored
</pre>
<p class="docText" style="margin:0;">and the file <span class="docEmphasis">test.txt</span> contains these lines:</p>
<pre>STDOUT is redirected
Thu Aug 10 09:19:24 EDT 2000
</pre>
<p class="docText" style="margin:0;">Notice how the second <tt>print()</tt> statement and the output of the <span class="docEmphasis">date</span> system command went to the file rather than to the screen because we had reopened <tt>STDOUT</tt> at that point. When we restored <tt>STDOUT</tt> from the copy saved in <tt>SAVEOUT</tt>, our ability to print to the terminal was restored.</p>
<p class="docText" style="margin:0;">Perl also provides an alternative API for opening files that avoids the magic and obscure syntax of <tt>open()</tt> altogether. The <tt>sysopen()</tt> function allows you to open files using the same syntax as the C library's <tt>open()</tt> function.</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = sysopen (FILEHANDLE,$filename,$mode [,$perms])</span></span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>sysopen()</tt> function opens the file indicated by <tt>$filename</tt>, using the I/O mode indicated by <tt>$mode</tt>. If the file doesn't exist, and <tt>$mode</tt> indicates that the file should be created, then the optional <tt>$perms</tt> value specifies the permission bits for the newly created file. We discuss I/O modes and permissions in more detail below.</p>
<p class="docText" style="margin:0;">If successful, <tt>sysopen()</tt> returns a true result and associates the opened file with <tt>FILEHANDLE</tt>. Otherwise it returns a false result and leaves the error message in <tt>$!</tt>.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">The <tt>$mode</tt> argument used in <tt>sysopen()</tt> is different from the mode used in ordinary <tt>open()</tt>. Instead of being a set of characters, it is a numeric bitmask formed by ORing together one or more constants using the bitwise <tt>OR</tt> operator " <tt>|</tt> ". For example, the following snippet opens up a file for writing using a mode that causes it to be created if it doesn't exist, and truncated to length zero if it does (equivalent to <tt>open()</tt>'s " <tt>&gt;</tt> " mode):</p>
<pre>sysopen(FH, "darkstar.txt",O_WRONLY|O_CREAT|O_TRUNC)
      or die "Can't open: $!"
</pre>
<p class="docText" style="margin:0;">The standard <tt>Fcntl</tt> module exports the constants recognized by <tt>sysopen()</tt>, all of which begin with the prefix <tt>O_</tt>. Just use <tt>Fcntl</tt> at the top of your script togain access to them.</p>
<p class="docText" style="margin:0;">The mode constants useful for <tt>sysopen()</tt> are listed in <a class="docLink">Table 1.1</a>. Each call to <tt>sysopen()</tt> must have one (and only one) of <tt>O_RDONLY</tt>, <tt>O_WRONLY</tt>, and <tt>O_RDWR</tt>. The <tt>O_WRONLY</tt> and <tt>O_RDWR</tt> constants may be ORed with one or more of <tt>O_CREAT</tt>, <tt>O_EXCL</tt>, <tt>O_TRUNC</tt>, or <tt>O_APPEND</tt>.</p>
<p class="docText" style="margin:0;"><tt>O_CREAT</tt> causes the file to be created if it doesn't already exist. If it isn't specified, and the file doesn't exist when you try to open it for writing, then <tt>sysopen()</tt> will fail.</p>
<p class="docText" style="margin:0;">Combining <tt>O_CREAT</tt> with <tt>O_EXCL</tt> leads to the useful behavior of creating the file if it doesn't already exist, but failing if it does. This can be used to avoid accidentally clobbering an existing file.</p>
<p class="docText" style="margin:0;">If <tt>O_TRUNC</tt> is specified, then the file is truncated to zero length before the first write, effectively overwriting the previous contents. <tt>O_APPEND</tt> has the opposite effect, positioning the write pointer to the end of the file so that everything written to the file is appended to its existing contents.</p>
<p><a name="ch01table01"></a>
<p style="margin:0;"></p>
<p>
<div style="text-align:center;margin-top:0;margin-bottom:0;">Table 1.1. sysopen() Mode Constants</div>
<table cellspacing="0" cellpadding="1" width="100%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<th class="docTableHeader" valign="top"><span class="docEmphasis">Constant</span></th>
<th class="docTableHeader" valign="top"><span class="docEmphasis">Description</span></th>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_RDONLY</tt></td>
<td class="docTableCell" valign="top">Open read only.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_WRONLY</tt></td>
<td class="docTableCell" valign="top">Open write only.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_RDWR</tt></td>
<td class="docTableCell" valign="top">Open read/write.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_CREAT</tt></td>
<td class="docTableCell" valign="top">Create file if it doesn't exist.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_EXCL</tt></td>
<td class="docTableCell" valign="top">When combined with <tt>O_CREAT</tt>, create file if it doesn't exist and fail if it does.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_TRUNC</tt></td>
<td class="docTableCell" valign="top">If file already exists, truncate it to zero.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_APPEND</tt></td>
<td class="docTableCell" valign="top">Open file in append mode (equivalent to <tt>open()</tt>'s " <tt>&gt;&gt;</tt> ").</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_NOCTTY</tt></td>
<td class="docTableCell" valign="top">If the file is a terminal device, open it without allowing it to become the process's controlling terminal.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_NONBLOCK</tt></td>
<td class="docTableCell" valign="top">Open file in nonblockingmode.</td>
</tr>
<tr style="text-align:left;">
<td class="docTableCell" valign="top"><tt>O_SYNC</tt></td>
<td class="docTableCell" valign="top">Open file for synchronous mode, so that all writes block until the data is physically written.</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;">The <tt>O_NOCTTY</tt>, <tt>O_NONBLOCK</tt>, and <tt>O_SYNC</tt> modes all have specialized uses that are discussed in later chapters.</p>
<p class="docText" style="margin:0;">If <tt>sysopen()</tt> needs to create a file, the <tt>$perm</tt> argument specifies the permissions mode of the resulting file. File permissions is a UNIX concept that maps imperfectly onto the Windows/DOS world, and not at all onto the Macintosh world. It is an octal value, such as <tt>0644</tt> (which happens to specify read/write permissions for the owner of the file, and read-only permissions for others).</p>
<p class="docText" style="margin:0;">If <tt>$perm</tt> is not provided, <tt>sysopen()</tt> defaults to <tt>0666</tt>, which grants read/write access to everyone. However, whether you specify the permissions or accept the default, the actual permissions of the created file are determined by performing the bitwise AND between the <tt>$perm</tt> argument and the current contents of the user's <span class="docEmphasis">umask</span> (another UNIX concept). This is often set, at the user's discretion, to forbid access to the file from outside the user's account or group.</p>
<p class="docText" style="margin:0;">In most circumstances, it is best to omit the permissions argument and let the user adjust the <span class="docEmphasis">umask</span>. This also increases the portability of the program. See the <tt>umask()</tt> entry in the <span class="docEmphasis">perlfunc</span> POD documentation for information on how you can examine and set the umask programatically.</p>
<p><a name="ch01lev2sec12"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_6_Buffering_and_Blocking_" id="1_1_6_Buffering_and_Blocking_"></a>1.1.6 Buffering and Blocking<br /></h5>
<p class="docText" style="margin:0;">When you <tt>print()</tt> or <tt>syswrite()</tt> to a filehandle, the actual output operation does not occur immediately. If you are writing to a file, the system has to wait for the write head to reach the proper location on the disk drive, and for the spinning platter to bring the proper location under the head. This is usually an insignificant length of time (although it may be quite noticeable on a laptop that intermittently spins down its disk to save battery power), but other output operations can take much more time. In particular, network operations may take a considerable length of time to complete. The same applies to input.</p>
<p class="docText" style="margin:0;">There is a fundamental mismatch between computational speed and I/O speed. A program can execute the contents of a tight loop a million times a second, but a single I/O operation may take several seconds to complete. To overcome this mismatch, modern operating systems use the techniques of buffering and blocking.</p>
<p class="docText" style="margin:0;">The idea behind buffering is shown in <a class="docLink">Figure 1.3</a>. Buffers decouple the I/O calls invoked by the program from the actual I/O operations that occur at the hardware level. A call to <tt>print()</tt>, for example, doesn't send data directly to the terminal, network card, or disk drive, but instead it results in data being written to a memory area. This occurs quickly, because writes to memory are fast. Meanwhile, in an asynchronous fashion, the operating system reads from data previously written to the buffer and performs the actions necessary to write the information to the hardware device.</p>
<p>Figure 1.3. Buffers help solve the mismatch between computation speed and I/O speed
<p class="docText" style="margin:0;"></p>
<div id="r:n9" style="text-align:center;margin-top:0;margin-bottom:0;padding:1em 0;"><a target="_blank" href="http://docs.google.com/File?id=dd6nw3mt_211c67qrqfz_b"><img src="http://docs.google.com/File?id=dd6nw3mt_211c67qrqfz_b" style="width:500px;height:512px;border-style:initial;border-color:initial;border-width:0;" /></a></div>
<p style="margin:0;">
<p class="docText" style="margin:0;">Similarly, for input operations, the operating system receives data from active input devices (the keyboard, disk drive, network card) and writes that data to an input buffer somewhere in memory. The data remains in the input buffer until your program calls <tt>&lt;&gt;</tt> or <tt>read()</tt>, at which point the data is copied from the operating system's buffer into the memory space corresponding to a variable in your program.</p>
<p class="docText" style="margin:0;">The advantage of buffering is significant, particularly if your program performs I/O in a "bursty" way; that is, it performs numerous reads and writes of unpredictable size and timing. Instead of waiting for each operation to complete at the hardware level, the data is safely buffered in the operating system and "flushed"—passed on to the output device—whenever the downstream hardware can accept it.</p>
<p class="docText" style="margin:0;">The buffers in <a class="docLink">Figure 1.3</a> are conceptually circular FIFO (first in first out) data structures. When data is written beyond the end of the buffer memory area, the operating system merely begins writing new data at the beginning. The operating system maintains two pointers in each of its I/O buffers. The write pointer is the place where new data enters the buffer. The read pointer is the position from which stored data is moved out of the buffer to its next destination. For example, on write operations, each <tt>print()</tt> you perform adds some data to the output buffer and advances the write pointer forward. The operating system reads older data starting at the read pointer and copies it to the low-level hardware device.</p>
<p class="docText" style="margin:0;">The size of the I/O buffer minus the distance between the write pointer and the read pointer is the amount of free space remaining. If your program is writing faster than the output hardware can receive it, then the buffer will eventually fill up and the buffer's free space will be zero. What happens then?</p>
<p class="docText" style="margin:0;">Because there is no room for new data in the buffer, the output operation cannot succeed immediately. As a result, the write operation blocks. Your program will be suspended at the blocked <tt>print()</tt> or <tt>syswrite()</tt> for an indefinite period of time. When the backlog in the output buffer clears and there is again room to receive new data, the output operation will unblock and <tt>print()</tt> or <tt>syswrite()</tt> will return.</p>
<p class="docText" style="margin:0;">In a similar fashion, reads will block when the input buffer is empty; that is, it blocks when the amount of free space is equal to the size of the buffer. In this case, calls to <tt>read()</tt> or <tt>sysread()</tt> will block until some new data has entered the buffer and there is something to be read.</p>
<p class="docText" style="margin:0;">Blocking is often the behavior you want, but sometimes you need more control over I/O. There are several techniques to manage blocking. One technique, discussed in <a class="docLink">Chapter 2</a> under Timing Out System Calls, uses signals to abort an I/O operation prematurely if it takes too long. Another technique, discussed in <a class="docLink">Chapter 12</a>, uses the four-argument <tt>select()</tt> system call to test a filehandle for its readiness to perform I/O before actually making the read or write call. A third technique, discussed in <a class="docLink">Chapter 13</a>, is to mark the filehandle as nonblocking, which causes the read or write operation to return immediately with an error code if the operation would block.</p>
<p><a name="ch01lev2sec13"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_7_Standard_I_O_Buffering_" id="1_1_7_Standard_I_O_Buffering_"></a>1.1.7 Standard I/O Buffering<br /></h5>
<p class="docText" style="margin:0;">Although we have spoken of a single buffer for I/O operations on a filehandle, there may in fact be several buffers at different layers of the operating system. For example, when writing to a disk file, there is a very low-level buffer on the disk hardware itself, another one in the SCSI or IDE driver that controls the disk, a third in the driver for the filesystem, and a fourth in the standard C library used by Perl. I may have missed a few.</p>
<p class="docText" style="margin:0;">You cannot control or even access most of these buffers directly, but there is one class of buffer that you should be aware of. Many of Perl's I/O operations flow through "stdio," a standard C-language library which maintains its own I/O buffers independent of the operating system's.<sup class="docFootnote"><a class="docLink">[1]</a></sup></p>
<blockquote style="border-color:rgb(221,221,221);border-style:dashed;border-width:1px;padding:10px;"><p class="docFootnote" style="margin:0;"><sup><a name="ch01fn01">[1]</a></sup> You can think of the stdio library as a layersitting on top of the OS, making the OS look more C-like to programs; similarly, a Pascal standard I/O library makes the OS look as if it were written in Pascal.</p>
</blockquote>
<p class="docText" style="margin:0;">Perl's <tt>&lt;&gt;</tt> operator, <tt>read()</tt>, and <tt>print()</tt> all use stdio. When you call <tt>print()</tt>, the data is transferred to an output buffer in the stdio layer before being sent to the operating system itself. Likewise, <tt>&lt;&gt;</tt> and <tt>read()</tt> both read data from an stdio buffer rather than directly from the OS. Each filehandle has its own set of buffers for input and output. For efficiency reasons, stdio waits until its output buffers reach a certain size before flushing their contents to the OS.</p>
<p class="docText" style="margin:0;">Normally, the presence of the stdio buffering is not a problem, but it can run you into trouble when doing more sophisticated types of I/O such as network operations. Consider the common case of an application that requires you to write a small amount of data to a remote server, wait for a response, and then send more data. You may think that the data has been sent across the network, but in fact it may not have been. The output data may still be sitting in its local stdio buffer, waiting for more data to come before flushing the buffer. The remote server will never receive the data, and so will never return a response. Your program will never receive a response and so will never send additional data. Deadlock ensues.</p>
<p class="docText" style="margin:0;">In contrast, the lower-level buffering performed by the operating system doesn't have this property. The OS will always attempt to deliver whatever data is in its output buffers as soon as the hardware can accept it.</p>
<p class="docText" style="margin:0;">There are two ways to work around stdio buffering. One is to turn on "autoflush" mode for the filehandle. Autoflush mode applies only to output operations. When active, Perl tells stdio to flush the filehandle's buffer every time <tt>print()</tt> is called.</p>
<p class="docText" style="margin:0;">To turn on autoflush mode, set the special variable <tt>$|</tt> to a true value. Autoflush mode affects the currently selected filehandle, so to change autoflush mode for a specific filehandle, one must first <tt>select()</tt> it, set <tt>$|</tt> to true, and then <tt>select()</tt> the previously selected filehandle. For example, to turn on autoflush mode for filehandle <tt>FH</tt>:</p>
<pre>my $previous = select(FH);
$| = 1;
select($previous);
</pre>
<p class="docText" style="margin:0;">You will sometimes see this motif abbreviated using the following mind-blowing idiom:</p>
<pre>select((select(FH),$|=1)[0]);
</pre>
<p class="docText" style="margin:0;">However, it is much cleaner to bring in the <tt>IO::Handle</tt> module, which adds an <tt>autoflush()</tt> method to filehandles. With <tt>IO::Handle</tt> loaded, <tt>FH</tt> can be put into autoflush mode like this:</p>
<pre>use IO::Handle;
FH-&gt;autoflush(1);
</pre>
<p class="docText" style="margin:0;">If the OO syntax confuses you, see the Objects and References section later in this chapter.</p>
<p class="docText" style="margin:0;">The other way to avoid stdio buffering problems is to use the <tt>sysread()i</tt> and <tt>syswrite()</tt> calls. These calls bypass the stdio library and go directly to the operating system I/O calls. An important advantage of these calls is that they interoperate well with other low-level I/O calls, such as the four-argument <tt>select()</tt> call, and with advanced techniques such as nonblocking I/O.</p>
<p class="docText" style="margin:0;">Another ramification of the fact that the <tt>sys*()</tt> functions bypass stdio is the difference in behavior between <tt>read()</tt> and <tt>sysread()</tt> when asked to fetch a larger chunk of data than is available. In the case of <tt>read()</tt>, the function will block indefinitely until it can fetch exactly the amount of data requested. The only exception to this is when the filehandle encounters the end of file before the full request has been satisfied, in which case <tt>read()</tt> will return everything to the end of the file. In contrast, <tt>sysread()</tt> can and will return partial reads. If it can't immediately read the full amount of data requested, it will return the data that is available. If no data is available, <tt>sysread()</tt> will block until it can return at least 1 byte. This behavior makes <tt>sysread()</tt> invaluable for use in network communications, where data frequently arrives in chunks of unpredictable size.</p>
<p class="docText" style="margin:0;">For these reasons, <tt>sysread()</tt> and <tt>syswrite()</tt> are preferred for many network applications.</p>
<p><a name="ch01lev2sec14"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_8_Passing_and_Storing_File" id="1_1_8_Passing_and_Storing_File"></a>1.1.8 Passing and Storing Filehandles<br /></h5>
<p class="docText" style="margin:0;">Network applications frequently must open multiple filehandles simultaneously, pass them to subroutines, and keep track of them in hashes and other data structures. Perl allows you to treat filehandles as strings, store them into variables, and pass them around to subroutines. For example, this functional but flawed code fragment stores the <tt>MY_FH</tt> filehandle into a variable named <tt>$fh</tt>, and then passes it to a subroutine named <tt>hello()</tt> to use in printing a friendly message:</p>
<pre># Flawed technique
$fh = MY_FH;
hello($fh);
sub hello {
  my $handle = shift;
  print $handle "Howdy folks!/n";
}
</pre>
<p class="docText" style="margin:0;">This technique often works; however, it will run you into problems as soon asyou try to pass filehandles to subroutines in other packages, such as functions exported by modules. The reason is that passing filehandles as strings loses the filehandle package information. If we pass the filehandle <tt>MY_FH</tt> from the main script (package <tt>main</tt>) to a subroutine defined in the <tt>MyUtils</tt> module, the subroutine will try to access a filehandle named <tt>MyUtils::MY_FH</tt> rather than the true filehandle, which is <tt>main::MY_FH</tt>. The same problem also occurs, of course, when a subroutine from one package tries to return a filehandle to a caller from another package.</p>
<p class="docText" style="margin:0;">The correct way to move filehandles around is as a <span class="docEmphasis">typeglob</span> or a <span class="docEmphasis">typeglob reference.</span> Typeglobs are symbol table entries, but you don't need to know much more about them than that in order to use them (see the <span class="docEmphasis">perlref</span> POD documentation for the full details). To turn a filehandle into a glob put an asterisk ("*") in front of its name:</p>
<pre>$fh = *MY_FH;
</pre>
<p class="docText" style="margin:0;">To turn a filehandle into a typeglob reference, put "/*" in front of its name:</p>
<pre>$fh = /*MY_FH;
</pre>
<p class="docText" style="margin:0;">In either case, <tt>$fh</tt> can now be used to pass the filehandle back and forth between subroutines and to store filehandles in data structures. Of the two forms, the glob reference (<tt>/*HANDLE</tt>) is the safer, because there's less risk of accidentally writing to the variable and altering the symbol table. This is the form we use throughout this book, and the one used by Perl's I/O-related modules, such as IO::Socket.</p>
<p class="docText" style="margin:0;">Typeglob references can be passed directly to subroutines:</p>
<pre>hello(/*MY_FH):
</pre>
<p class="docText" style="margin:0;">They can also be returned directly by subroutines:</p>
<pre>my $fh = get_fh();
sub get_fh {
   open (FOO,"foo.txt") or die "foo: $!";
   return /*FOO;
}
</pre>
<p class="docText" style="margin:0;">Typeglob refs can be used anywhere a bare filehandle is accepted, including as the first argument to <tt>print()</tt>, <tt>read()</tt>, <tt>sysread()</tt>, <tt>syswrite()</tt>, or any of the socket-related calls that we discuss in later chapters.</p>
<p class="docText" style="margin:0;">Sometimes you will need to examine a scalar variable to determine whether it contains a valid filehandle. The <tt>fileno()</tt> function makes this possible:</p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$integer = fileno (FILEHANDLE)</span></span></p>
<p class="docText" style="margin:0;"><span class="Apple-style-span" style="color:rgb(0,0,255);font-weight:bold;"><br /></span></p>
<p class="docText" style="margin:0;">The <tt>fileno()</tt> function accepts a filehandle in the form of a bare string, a typeglob, or a typeglob reference. If the filehandle is valid, <tt>fileno()</tt> returns the <span class="docEmphasis">file descriptor</span> for the filehandle. This is a small integer that uniquely identifies the filehandle to the operating system. <tt>STDIN</tt>, <tt>STDOUT</tt>, and <tt>STDERR</tt> generally correspond to descriptors 0, 1, and 2, respectively (but this can change if you close and reopen them). Other filehandles have descriptors greater than 3.</p>
<p class="docText" style="margin:0;">If the argument passed to <tt>fileno()</tt> does not correspond to a valid filehandle (including former filehandles that have been closed), <tt>fileno()</tt> returns <tt>undef</tt>. Here is the idiom for checking whether a scalar variable contains a filehandle:</p>
<pre>die "not a filehandle" unless defined fileno($fh);
</pre>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p><a name="ch01lev2sec15"></a><br />
<h5 style="font-size:8pt;"><a name="1_1_9_Detecting_Errors_" id="1_1_9_Detecting_Errors_"></a>1.1.9 Detecting Errors<br /></h5>
<p class="docText" style="margin:0;">Because of the vicissitudes of Internet communications, I/O errors are common in network applications. As a rule, each of the Perl functions that performs I/O returns <tt>undef</tt>, a false value, on failure. More specific information can be found by examining the special global variable <tt>$!</tt>.</p>
<p class="docText" style="margin:0;"><tt>$!</tt> has an interesting dual nature. Treated as a string, it will return a human-readable error message such as <tt>Permission denied</tt>. Treated as a number, however, it will return the numeric constant for the error, as defined by the operating system (e.g., <tt>EACCES</tt>). It is generally more reliable to use these numeric error constants to distinguish particular errors, because they are standardized across operating systems.</p>
<p class="docText" style="margin:0;">You can obtain the values of specific error message constants by importing them from the <tt>Errno</tt> module. In the <tt>use</tt> statement, you can import individual constants by name, or all of them at once. To bring in individual constants, list them in the <tt>use()</tt> statement, as shown here:</p>
<pre>use Errno qw(EACCES ENOENT);
my $result = open (FH,"&gt;/etc/passwd");
if (!$result) { # oops, something went wrong
   if ($! == EACCESS) {
      warn "You do not have permission to open this file.";
   } elsif ($! == ENOENT) {
      warn "File or directory not found.";
   } else {
      warn "Some other error occurred: $!";
   }
}
</pre>
<p class="docText" style="margin:0;">The <tt>qw()</tt> operator is used to split a text string into a list of words. The first line above is equivalent to:</p>
<pre>use Errno ('EACCESS','ENOENT');
</pre>
<p class="docText" style="margin:0;">and brings in the <tt>EACCESS</tt> and <tt>ENOENT</tt> constants. Notice that we use the numeric comparison operator " <tt>==</tt> " when comparing <tt>$!</tt> to numeric constants.</p>
<p class="docText" style="margin:0;">To bring in all the common error constants, import the tag <tt>:POSIX</tt>. Thisbrings in the error constants that are defined by the POSIX standard, across-platform API that UNIX, Windows NT/2000, and many other operating systems are largely compliant with. For example:</p>
<pre>use Errno qw(:POSIX);
</pre>
<p class="docText" style="margin:0;">Do not get into the habit of testing <tt>$!</tt> to see if an error occurred during the last operation. <tt>$!</tt> is set when an operation fails, but is not unset when an operation succeeds. The value of <tt>$!</tt> should be relied on only immediately after a function has indicated failure.</p>
<p style="margin:0;">
<h4 style="font-size:10pt;"><a name="1_2_" id="1_2_"></a>1.2 Using Object-Oriented Syntax with the IO::Handle and IO::File Modules<br /></h4>
<p style="margin:0;">
<h5 style="font-size:8pt;">1.2.1 Objects and References<br /></h5>
<p class="docText" style="margin:0;">In Perl, references are pointers to data structures. You can create a reference to an existing data structure using the backslash operator. For example:</p>
<pre>$a = 'hi there';
$a_ref = /$a; # reference to a scalar
@b = ('this','is','an','array');
$b_ref = /@b; # reference to an array
%c = ( first_name =&gt; 'Fred', last_name =&gt; 'Jones');
$c_ref = /%c; # reference to a hash
</pre>
<p class="docText" style="margin:0;">Once a reference has been created, you can make copies of it, as you would any regular scalar, or stuff it into arrays or hashes. When you want to get to the data contained inside a reference, you dereference it using the prefix appropriate for its contents:</p>
<pre>$a = $$a_ref;
@b = @$b_ref;
%c = %$c_ref;
</pre>
<p class="docText" style="margin:0;">You can index into array and hash references without dereferencing the whole thing by using the <tt>-&gt;</tt> syntax:</p>
<pre>$b_ref-&gt;[2];          # yields "an"
$c_ref-&gt;{last_name};  # yields "Jones"
</pre>
<p class="docText" style="margin:0;">It is also possible to create references to anonymous, unnamed arrays and hashes, using the following syntax:</p>
<pre>$anonymous_array = ['this','is','an','anonymous','array'];
$anonymous_hash  = { first_name =&gt;'Jane', last_name =&gt; 'Doe' };
</pre>
<p class="docText" style="margin:0;">If you try to print out a reference, you'll get a string like <tt>HASH(0x82ab0e0)</tt>, which indicates the type of reference and the memory location where it can be found (which is just short of useless).</p>
<p class="docText" style="margin:0;">An <span class="docEmphasis">object</span> is a reference with just a little bit extra. It is "blessed" into a particular module's package in such a way that it carries information about what module created it.<sup class="docFootnote"><a class="docLink">[2]</a></sup> The blessed reference will continue to work just like other references. For example, if the object named <tt>$object</tt> is a blessed hash reference, you can index into it like this:</p>
<blockquote style="border-color:rgb(221,221,221);border-style:dashed;border-width:1px;padding:10px;"><p class="docFootnote" style="margin:0;"><sup><a name="ch01fn02">[2]</a></sup> The function responsible for turning ordinary references into blessed ones is, naturally enough, called <span class="docEmphStrong">bless()</span>.</p>
</blockquote>
<pre>$object-&gt;{last_name};
</pre>
<p class="docText" style="margin:0;">What makes objects different from plain references is that they have <span class="docEmphasis">methods</span>. A method call uses the <tt>-&gt;</tt> notation, but followed by a subroutine name and optional subroutine-style arguments:</p>
<pre>$object-&gt;print_record(); # invoke the print_record() method
</pre>
<p class="docText" style="margin:0;">You may sometimes see a method called with arguments, like this:</p>
<pre>$object-&gt;print_record(encoding =&gt; 'EBCDIC');
</pre>
<p class="docText" style="margin:0;">The "=&gt;" symbol is accepted by Perl as a synonym for ','. It makes the relationship between the two arguments more distinct, and has the added virtue of automatically quoting the argument on the left. This allows us to write encoding rather than <span class="docEmphasis">"encoding"</span>. If a method takes no arguments, it's often written with the parentheses omitted, as in:</p>
<pre>$object-&gt;print_record;
</pre>
<p class="docText" style="margin:0;">In many cases, <tt>print_record()</tt> will be a subroutine defined in the object's package. Assuming that the object was created by a module named BigDatabase, the above is just a fancy way of saying this:</p>
<pre>BigDatabase::print_record($object);
</pre>
<p class="docText" style="margin:0;">However, Perl is more subtle than this, and the <tt>print_record()</tt>, method definition might actually reside in another module, which the current module <span class="docEmphasis">inherits</span> from. How this works is beyond the scope of this introduction, and can be found in the <span class="docEmphasis">perltoot</span>, <span class="docEmphasis">perlobj</span>, and <span class="docEmphasis">perlref</span> POD pages, as well as in [Wall 2000] and the other general Perl reference works listed in Appendix D.</p>
<p class="docText" style="margin:0;">To create an object, you must invoke one of its <span class="docEmphasis">constructors</span>. A constructor is a method call that is invoked from the module's name. For example, to create a new BigDatabase object:</p>
<pre>$object = BigDatabase-&gt;new(); # call the new() constructor
</pre>
<p class="docText" style="margin:0;">Constructors, which are a special case of a <span class="docEmphasis">class method,</span> are frequently named <tt>new()</tt>. However, any subroutine name is possible. Again, this syntax is part trickery. In most cases an equivalent call would be:</p>
<pre>$object = BigDatabase::new('BigDatabase');
</pre>
<p class="docText" style="margin:0;">This is not quite the same thing, however, because class methods can also be inherited.</p>
<p><a name="ch01lev2sec17"></a><br />
<h5 style="font-size:8pt;">1.2.2 The IO::Handle and IO::File Modules<br /></h5>
<p class="docText" style="margin:0;">The IO::Handle and IO::File modules, standard components of Perl, together provide object-oriented interface to filehandles. IO::Handle provides generic methods that are shared by all filehandle objects, including pipes and sockets. The more specialized class, IO::File, adds functionality for opening and manipulating files. Together, these classes smooth out some of the bumps and irregularities in Perl's built-in filehandles, and make larger programs easier to understand and maintain.</p>
<p class="docText" style="margin:0;">IO::File's elegance does not by itself provide any very compelling reason to choose the object-oriented syntax over native filehandles. Its main significance is that IO::Socket, IO::Pipe, and other I/O-related modules also inherit their behavior from IO::Handle. This means that programs that read and write from local files and those that read and write to remote network servers share a common, easy-to-use interface.</p>
<p class="docText" style="margin:0;">We'll get a feel for the module by looking at a tiny example of a program that opens a file, counts the number of lines, and reports its findings (<a class="docLink">Figure 1.4</a>).</p>
<p>Figure 1.4. The count_lines.pl program
<p class="docText" style="margin:0;"></p>
<div id="rld9" style="text-align:center;margin-top:0;margin-bottom:0;padding:1em 0;"><img src="http://docs.google.com/File?id=dd6nw3mt_212gxq8wfdw_b" style="width:500px;height:215px;" /></div></p>
<blockquote style="border-color:rgb(221,221,221);border-style:dashed;border-width:1px;padding:10px;"><p style="margin:0;"></p>
<p class="docText" style="margin:0;"><b>Lines 1–3: Load modules</b> We turn on strict syntax checking, and load the IO::File module.</p>
<p style="margin:0;">
<p style="margin:0;">
<p class="docText" style="margin:0;"><b>Lines 4–5: Initialize variables</b> We recover from the command line the name of the file to perform the line count on, and initialize the <tt>$counter</tt> variable to zero.</p>
<p style="margin:0;">
<p style="margin:0;">
<p class="docText" style="margin:0;"><b>Line 6: Create a new IO::File object</b> We call the <tt>IO::File::new()</tt> method, using the syntax <tt>IO::File-&gt;new()</tt>. The argument is the name of the file to open. If successful, <tt>new()</tt> returns a new IO::File object that we can use for I/O. Otherwise it returns <tt>undef</tt>, and we die with an error message.</p>
<p style="margin:0;">
<p style="margin:0;">
<p class="docText" style="margin:0;"><b>Lines 7–9: Main loop</b> We call the IO::File object's <tt>getline()</tt> method in the test portion of a <tt>while()</tt> loop. This method returns the next line of text, or <tt>undef</tt> on end of file—just like <tt>&lt;&gt;</tt>.</p>
<p class="docList" style="margin:0;">Each time through the loop we bump up <tt>$counter</tt>. The loop continues until <tt>getline()</tt> returns <tt>undef.</tt></p>
<p style="margin:0;">
<p style="margin:0;">
<p class="docText" style="margin:0;"><b>Line 10: Print results</b> We print out our results by calling <tt>STDOUT-&gt;print()</tt>. We'll discuss why this surprising syntax works in a moment.</p>
<p style="margin:0;">
</blockquote>
<p class="docText" style="margin:0;">When I ran <span class="docEmphasis">count_lines.pl</span> on the unfinished manuscript for this chapter, I got the following result:</p>
<pre>% <span class="docEmphStrong">count_lines.pl ch1.pod</span>
Counted 2428 lines
</pre>
<p class="docText" style="margin:0;">IO::File objects are actually blessed typeglob references (see the Passing and Storing Filehandles section earlier in this chapter). This means that you can use them in an object-oriented fashion, as in:</p>
<pre>$fh-&gt;print("Function calls are for the birds./n");
</pre>
<p class="docText" style="margin:0;">or with the familiar built-in function calls:</p>
<pre>print $fh "Object methods are too effete./n";
</pre>
<p class="docText" style="margin:0;">Many of IO::File's methods are simple wrappers around Perl's built-in functions. In addition to <tt>print()</tt> and <tt>getline()</tt> methods, there are <tt>read()</tt>, <tt>syswrite()</tt>, and <tt>close()</tt> methods, among others. We discuss the pros and cons of using object-oriented method calls and function calls in <a class="docLink">Chapter 5</a>, where we introduce IO:: Socket.</p>
<p class="docText" style="margin:0;">When you load IO::File (technically, when IO::File loads IO::Handle, which it inherits from), it adds methods to ordinary filehandles. This means that any of the methods in IO::File can also be used with <tt>STDIN</tt>, <tt>STDOUT</tt>, <tt>STDERR</tt>, or even with any conventional filehandles that you happen to create. This is why line 10 of <a class="docLink">Figure 1.4</a> allows us to print to standard output by calling <tt>print()</tt>.</p>
<p class="docText" style="margin:0;">Of the method listings that follow, only the <tt>new()</tt> and <tt>new_tmpfile()</tt> methods are actually defined by IO::File. The rest are inherited from IO::Handle and can be used with other descendents of IO::Handle, such as IO::Socket. This list is not complete. I've omitted some of the more obscure methods, including those that allow you to move around inside a file in a record-oriented fashion, because we won't need them for network communications.</p>
<p class="docText" style="margin:0;"></p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$fh = IO::File-&gt;new($filename [,$mode [,$perms]])</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>new()</tt> method is the main constructor for IO::File. It is a unified replacement for both <tt>open()</tt> and <tt>sysopen()</tt>. Called with a single argument, <tt>new()</tt> acts like the two-argument form of <tt>open()</tt>, taking a filename optionally preceded by a mode string. For example, this will open the indicated file for appending:</p>
<pre>$fh = IO::File-&gt;new("&gt;darkstar.txt");
</pre>
<p class="docText" style="margin:0;">If called with two or three arguments, IO::File treats the second argument as the open mode, and the third argument as the file creation permissions. <tt>$mode</tt> may be a Perl-style mode string, such as " <tt>+&lt;</tt> ", or an octal numeric mode, such as those used by <tt>sysopen()</tt>. As a convenience, IO::File automatically imports the <tt>Fcntl O_*</tt> constants when it loads. In addition, <tt>open()</tt> allows for an alternative type of symbolic mode string that is used in the C <tt>fopen()</tt> call; for example, it allows " <tt>w</tt> " to open the file for writing. We won't discuss those modes further here, because they do not add functionality.</p>
<p class="docText" style="margin:0;">The permission agreement given by <tt>$perms</tt> is an octal number, and has the same significance as the corresponding parameter passed to <tt>sysopen()</tt>.</p>
<p class="docText" style="margin:0;">If <tt>new()</tt> cannot open the indicated file, it will return <tt>undef</tt> and set <tt>$!</tt> to the appropriate system error message.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$fh = IO::File-&gt;new_tmpfile</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>new_tmpfile()</tt> constructor, which is called without arguments, creates a temporary file opened for reading and writing. On UNIX systems, this file is anonymous, meaning that it cannot be seen on the file system. When the IO::File object is destroyed, the file and all its contents will be deleted automatically.</p>
<p class="docText" style="margin:0;">This constructor is useful for storing large amounts of temporary data.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = $fh-&gt;close</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>close()</tt> method closes the IO::File object, returning a true result if successful. If you do not call <tt>close()</tt> explicitly, it will be called automatically when the object is destroyed. This happens when the script exits, if you happen to <tt>undef()</tt> the object, or if the object goes out of scope such as when a <tt>my</tt> variable reaches the end of its enclosing block.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = $fh-&gt;open($filename [,$mode [,$perms]])</span></span></span></p>
<p class="docText" style="margin:0;">You can reopen a filehandle object on the indicated file by using its <tt>open()</tt> method. The input arguments are identical to <tt>new()</tt>. The method result indicates whether the open was successful.</p>
<p class="docText" style="margin:0;">This is chiefly used for reopening the standard filehandles <tt>STDOUT</tt>, <tt>STDIN</tt>, and <tt>STDERR</tt>. For example:</p>
<pre>STDOUT-&gt;open("log.txt") or die "Can't reopen STDOUT: $!";
</pre>
<p class="docText" style="margin:0;">Calls to <tt>print()</tt> will now write to the file <span class="docEmphasis"><tt>log.txt</tt> </span>.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = $fh-&gt;print(@args)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result=$fh-&gt;printf($fmt,@args)</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes=$fh-&gt;write($data [,$length [,$offset]])</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = $fh-&gt;syswrite($data [,$length [,$offset]])</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>print()</tt>, <tt>printf()</tt>, and <tt>syswrite()</tt> methods work exactly like their built-in counterparts. For example, <tt>print()</tt> takes a list of data items, writes them to the filehandle object, and returns true if successful.</p>
<p class="docText" style="margin:0;">The <tt>write()</tt> method is the opposite of <tt>read()</tt>, writing a stream of bytes to the filehandle object and returning the number successfully written. It is similar to <tt>syswrite()</tt>, except that it uses stdio buffering. This method corrects the inconsistent naming of the built-in <tt>write()</tt> function, which creates formatted reports. The IO::File object method that corresponds to the built-in <tt>write()</tt> goes by the name of <tt>format_write()</tt>.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$line = $fh-&gt;getline</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">@lines=$fh-&gt;getlines</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = $fh-&gt;read($buffer,$length ",$offset")</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$bytes = $fh-&gt;ysread($buffer,$length ",$offsetr")</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>getline()</tt> and <tt>getlines()</tt> methods together replace the <tt>&lt;&gt;</tt> operator. <tt>getline()</tt> reads one line from the filehandle object and returns it, behaving in the same way in both scalar and list contexts. The <tt>getlines()</tt> method acts like <tt>&lt;&gt;</tt> in a list context, returning a list of all the available lines. <tt>getline()</tt> will return undef at the end of file.</p>
<p class="docText" style="margin:0;">The <tt>read()</tt> and <tt>sysread()</tt> methods act just like their built-in function counterparts.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$previous = $fh-&gt;autoflush([$boolean])</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>autoflush()</tt> method gets or sets the <tt>autoflush()</tt> mode for the filehandle object. Called without arguments, it turns <span class="docEmphasis">on</span> autoflush. Called with a single boolean argument, it sets autoflush to the indicated status. In either case, <tt>autoflush()i</tt> returns the previous value of the autoflush state.</p>
<p class="docText" style="margin:0;"><span class="docEmphStrong">$boolean = $fh-&gt;opened</span></p>
<p class="docText" style="margin:0;">The <tt>opened()</tt> method returns true if the filehandle object is currently valid. It is equivalent to:</p>
<pre>defined fileno($fh);
</pre>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$boolean = $fh-&gt;eof</span></span></span></p>
<p class="docText" style="margin:0;">Returns true if the next read on the filehandle object will return EOF.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$fh-&gt;flush</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>flush()</tt> method immediately flushes any data that is buffered in the filehandle object. If the filehandle is being used for writing, then its buffered data is written to disk (or to the pipe, or network, as we'll see when we get to IO::Socket objects). If the filehandle is being used for reading, any data in the buffer is <tt>discarded</tt>, forcing the next read to come from disk.</p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$boolean = $fh-&gt;blocking("$boolean")</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>blocking()</tt> method turns on and off blocking mode for the filehandle. </p>
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="color:rgb(0,0,255);"><span class="Apple-style-span" style="font-weight:bold;">$fh-&gt;clearerr</span></span></span></p>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="color:rgb(0,0,255);"><span class="Apple-style-span" style="font-weight:bold;">$boolean = $fh-&gt;error</span></span></span></p>
<p class="docText" style="margin:0;">These two methods are handy if you wish to perform a series of I/O operations and check the error status only after you're finished. The <tt>error()i</tt> method will return true if any errors have occurred on the filehandle since it was created, or since the last call to <tt>clearerr()</tt>. The <tt>clearerr()</tt> method clears this flag.</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:0;">
<p class="docText" style="margin:0;"></p>
<p class="docText" style="margin:0;">In addition to the methods listed here, IO::File has a constructor named <tt>new_from_fd()</tt>, and a method named <tt>fdopen()</tt>, both inherited from IO::Handle. These methods can be used to save and restore objects in much the way that the <tt>&gt;&amp;FILEHANDLE</tt> does with standard filehandles.</p>
<p class="docText" style="margin:0;"></p>
<p style="margin:0;">
<table cellspacing="0" width="90%" border="1" style="font-size:1em;line-height:inherit;">
<tbody>
<tr style="text-align:left;">
<td>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$fh = IO::File-&gt;new_from_fd($fd,$mode)</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>new_from_fd()</tt> method opens up a copy of the filehandle object indicated by <tt>$fd</tt> using the read/write mode given by <tt>$mode</tt>. The object may be an IO::Handle object, an IO::File object, a regular filehandle, or a numeric file descriptor returned <tt>byfileno()</tt>. <tt>$mode</tt> must match the mode with which <tt>$fd</tt> was originally opened. For example:</p>
<pre>$saveout = IO::File-&gt;new_from_fd(STDOUT,"&gt;");
</pre>
<p class="docText" style="margin:0;"><span class="docEmphStrong"><span class="Apple-style-span" style="font-weight:bold;"><span class="Apple-style-span" style="color:rgb(0,0,255);">$result = $fh-&gt;fdopen($fd,$mode)</span></span></span></p>
<p class="docText" style="margin:0;">The <tt>fdopen()</tt> method is used to reopen an existing filehandle object, making it a copy of another one. The <tt>$fd</tt> argument may be an IO::Handle object or a regular filehandle, or a numeric file descriptor <tt>$mode</tt> must match the mode with which <tt>$fd</tt> was originally opened.</p>
<p class="docText" style="margin:0;">This is typically used in conjunction with <tt>new_from_fd()</tt> to restore a saved filehandle:</p>
<pre>$saveout = IO::File-&gt;new_from_fd(STDOUT,"&gt;"); # save STDOUT
STDOUT-&gt;open('&gt;log.txt');                     # reopen on a file
STDOUT-&gt;print("Yippy yie yay!/n");            # print something
STDOUT-&gt;fdopen($saveout,"&gt;");                 # reopen on saved 
<img height="9" alt="graphics/ccc.gif" width="14" align="left" border="0" />value
</pre>
<div><span class="Apple-style-span" style="font-family:-webkit-monospace;white-space:pre;"><br /></span></div>
</td>
</tr>
</tbody>
</table>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    
    <div class="main-container shadow">
      <div class="mainbody">
        <h2><a href="/2009/01/13/%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520how%2520do%2520i%2520add%2520a%2520directory%2520to%2520my%2520include%2520path%2520%2528%2540inc%2529%2520at%2520runtime%253f%250d%250a%2520%2520%2520%2520%2520%2520%2520%2520">How do I add a directory to my include path (@INC) at runtime?</a></h2>
        <p>
          Posted by <strong>boyang</strong> at <strong>2009-01-13</strong> with tags <a href="/tags.html#Perl-ref" rel="nofollow">Perl</a>, <a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
        </p>
        
        <div class="post_at_index thepost">
        <p>
     <span class="Apple-style-span" style="color:rgb(17,17,17);font-family:Arial;font-size:16px;"><span class="Apple-style-span" style="font-size:20px;font-weight:bold;">How do I add a directory to my include path (@INC) at runtime?</span></span>
<p style="font-size:100%;">Here are the suggested ways of modifying your include path, including environment variables, run-time switches, and in-code statements:</p>
<ul>
<li><a name="the-PERLLIB-environment-variable"></a><b>the PERLLIB environment variable</b>
<pre class="verbatim" style="margin-left:10px;background-image:initial;background-repeat:initial;background-attachment:initial;-webkit-background-clip:initial;-webkit-background-origin:initial;background-color:rgb(238,238,221);width:90%;background-position:initial initial;border-color:rgb(204,204,204);border-style:solid;border-width:1px;padding:10px;">	$ export PERLLIB=/path/to/my/dir
	$ perl program.pl</pre>
</li>
<li><a name="the-PERL5LIB-environment-variable"></a><b>the PERL5LIB environment variable</b>
<pre class="verbatim" style="margin-left:10px;background-image:initial;background-repeat:initial;background-attachment:initial;-webkit-background-clip:initial;-webkit-background-origin:initial;background-color:rgb(238,238,221);width:90%;background-position:initial initial;border-color:rgb(204,204,204);border-style:solid;border-width:1px;padding:10px;">	$ export PERL5LIB=/path/to/my/dir
	$ perl program.pl</pre>
</li>
<li><a name="the-perl--Idir-command-line-flag"></a><b>the perl -Idir command line flag</b>
<pre class="verbatim" style="margin-left:10px;background-image:initial;background-repeat:initial;background-attachment:initial;-webkit-background-clip:initial;-webkit-background-origin:initial;background-color:rgb(238,238,221);width:90%;background-position:initial initial;border-color:rgb(204,204,204);border-style:solid;border-width:1px;padding:10px;">	$ perl -I/path/to/my/dir program.pl</pre>
</li>
<li><a name="the-use-lib-pragma%3a"></a><b>the use lib pragma:</b>
<pre class="verbatim" style="margin-left:10px;background-image:initial;background-repeat:initial;background-attachment:initial;-webkit-background-clip:initial;-webkit-background-origin:initial;background-color:rgb(238,238,221);width:90%;background-position:initial initial;border-color:rgb(204,204,204);border-style:solid;border-width:1px;padding:10px;">	<a class="l_k" href="http://perldoc.perl.org/functions/use.html" style="color:rgb(139,0,139);font-weight:bold;">use</a> <span class="w" style="color:rgb(0,0,0);">lib</span> <span class="q" style="color:rgb(205,85,85);">"$ENV{HOME}/myown_perllib"</span><span class="sc" style="color:rgb(0,0,0);">;</span></pre>
</li>
</ul>
<p style="font-size:100%;">The last is particularly useful because it knows about machine dependent architectures. The lib.pm pragmatic module was first included with the 5.002 release of Perl.</p>

        </div>
        <a href="javascript:void(0);" style="float:right" onclick="window.scrollTo(0, 0);">Top</a>
        <div style="clear: both;"></div>
      </div>
    </div>
    

    <div class="main-container shadow">
      <div class="mainbody">
        
<div class="pagination">
    <ul>
    
        <li class="prev">
        <a href="/page13">&larr; Previous</a>
        
        </li>
    

    
        <li><a href="/">1</a></li>
        

        
            <li><a href="/page2">2</a></li>
            
        
            <li><a href="/page3">3</a></li>
            
        
            <li><a href="/page4">4</a></li>
            
        
            <li><a href="/page5">5</a></li>
            
        
            <li><a href="/page6">6</a></li>
            
        
            <li><a href="/page7">7</a></li>
            
        
            <li><a href="/page8">8</a></li>
            
        
            <li><a href="/page9">9</a></li>
            
        
            <li><a href="/page10">10</a></li>
            
        
            <li><a href="/page11">11</a></li>
            
        
            <li><a href="/page12">12</a></li>
            
        
            <li><a href="/page13">13</a></li>
            
        
            <li class="disabled"><a>14</a></li>
            
        
            <li><a href="/page15">15</a></li>
            
        
            <li><a href="/page16">16</a></li>
            
        
            <li><a href="/page17">17</a></li>
            
        
            <li><a href="/page18">18</a></li>
            
        
            <li><a href="/page19">19</a></li>
            
        
            <li><a href="/page20">20</a></li>
            
        
    

    
        <li class="next"><a href="/page15">Next &rarr;</a></li>
    
    </ul>
</div>


      </div>
    </div>

  </div>

  <div class="span3 right">
	  <!--
    <div class="side-container shadow">
      <div class="sidebar">
        <wb:follow-button uid="2461544952" type="red_1" width="63" height="24" ></wb:follow-button>
      </div>
  </div>
  -->

    <div class="side-container shadow">
      <div class="sidebar">
        
        <h3>Recent Posts</h3>
        <ul>
        
          <li><span>2014-03-29</span> &raquo; <a href="/2014/03/29/how-to-install-jekyll-in-mac-osx-mavericks">
            How To Install Jekyll in Mac OSX Mavericks</a></li>
        
          <li><span>2014-03-26</span> &raquo; <a href="/2014/03/26/c-code-to-print-pascal-triangle">
            C++ Code to Print Pascal Triangle</a></li>
        
          <li><span>2014-01-22</span> &raquo; <a href="/2014/01/22/baci-simple-install-and-compile-guide">
            BACI Simple Install and Compile Guide</a></li>
        
          <li><span>2014-01-10</span> &raquo; <a href="/2014/01/10/dense-trajectory-notes">
            Dense Trajectory Notes</a></li>
        
          <li><span>2013-10-20</span> &raquo; <a href="/2013/10/20/parallel-mex-file-in-matlab">
            Parallelize mex file in Matlab</a></li>
        
          <li><span>2013-10-11</span> &raquo; <a href="/2013/10/11/notes-of-advanced-machine-learningi">
            Notes of Advanced Machine Learning(I)</a></li>
        
          <li><span>2013-10-10</span> &raquo; <a href="/2013/10/10/undefined-reference-error-during-installing-opencv">
            "undefined reference" error during installing OpenCV</a></li>
        
          <li><span>2013-10-10</span> &raquo; <a href="/2013/10/10/build-dense-trajectory-codes-in-ubuntu">
            Build Dense Trajectory Codes in Ubuntu</a></li>
        
          <li><span>2013-06-12</span> &raquo; <a href="/2013/06/12/matlab-startup-script">
            Matlab Startup Script</a></li>
        
          <li><span>2013-05-16</span> &raquo; <a href="/2013/05/16/counting-unique-k-mers-my-first-go-program">
            Counting Unique k-mers -- My First Go Program</a></li>
        
        </ul>
        
      </div>
    </div>

    <div class="side-container shadow">
      <div class="sidebar">
        
        <h3>Tags</h3>
        <div class="tag_box">
        
        
  
    
        <a href="/tags.html#MFC-ref" class="btn btn-mini">MFC <span>10</span></a>
    
        <a href="/tags.html#Algorithm-ref" class="btn btn-mini">Algorithm <span>7</span></a>
    
        <a href="/tags.html#C-ref" class="btn btn-mini">C <span>16</span></a>
    
        <a href="/tags.html#EMC-ref" class="btn btn-mini">EMC <span>4</span></a>
    
        <a href="/tags.html#notes-ref" class="btn btn-mini">notes <span>3</span></a>
    
        <a href="/tags.html#AI-ref" class="btn btn-mini">AI <span>6</span></a>
    
        <a href="/tags.html#Database-ref" class="btn btn-mini">Database <span>1</span></a>
    
        <a href="/tags.html#Personal-ref" class="btn btn-mini">Personal <span>14</span></a>
    
        <a href="/tags.html#电磁兼容-ref" class="btn btn-mini">电磁兼容 <span>4</span></a>
    
        <a href="/tags.html#Unix-ref" class="btn btn-mini">Unix <span>1</span></a>
    
        <a href="/tags.html#Linux-ref" class="btn btn-mini">Linux <span>3</span></a>
    
        <a href="/tags.html#Unix/Linux-ref" class="btn btn-mini">Unix/Linux <span>86</span></a>
    
        <a href="/tags.html#网络/通信-ref" class="btn btn-mini">网络/通信 <span>1</span></a>
    
        <a href="/tags.html#Tcl/Tk-ref" class="btn btn-mini">Tcl/Tk <span>6</span></a>
    
        <a href="/tags.html#Shell-ref" class="btn btn-mini">Shell <span>1</span></a>
    
        <a href="/tags.html#Network/Telecom-ref" class="btn btn-mini">Network/Telecom <span>3</span></a>
    
        <a href="/tags.html#Perl-ref" class="btn btn-mini">Perl <span>14</span></a>
    
        <a href="/tags.html#Industry-ref" class="btn btn-mini">Industry <span>6</span></a>
    
        <a href="/tags.html#Cloud Computing-ref" class="btn btn-mini">Cloud Computing <span>2</span></a>
    
        <a href="/tags.html#Android-ref" class="btn btn-mini">Android <span>2</span></a>
    
        <a href="/tags.html#VBA-ref" class="btn btn-mini">VBA <span>4</span></a>
    
        <a href="/tags.html#Browser-ref" class="btn btn-mini">Browser <span>2</span></a>
    
        <a href="/tags.html#Plan 9-ref" class="btn btn-mini">Plan 9 <span>9</span></a>
    
        <a href="/tags.html#Go-ref" class="btn btn-mini">Go <span>1</span></a>
    
        <a href="/tags.html#Virtualization-ref" class="btn btn-mini">Virtualization <span>2</span></a>
    
        <a href="/tags.html#CPP-ref" class="btn btn-mini">CPP <span>5</span></a>
    
        <a href="/tags.html#Linux/UNIX-ref" class="btn btn-mini">Linux/UNIX <span>1</span></a>
    
        <a href="/tags.html#Tips-ref" class="btn btn-mini">Tips <span>5</span></a>
    
        <a href="/tags.html#RHEL6.1-ref" class="btn btn-mini">RHEL6.1 <span>1</span></a>
    
        <a href="/tags.html#RPC-ref" class="btn btn-mini">RPC <span>1</span></a>
    
        <a href="/tags.html#rup-ref" class="btn btn-mini">rup <span>1</span></a>
    
        <a href="/tags.html#ksh-ref" class="btn btn-mini">ksh <span>1</span></a>
    
        <a href="/tags.html#file descriptor-ref" class="btn btn-mini">file descriptor <span>1</span></a>
    
        <a href="/tags.html#C/C++-ref" class="btn btn-mini">C/C++ <span>1</span></a>
    
        <a href="/tags.html#Evolutionary Computation-ref" class="btn btn-mini">Evolutionary Computation <span>1</span></a>
    
        <a href="/tags.html#ldd-ref" class="btn btn-mini">ldd <span>1</span></a>
    
        <a href="/tags.html#signal-ref" class="btn btn-mini">signal <span>1</span></a>
    
        <a href="/tags.html#swap-ref" class="btn btn-mini">swap <span>1</span></a>
    
        <a href="/tags.html#NIC-ref" class="btn btn-mini">NIC <span>1</span></a>
    
        <a href="/tags.html#Mac OS-ref" class="btn btn-mini">Mac OS <span>1</span></a>
    
        <a href="/tags.html#VNC-ref" class="btn btn-mini">VNC <span>1</span></a>
    
        <a href="/tags.html#X11-ref" class="btn btn-mini">X11 <span>1</span></a>
    
        <a href="/tags.html#Merge sort-ref" class="btn btn-mini">Merge sort <span>1</span></a>
    
        <a href="/tags.html#boost-ref" class="btn btn-mini">boost <span>1</span></a>
    
        <a href="/tags.html#CDF-ref" class="btn btn-mini">CDF <span>1</span></a>
    
        <a href="/tags.html#Matlab-ref" class="btn btn-mini">Matlab <span>3</span></a>
    
        <a href="/tags.html#Multi-Process-ref" class="btn btn-mini">Multi-Process <span>1</span></a>
    
        <a href="/tags.html#Multi-Threading-ref" class="btn btn-mini">Multi-Threading <span>1</span></a>
    
        <a href="/tags.html#Go; Bioinformatics;-ref" class="btn btn-mini">Go; Bioinformatics; <span>1</span></a>
    
        <a href="/tags.html#Computer Vision-ref" class="btn btn-mini">Computer Vision <span>2</span></a>
    
        <a href="/tags.html#DTF-ref" class="btn btn-mini">DTF <span>2</span></a>
    
        <a href="/tags.html#ffmpeg-ref" class="btn btn-mini">ffmpeg <span>1</span></a>
    
        <a href="/tags.html#OpenCV-ref" class="btn btn-mini">OpenCV <span>1</span></a>
    
        <a href="/tags.html#ML-ref" class="btn btn-mini">ML <span>1</span></a>
    
        <a href="/tags.html#parfor-ref" class="btn btn-mini">parfor <span>1</span></a>
    
        <a href="/tags.html#BACI-ref" class="btn btn-mini">BACI <span>1</span></a>
    
        <a href="/tags.html#Alogrithm-ref" class="btn btn-mini">Alogrithm <span>1</span></a>
    
        <a href="/tags.html#Jekyll-ref" class="btn btn-mini">Jekyll <span>1</span></a>
    
        <a href="/tags.html#Github-ref" class="btn btn-mini">Github <span>1</span></a>
    
  



        </div>
        
      </div>
    </div>

    <div class="side-container shadow">
      <div class="sidebar">
        
        <h3>Links</h3>
        <ul>
        
        
    <li><a href=https://github.com/bo-yang title="My GitHub Channel">My GitHub Channel</a></li>

    <li><a href=https://www.linkedin.com/pub/bo-yang/21/a3/893 title="My Linkedin Page">My Linkedin Page</a></li>

    <li><a href=http://blog.csdn.net/bonny95 title="My Chinese Blog(obsolete)">My Chinese Blog(obsolete)</a></li>

        </ul>
        
      </div>
    </div>
  </div>

</div>

  </div>
</div>


    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> boyang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
        </script>
      </footer>
  </div>

  <!-- Comment out Sina Weibo
  <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
  -->
  <script type="text/javascript" src="/assets/themes/clear/google-code-prettify/prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 200);
        if (count > 200) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow">' + 'Read More ...</a>');
        }
      });
    });
  </script>
  
</body>
</html>

