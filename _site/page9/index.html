
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bo Yang | Bo's Blog</title>
  
  <meta name="author" content="Bo Yang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <!--
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  -->

  <!-- Bootstrap -->
  <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

  <!-- font-awesome -->
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

  <!-- Google Prettify -->
  <link href="/assets/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/style/blog.css" rel="stylesheet">
  
  <script src="/assets/bootstrap/js/jquery-1.10.2.js"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

   <!-- navigation bar -->
	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">bo-yang</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/archive.html">Archive</a>
                    </li>
                    <li><a href="/about.html">About</a>
                    </li>
                    <li><a href="/messages.html">Messages</a>
                    </li>
				</ul>
				<ul class="nav navbar-nav pull-right">
		          <li>
		            <form class="navbar-form navbar-search" method="get" action="http://www.google.com/search" target="google_window">
		              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
		              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
		              <input type="hidden" name="ie" value="UTF-8" />
		              <input type="hidden" name="oe" value="UTF-8" />
		              <input type="hidden" name="hl" value="en-US" />
		              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
					  <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
					  <button type="submit" class="button button-rounded button-flat-blue">Go</button>
		            </form>
		          </li>
		        </ul>
            </div>
			<!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

  <div class="container">
    <div class="row" id="content-row">
      
<div class="page-header">
	<h1>Bo Yang  <small style="margin-left:20px;"><font face="cursive"><i>Beginner's mind.</i></font></small></h1>
</div>

<div class="container">
    <div class="row" id="content-row">
		<div class="col-md-8">
	<!-- blog entry -->
	
	<div class="post paper">	
    <h2 class="header"><a href="/2011/03/21/transfer-excel-to-xml">Excel文件转换为XML以及Linux文件编码格式转换</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-03-21</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#VBA-ref" rel="nofollow">VBA</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>今天需要将多个Excel文档转换为XML&#26684;式，本打算用MS Office自带的另存为XML文件的功能，结果转换成MS Office2003 XML之后的文件就是一坨屎！Office 2007自带的XML文档转换的功能也TMD超级繁琐，根据帮助手册自己建了.xsd文件导入到Excel之后也无法导出XML数据，白白浪费了时间。</p>
<p>后来Google到了<a href="http://www.meadinkent.co.uk/xl_xml1.htm">这篇文章</a>。文中提供了现成的VBA源代码，稍微修改一下即可拿来使用（中文注释为本人所加）：</p>
<p>
<pre>'Attribute VB_Name = &quot;XL_to_XML&quot;
Sub MakeXML()
' create an XML file from an Excel table
Dim MyRow As Integer, MyCol As Integer, Temp As String, YesNo As Variant, DefFolder As String
Dim XMLFileName As String, XMLRecSetName As String, MyLF As String, RTC1 As Integer
Dim RangeOne As String, RangeTwo As String, Tt As String, FldName(99) As String

MyLF = Chr(10) &amp; Chr(13)    ' a line feed command
DefFolder = &quot;C:MyXML&quot;   'change this to the location of saved XML files

YesNo = MsgBox(&quot;This procedure requires the following data:&quot; &amp; MyLF _
 &amp; &quot;1 A filename for the XML file&quot; &amp; MyLF _
 &amp; &quot;2 A groupname for an XML record&quot; &amp; MyLF _
 &amp; &quot;3 A cellrange containing fieldnames (col titles)&quot; &amp; MyLF _
 &amp; &quot;4 A cellrange containing the data table&quot; &amp; MyLF _
 &amp; &quot;Are you ready to proceed?&quot;, vbQuestion + vbYesNo, &quot;MakeXML CiM&quot;)
 
If YesNo = vbNo Then
 Debug.Print &quot;User aborted with 'No'&quot;
 Exit Sub
End If

XMLFileName = FillSpaces(InputBox(&quot;1. Enter the name of the XML file:&quot;, &quot;MakeXML CiM&quot;, &quot;GRE_Core_Words&quot;))
If Right(XMLFileName, 4) &lt;&gt; &quot;.xml&quot; Then
 XMLFileName = XMLFileName &amp; &quot;.xml&quot;
End If

XMLRecSetName = FillSpaces(InputBox(&quot;2. Enter an identifying name of a record:&quot;, &quot;MakeXML CiM&quot;, &quot;item&quot;))

RangeOne = InputBox(&quot;3. Enter the range of cells containing the field names (or column titles):&quot;, &quot;MakeXML CiM&quot;, &quot;A2:D2&quot;)
If MyRng(RangeOne, 1) &lt;&gt; MyRng(RangeOne, 2) Then
  MsgBox &quot;Error: names must be on a single row&quot; &amp; MyLF &amp; &quot;Procedure STOPPED&quot;, vbOKOnly + vbCritical, &quot;MakeXML CiM&quot;
  Exit Sub
End If
MyRow = MyRng(RangeOne, 1)
For MyCol = MyRng(RangeOne, 3) To MyRng(RangeOne, 4)
 If Len(Cells(MyRow, MyCol).Value) = 0 Then
  MsgBox &quot;Error: names range contains blank cell&quot; &amp; MyLF &amp; &quot;Procedure STOPPED&quot;, vbOKOnly + vbCritical, &quot;MakeXML CiM&quot;
  Exit Sub
 End If
 FldName(MyCol - MyRng(RangeOne, 3)) = FillSpaces(Cells(MyRow, MyCol).Value)
Next MyCol

RangeTwo = InputBox(&quot;4. Enter the range of cells containing the data table:&quot;, &quot;MakeXML CiM&quot;, &quot;A3:D6257&quot;)
If MyRng(RangeOne, 4) - MyRng(RangeOne, 3) &lt;&gt; MyRng(RangeTwo, 4) - MyRng(RangeTwo, 3) Then
  MsgBox &quot;Error: number of field names &lt;&gt; data columns&quot; &amp; MyLF &amp; &quot;Procedure STOPPED&quot;, vbOKOnly + vbCritical, &quot;MakeXML CiM&quot;
  Exit Sub
End If
RTC1 = MyRng(RangeTwo, 3)

If InStr(1, XMLFileName, &quot;:&quot;) = 0 Then
 XMLFileName = DefFolder &amp; XMLFileName
End If

Open XMLFileName For Output As #1
Print #1, &quot;&lt;?xml version=&quot; &amp; Chr(34) &amp; &quot;1.0&quot; &amp; Chr(34) &amp; &quot; encoding=&quot; &amp; Chr(34) &amp; &quot;UTF-8&quot; &amp; Chr(34) &amp; &quot;?&gt;&quot;
Print #1, &quot;&lt;wordbook&gt;&quot;

For MyRow = MyRng(RangeTwo, 1) To MyRng(RangeTwo, 2)
Print #1, &quot;&lt;&quot; &amp; XMLRecSetName &amp; &quot;&gt;&quot;
  For MyCol = RTC1 To MyRng(RangeTwo, 4)
  ' the next line uses the FormChk function to format dates and numbers
     Print #1, &quot;&lt;&quot; &amp; FldName(MyCol - RTC1) &amp; &quot;&gt;&quot; &amp; Cells(MyRow, MyCol).Value &amp; &quot;&lt;/&quot; &amp; FldName(MyCol - RTC1) &amp; &quot;&gt;&quot;
  ' the next line does not apply any formatting
  '  Print #1, &quot;&lt;&quot; &amp; FldName(MyCol - RTC1) &amp; &quot;&gt;&quot; &amp; RemoveAmpersands(Cells(MyRow, MyCol).Value) &amp; &quot;&lt;/&quot; &amp; FldName(MyCol - RTC1) &amp; &quot;&gt;&quot;
    Next MyCol
 Print #1, &quot;&lt;/&quot; &amp; XMLRecSetName &amp; &quot;&gt;&quot;

Next MyRow
Print #1, &quot;&lt;/wordbook&gt;&quot;
Close #1
MsgBox XMLFileName &amp; &quot; created.&quot; &amp; MyLF &amp; &quot;Process finished&quot;, vbOKOnly + vbInformation, &quot;MakeXML CiM&quot;
Debug.Print XMLFileName &amp; &quot; saved&quot;
End Sub
Function MyRng(MyRangeAsText As String, MyItem As Integer) As Integer
' analyse a range, where MyItem represents 1=TR, 2=BR, 3=LHC, 4=RHC

Dim UserRange As Range
Set UserRange = Range(MyRangeAsText)
Select Case MyItem
 Case 1
 MyRng = UserRange.Row
 Case 2
 MyRng = UserRange.Row + UserRange.Rows.Count - 1
 Case 3
 MyRng = UserRange.Column
 Case 4
 MyRng = UserRange.Columns(UserRange.Columns.Count).Column
End Select
Exit Function

End Function
Function FillSpaces(AnyStr As String) As String
' remove any spaces and replace with underscore character
Dim MyPos As Integer
MyPos = InStr(1, AnyStr, &quot; &quot;)
Do While MyPos &gt; 0
 Mid(AnyStr, MyPos, 1) = &quot;_&quot;
 MyPos = InStr(1, AnyStr, &quot; &quot;)
Loop
FillSpaces = LCase(AnyStr)
End Function

Function FormChk(RowNum As Integer, ColNum As Integer) As String
' formats numeric and date cell values to comma 000's and DD MMM YY
FormChk = Cells(RowNum, ColNum).Value
If IsNumeric(Cells(RowNum, ColNum).Value) Then
 FormChk = Format(Cells(RowNum, ColNum).Value, &quot;#,##0 ;(#,##0)&quot;)
End If
If IsDate(Cells(RowNum, ColNum).Value) Then
 FormChk = Format(Cells(RowNum, ColNum).Value, &quot;dd mmm yy&quot;)
End If
End Function

Function RemoveAmpersands(AnyStr As String) As String
Dim MyPos As Integer
' replace Ampersands (&amp;) with plus symbols (+)

MyPos = InStr(1, AnyStr, &quot;&amp;&quot;)
Do While MyPos &gt; 0
 Mid(AnyStr, MyPos, 1) = &quot;+&quot;
 MyPos = InStr(1, AnyStr, &quot;&amp;&quot;)
Loop
RemoveAmpersands = AnyStr
End Function
</pre>
<p></p>
<p></p>
<p>如果不想将文件中的&amp;替换为&#043;，可以将第55行的<span>RemoveAmpersands(FormChk(MyRow,&nbsp;MyCol))替换为</span><span>Cells(MyRow,&nbsp;MyCol).Value。</span></p>
<p>&nbsp;</p>
<p>需要注意的是在Excel文件中必须有一行是标题行——即改行存放各列的标题，否则生成的XML文件&#26684;式不一定是你所需要的。</p>
<p>&nbsp;</p>
<p>由于我对XML文件的编码&#26684;式有要求，必须是UTF-8，而Windows默认的编码&#26684;式是GBXXXX，因此需要对生成的XML文件进行编码&#26684;式转换。搜索到了<a href="http://tech.16c.cn/linux/glpz/20100221/22560.html">linux 查看文件编码以及修改编码</a>一文，摘录重点如下：</p>
<p>&nbsp;</p>
<p>查看文件编码</p>
<p>&nbsp;</p>
<p>　　在Linux中查看文件编码可以通过以下几种方式：</p>
<p>　　1.在Vim中可以直接查看文件编码</p>
<p>　　:set fileencoding</p>
<p>　　即可显示文件编码&#26684;式。</p>
<p>　　如果你只是想查看其它编码&#26684;式的文件或者想解决用Vim查看文件乱码的问题，那么你可以在~/.vimrc 文件中添加以下内容：</p>
<p>　　set encoding=utf-8 fileencodings=ucs-bom,utf-8,cp936</p>
<p>　　这样，就可以让vim自动识别文件编码（可以自动识别UTF-8或者GBK编码的文件），其实就是依照fileencodings提供的编码列表尝试，如果没有找到合适的编码，就用latin-1(ASCII)编码打开。</p>
<p>　　2. enca (如果你的系统中没有安装这个命令，可以用sudo yum install -y enca 安装 )查看文件编码</p>
<p>　　$ enca filename</p>
<p>　　filename: Universal transformation format 8 bits; UTF-8</p>
<p>　　CRLF line terminators</p>
<p>　　需要说明一点的是，enca对某些GBK编码的文件识别的不是很好，识别时会出现：</p>
<p>　　Unrecognized encoding</p>
<p>&nbsp;</p>
<p>文件编码转换</p>
<p>　　1.在Vim中直接进行转换文件编码,比如将一个文件转换成utf-8&#26684;式</p>
<p>　　:set fileencoding=utf-8</p>
<p>　　2. enconv 转换文件编码，比如要将一个GBK编码的文件转换成UTF-8编码，操作如下</p>
<p>　　enconv -L zh_CN -x UTF-8 filename</p>
<p>　　3. iconv 转换，iconv的命令&#26684;式如下：</p>
<p>　　iconv -f encoding -t encoding inputfile</p>
<p>　　比如将一个UTF-8 编码的文件转换成GBK编码</p>
<p>　　iconv -f GBK -t UTF-8 file1 -o file2</p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/03/10/hostname-in-etc-hosts">在/etc/hosts中定义Linux的hostname</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-03-10</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Network/Telecom-ref" rel="nofollow">Network/Telecom</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>今天碰到这样一个问题：一个程序在刚刚装好的Linux server上获取IP地址时永远都是0x7f000001。一开始没有注意，后来仔细一想，0x7f000001不正好就是127.0.0.1嘛！有同事查了一下/etc/hosts，发现在该文件中有这样一行：</p>
<p>
<pre>127.0.0.1     mylinuxsvr localhost.localhost.localdomain localhost
</pre>
<p>&nbsp;</p>
<p>其中，mylinuxsvr是这个server的名字。难怪每次都只能获取到127.0.0.1呢。当然了，这台server的IP地址其实是配好了的，只是不知为什么，有一个不同server间通信的程序非要通过/etc/hosts来获取IP地址&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>找了一些Linux server网络配置的文章，记录于此：</p>
<ol>
<li><a href="http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch03_:_Linux_Networking">Quick HOWTO : Ch03 : Linux Networking</a></li>
<li><a href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Virtualization_for_Servers/2.2/html/Administration_Guide/Administration_Guide-Create_Objects-Add_Server.html">Adding Red Hat Enterprise Linux Hosts</a></li>
</ol>
<p>下文摘自<a href="http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch03_:_Linux_Networking">Quick HOWTO : Ch03 : Linux Networking</a>。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><span id="Configuring_Your_.2Fetc.2Fhosts_File" class="mw-headline">Configuring Your /etc/hosts File</span></h1>
<p><span class="goog_qs-tidbit goog_qs-tidbit-0 goog_qs-tidbit-hilite">The /etc/hosts file is just a list of IP addresses and their corresponding server names.</span>&nbsp;Your server will typically check this file before referencing DNS. If the name is found with a corresponding IP address then DNS won't be queried at all. Unfortunately, if the IP address for that host changes, you also have to also update the file. This may not be much of a concern for a single server, but can become laborious if it has to be done companywide. For ease of management, it is often easiest to limit entries in this file to just the loopback interface and also the server's own hostname, and use a centralized DNS server to handle most of the rest. Sometimes you might not be the one managing the DNS server, and in such cases it may be easier to add a quick /etc/hosts file entry till the centralized change can be made.</p>
<pre>192.168.1.101  smallfry

</pre>
<p>In the example above server smallfry has an IP address of 192.168.1.101. You can access 192.168.1.101 using the ping, telnet or any other network aware program by referring to it as smallfry. Here is an example using the ping command to see whether smallfry is alive and well on the network:</p>
<pre>[root@bigboy tmp]# ping smallfry
PING zero (192.168.1.101) 56(84) bytes of data.
64 bytes from smallfry (192.168.1.101): icmp_seq=0 ttl=64 time=0.197 ms
64 bytes from smallfry (192.168.1.101): icmp_seq=1 ttl=64 time=0.047 ms


--- smallfry ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 2017ms
rtt min/avg/max/mdev = 0.034/0.092/0.197/0.074 ms, pipe 2
[root@bigboy tmp]#

</pre>
<p>You can also add aliases to the end of the line which enable you to refer to the server using other names. Here we have set it up so that smallfry can also be accessed using the names&nbsp;<code>tiny</code>&nbsp;and&nbsp;<code>littleguy</code>.</p>
<pre>192.168.1.101  smallfry  tiny  littleguy

</pre>
<p>You should never have an IP address more than once in this file because Linux will use only the values in the first entry it finds.</p>
<pre>192.168.1.101  smallfry    # (Wrong)
192.168.1.101  tiny        # (Wrong)
192.168.1.101  littleguy   # (Wrong)
</pre>
<p>&nbsp;</p>
<h2><span id="The_loopback_Interface.27s_localhost_Entry" class="mw-headline">The loopback Interface's localhost Entry</span></h2>
<p>Usually the first entry in /etc/hosts defines the IP address of the server's virtual loopback interface. This is usually mapped to the name localhost.localdomain (the universal name used when a server refers to itself) and localhost (the shortened alias name). By default, Fedora inserts the hostname of the server between the 127.0.0.1 and the localhost entries like this:</p>
<pre>127.0.0.1     bigboy    localhost.localdomain    localhost

</pre>
<p>When the server is connected to the Internet this first entry after the 127.0.0.1 needs to be the fully qualified domain name (FQDN) of the server. For example,&nbsp;<code>bigboy.mysite.com</code>, like this:</p>
<pre>127.0.0.1     bigboy.my-site.com    localhost.localdomain    localhost

</pre>
<p>Some programs such as Sendmail are very sensitive to this and if they detect what they feel is an incorrect FQDN they will default to using the name localhost.localdomain when communicating with another server on the network. This can cause confusion, as the other server also feels it is localhost.localdomain.</p>
<p>Note:&nbsp;You must always have a localhost and localhost.localdomain entry mapping to 127.0.0.1 for Linux to work properly and securely.</p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/03/07/plan9-intro-note-4">Plan9 Files -- Notes of Introduction to OS Abstractions Using Plan 9 from Bell Labs(IV)</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-03-07</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>&nbsp;</p>
<div>
<h4 id="internal-source-marker_0.12957935757003725"><span>2.1 Input/Output</span></h4>
<p><span>Most of the times, standard input, standard output, and standard error go to </span><span>/dev/cons</span><span>. This file represents the console for your program.It is the interface to use the device that is known as the console, which corresponds to your terminal.</span><span>The file interface provided for each process in Plan 9 has a file that provides the list of open file descriptors for the process. For example, to know which file descriptors are open in the shell we are using we can do this.</span>
<pre> term% cat /proc/$pid/fd/usr/glenda
 0 r  M   40 (0000000000000001 0 00)  8192       47 /dev/cons
 1 w  M   40 (0000000000000001 0 00)  8192     3506 /dev/cons
 2 w  M   40 (0000000000000001 0 00)  8192     3506 /dev/cons
 3 r  M    8 (000000000000166b 2 00)  8192      512 /rc/lib/rcmain
 4 r  M   40 (0000000000000001 0 00)  8192       47 /dev/cons</pre>
<p><span>Each time you open a file, the system keeps track of a file offset for that open file, to know the offset in the file where to start working at the next </span><span>read</span><span> or </span><span>write</span><span>. </span><br /><span>The offset for a file descriptor can be changed using the </span><span>seek</span><span> system call.</span></p>
<h4><span>2.2 Write games</span></h4>
<p><span>A </span><span>Chan</span><span>(or Channel) is a data structure, which contains all the information needed to let the kernel reach the file server and perform operations on the file. A </span><span>Chan</span><span> is just something used by Plan 9 to speak to a server regarding a file. This may require doing remote procedure calls across the network, but that is up to your kernel, and you can forget. There is one </span><span>Chan</span><span> per file in use in the system.</span></p>
<p><span>The size of a file corresponds to the highest file offset ever written on it. All the bytes that we did not write were set to zero by Plan 9.</span><br /><span>seek(fd, 0, 2); // move to the end</span><br /><span>append only permission bit :</span><br /><span>; chmod +a /sys/log/diagnostics</span><br /><span>; ls -l /sys/log/diagnostics</span><br /><span>a-rw-r--r-- M 19 nemo nemo 0 Jul 10 01:11 /sys/log/diagnostics</span><br /><span>+a</span><span> permission bit guarantees that any write will happen at the end of existing data, no matter what the offset is.</span><br /><span>Doing a </span><span>seek</span><span> in all programs using this file might not suffice. If there are multiple machines writing to this file, each machine would keep its own offset for the file. Therefore, there is some risk of overwriting some data in the file.</span><br /><span>The </span><span>create</span><span> system call creates one file.</span><br /><span>The system call </span><span>remove</span><span> removes the named file. </span><br /><span>The system call </span><span>access</span><span> to check file properties.</span></p>
<h4><span>2.3 Directory Entry</span></h4>
<p><span>File </span><span>metadata</span><span> is simply what the system needs to know about the file to be able to implement it. File metadata includes the file name, the file size, the time for the last modification to the file, the time for the last access to the file, and other attributes for the file. Thus, file metadata is also known as file attributes.</span><br /><span>Plan 9 stores attributes for a file in the directory that contains the file. Thus, the data structure that contains file metadata is known as a directory entry. A directory contains just a sequence of entries, each one providing the attributes for a file contained in it.</span><br /><span>To obtain the directory entry for a file, i.e., its attributes, we can use </span><span>dirstat</span><span>. This function &nbsp;uses the actual system call, </span><span>stat</span><span>, to read the data, and returns a Dir structure that is more convenient to use in C programs. This structure is stored in dynamic memory allocated with malloc &nbsp;by dirstat, and the caller is responsible for calling free on it. </span><br /><span>Because directories contain directory entries, reading from a directory is very similar to &nbsp;what we have just done. The function </span><span>read</span><span> can be used to read directories as well as files. The &nbsp;only difference is that the system will read only an integral number of directory entries. If one &nbsp;more entry does not fit in the buffer you supply to read, it will have to wait until you read again. </span><br /><span>The entries are stored in the directory in a portable, machine independent, and not amenable, format. Therefore, instead of using </span><span>read</span><span>, it is more convenient to use </span><span>dirread</span><span>. This &nbsp;function calls read to read the data stored in the directory. But before returning to the caller, it &nbsp;unpacks them into a, more convenient, array of Dir structures. </span><br /><span>The function </span><span>dirwstat</span><span> is the counterpart of </span><span>dirstat</span><span>. It works in a similar way, but &nbsp;instead of reading the attributes, it updates them. New values for the update are taken from a Dir &nbsp;structure given as a parameter. However, the function ignores any field set to a null value, to &nbsp;allow you to change just one attribute, or a few ones. Beware that zero is not a null value for some of the fields, because it would be a perfectly legal value for them. The function </span><span>nulldir</span><span> &nbsp;is to be used to null all of the fields in a given Dir. </span></p>
<h3><span>2.4 Bio</span></h3>
<p><span>The bio(2) library in Plan 9 provides buffered input/output. This is an abstraction that,although not provided by the underlying Plan 9, is so common that you really must know how it works. The idea is that your program creates a </span><span>Bio</span><span> buffer for reading or writing, called a </span><span>Biobuf</span><span>. Your program reads from the </span><span>Biobuf</span><span>, by calling a library function, and the library will call read only to refill the buffer each time you exhaust its contents. </span>
<pre>#include &lt;u.h&gt;
#include &lt;libc.h&gt;
#include &lt;bio.h&gt;
static void
usage(void)
{
    fprint(2,"usage: %s [-b bufsz] infile outfile/n", argv0);
    exits("usage");
}
void
main(int argc, char* argv[])
{
    char* buf;
    long nr, bufsz = 8*1024;
    Biobuf* bin;
    Biobuf* bout;
    ARGBEGIN{
    case 'b':
        bufsz = atoi(EARGF(usage()));
        break;
    default:
        usage();
    }ARGEND;
    if (argc !=2)
        usage();
    buf = malloc(bufsz);
    if (buf == nil)
        sysfatal("no more memory");
    bin = Bopen(argv[0], OREAD);
    if (bin == nil)
        sysfatal("%s: %s: %r", argv0, argv[0]);
    bout = Bopen(argv[1], OWRITE);
    if (bout == nil)
        sysfatal("%s: %s: %r", argv0, argv[1]);
    for(;;) {
        nr = Bread(bin, buf, bufsz);
        if (nr &lt; 0)
            break;
        Bwrite(bout, buf, nr);
    }
    Bterm(bin);
    Bterm(bout);
    exits(nil);
}</pre>
<p>&nbsp;</p></div>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/03/02/regexp-per-line">regexp -line逐行匹配</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-03-02</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Tcl/Tk-ref" rel="nofollow">Tcl/Tk</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>以前没注意到Tcl/Tk的正则表达式命令regexp还有一个逐行匹配的选项-line（其实是三个-line, <span>-lineanchor和</span><span>-linestop，第一个是后两者的综合</span>），因此碰到需要在多行内容中匹配某一行的中的某字符（串）是总是不得不用AWK,PERL等其他工具，现在有了-line，直接regexp -line &lt;pattern&gt; &lt;var&gt;就搞定了！</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/27/plan9-intro-note-3">Plan9 Environment Variables -- Notes of Introduction to OS Abstractions Using Plan 9 from Bell Labs(III)</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-27</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p><span style="font-family:'Trebuchet MS', sans-serif;">The<br />
interface for using environment variables in Plan 9 is a file<br />
interface.<br />
 All interfaces of environment variables can be found<br />
under <span style="font-family:'Courier New', monospace;">/env</span>.</span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;">To<br />
obtain the value for a environment variable, from a C program, we can<br />
use the </span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;">getenv</span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><br />
system call. If the variable is not defined, </span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;">getenv</span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><br />
returns a null string. A related call is </span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;">putenv</span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;">,<br />
which accepts a name and a value, and set the corresponding<br />
environment variable accordingly.</span></span></p>
<p><span style="font-family:'Trebuchet MS', sans-serif;">
<pre>#include &lt;u.h&gt;
#include &lt;libc.h&gt;
void main()
{
char * path;
path=getenv("path");
if(path==nil)
sysfatal("path not defined!");
print("PATH is %s /n", path);
exits(nil);
}</pre>
<p>&nbsp;</span></p>
<p>&nbsp;</p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;">In<br />
some cases it is convenient to define an environment variable just<br />
for a command. This can be<br />
 done by defining it in the same command<br />
line, before the command, like in the following exam-ple:<br />
</span></span></p>
<p><span style="font-family:'Courier New', monospace;">
<pre>; temp=/tmp/foobar echo $temp
/tmp/foobar
; echo $temp
;
</pre>
<p>&nbsp;</span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><strong>Useful<br />
Environment Variables:</strong></span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-family:'Courier New', monospace;">status</span><br />
is updated by the shell once it finds out how it went to the last<br />
command it executed.<br />
</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-family:'Courier New', monospace;">path</span><br />
is a list of paths where the shell should<br />
look for executable files<br />
to run the user commands.<br />
</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-family:'Courier New', monospace;">user</span><br />
contains the user name<br />
.</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-family:'Courier New', monospace;">sysname</span><br />
contains the machine name.<br />
</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;">The<br />
file <span style="font-family:'Courier New', monospace;">/dev/text </span>represents<br />
the<br />
 text shown in the window (when used within that window). To make<br />
a copy of your shell session,<br />
 you already know what to do:<br />
</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Courier New', monospace;">;<br />
cp /dev/text $home/saved<br />
</span></span></p>
<p><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;">The<br />
same can be done for the image shown in the display for your window,<br />
which is also represented as a file, <span style="font-family:'Courier New', monospace;">/dev/window</span>.<br />
This is what we did to capture screen images .</span></span></p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/26/plan9-intro-note-2">Notes of Introduction to OS Abstractions Using Plan 9 from Bell Labs(II)</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-26</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>	&lt;!--<br />
		@page { margin: 0.79in }<br />
		P { margin-bottom: 0.08in }<br />
	--&gt;</p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span><span style="font-size:x-small;"><span style="font-family:mceinline;">man</span><span style="font-family:'Trebuchet MS', sans-serif;">:<br />
section 1 is for commands, section 8 is fo</span><span style="font-family:mceinline;">r&nbsp;</span></span></span></span><span style="font-family:'Trebuchet MS', sans-serif;font-size:x-small;"><span style="font-family:mceinline;">commands<br />
not commonly used by users (i.e., they are intended to administer the<br />
system), and</span></span></p>
<p align="LEFT"><span style="color:#000000;"><br />
</span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">section<br />
2 is for C functions and libraries. </span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;">To<br />
read a manual page found at a particular</span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><br />
</span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">section,<br />
you can type the section number and the page name after the man<br />
command, like in</span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"> </span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">;<br />
man 1 ls</span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">lookman<br />
</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">is<br />
used to search manual.</span></span></span></span></p>
<p align="LEFT">&nbsp;</p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">sig</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
displays the signature, i.e., the prototype for a C function<br />
documented in section 2 of the manual.</span></span></span></span></p>
<p align="LEFT">&nbsp;</p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">Flag<br />
</span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">-m</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
asks </span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">ls</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
to print the name of the user who last modified a file, along with<br />
the file name.</span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">cp</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
accepts more than one  (source) file name to copy to the destination<br />
file name. </span></span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">We<br />
can see a dump of the bytes kept within that file using the  program<br />
</span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">xd</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
(hexadecimal dump). This program reads a file and writes its contents<br />
so that it is </span></span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">easy<br />
for us to read. Option </span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">-b</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
asks </span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">xd</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US"><br />
to print the contents as a series of bytes:</span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">term%<br />
xd -b TODO</span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000000<br />
 63 6f 70 79 20 6d 6b 64 65 70 20 66 72 6f 6d 20</span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000010<br />
 6c 65 66 66 65 20 28 2d 72 20 66 6c 61 67 29 0a</span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000020<br />
 0a</span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000021<br />
</span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">Adding<br />
option </span></span></span></span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">-c</span></span></span></span><span style="color:#000000;"><span style="font-family:'Trebuchet MS', sans-serif;"><span style="font-size:x-small;"><span lang="en-US">,<br />
the program prints the character for each byte when feasible:</span></span></span></span></p>
<p lang="en-US" align="LEFT">&nbsp;</p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">term%<br />
xd -b -c TODO</span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000000<br />
 63 6f 70 79 20 6d 6b 64 65 70 20 66 72 6f 6d 20</span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><br />
</span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">0<br />
  c  o  p  y     m  k  d  e  p     f  r  o  m   </span></span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000010<br />
 6c 65 66 66 65 20 28 2d 72 20 66 6c 61 67 29 0a</span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><br />
</span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">10<br />
  l  e  f  f  e     (  -  r     f  l  a  g  ) /n</span></span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000020<br />
 0a</span></span></span></p>
<p align="LEFT"><span style="color:#000000;"><br />
</span><span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;"><span lang="en-US">20<br />
 /n</span></span></span></span></p>
<p lang="en-US" align="LEFT">
<span style="color:#000000;"><span style="font-family:'Courier New', monospace;"><span style="font-size:x-small;">0000021<br />
</span></span></span></p>
<p align="LEFT">&nbsp;</p>
<p align="LEFT">The<br />
command <span style="font-family:'Courier New', monospace;">nm</span> (name list)<br />
displays the names of symbols (i.e., procedure names, variables) that<br />
are contained or required by our object and executable files.</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/24/ip-addr-in-plan9">Plan9自动获取IP地址</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-24</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>Plan 9的Manual和Wiki上面关于网络配置的介绍，都是以server为原型，前提条件是这些server都会有固定的IP地址，集成DHCP、DNS乃至自己的子网。可我的Plan 9是在VirtualBox4.0的虚拟机上装的，Host是Fedora 14，通过家用无线路由器上网，IP地址动态获取，不可能有固定IP和固定的DNS、Gateway等等。因此<a href="http://cm.bell-labs.com/wiki/plan9/Network_configuration/index.html">http://cm.bell-labs.com/wiki/plan9/Network_configuration/index.html</a>和<a href="http://plan9.escet.urjc.es/magic/man2html/8/ipconfig">http://plan9.escet.urjc.es/magic/man2html/8/ipconfig</a>的方法根本无效。</p>
<p>VirtualBox4.0安装Plan9时，由于没有选择正确的网卡，Plan9使用了默认的Am79C970A网卡，而Plan 9自身并没有该网卡的驱动。要使用plan9自带的网卡驱动而无须自己编译内核的方法就是在plan9.ini中更改默认网卡的类型，可以参考&nbsp;<a href="http://plan9.escet.urjc.es/magic/man2html/8/plan9.ini">http://plan9.escet.urjc.es/magic/man2html/8/plan9.ini</a>。plan9.ini存储在9fat中，默认不挂载到fossil，因此需要在Rio的窗口中输入命令&ldquo;<span style="font-family:mceinline;">9fat:</span>&rdquo;挂载9fat，然后<span style="font-family:mceinline;">cd /n/9fat/</span>，编辑plan9.ini，加入一行&ldquo;<span style="font-family:mceinline;">ether0=type=igbe</span>&rdquo;。同时VirtualBox的网卡也要选择NAT --&gt; Intel Pro1000系列。重启Plan9之后，可以通过ip/ipconfig检查网卡是否能正常工作&mdash;&mdash;如果不报错，证明网卡正常。</p>
<p>网卡正常工作后，我曾经尝试使用下列命令配置网络，DHCP可以正常工作，但DNS一直无法解析域名：</p>
<p>
<pre>ip/ipconfig -D -d ether /net/ether0</pre>
<p>&nbsp;</p>
<p>尝试更改/lib/ndb/local多次，仍然无效。无奈之下打开<span style="font-family:mceinline;">/rc/bin/termrc</span>，发现其中依然有了网络配置的内容，只是默认被注释掉了，去掉if以及ip/ipconfig两行前面的#后，重启Plan 9，网络竟然正常了！</p>
<p>
<pre># start IP on the LAN, if not already configured.  diskless terminals
# are already configured by now.  It's commented out to avoid a long timeout
# on startup waiting for DHCP.
#
# If your site provides DHCP service,
#
#if(! test -e /net/ipifc/0/ctl)
#	ip/ipconfig
#
# Otherwise, see /cfg/$sysname/termrc (/cfg/example/termrc is an example).
</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>另外，9vx本身没有虚拟网卡，因此在/net下没有ether0的选项；但是9vx默认是通过宿主机的网卡来上网的，因此一般情况下9vx的网络无须特殊配置（/rc/bin/termrc中也有对vx32的相应处理）。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/21/install-go-inplan9">Plan 9安装Go</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-21</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Go-ref" rel="nofollow">Go</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>I、安装python和mercurial(hg)</p>
<p>首先是在term中输入9fs sources, 然后cd到/n/sources/contrib下，参照Plan 9的<a href="http://plan9.bell-labs.com/wiki/plan9/contrib_index/index.html">contrib index</a>，找到"From fgb's contrib"的python用户名。</p>
<p><pre>% 9fs sources
% /n/sources/contrib/fgb/root/rc/bin/contrib/install fgb/contrib
% contrib/install -f bichued/python
% contrib/install -f bichued/hg</pre></p>
<p>或者将/n/sources/extra/python.iso.bz2拷到自己的目录下，然后</p>
<p>
<pre>% bunzip2 python.iso.bz2
% 9660srv -f python.iso
% 9fs 9660
% cd /n/9660
% cat README</pre></p>
<p>
然后参照README中的说明来安装python。需要注意的是在执行setup脚本之前，应该9fs kfs，否则会出错。</p>
<p>&nbsp;</p>
<p>II、安装Go<br />
参考<a href="http://golang.org/doc/install.html">http://golang.org/doc/install.html</a></p>
<p>
<pre>% hg clone -r release https://go.googlecode.com/hg/ go</pre></p>
<p>奇怪的是装完mercurial，执行上面的命令之后，总是会报如下的错误：</p>
<p><img src="http://bonny95.files.wordpress.com/2011/02/0_1298343128g5li.gif" alt="plan9 hg error" width="708" height="441" /></p>
<p>后来在contrib index中找到了contrib/ericvh目录下的go-plan9，尝试用dircp拷到自己目录下，总是会报各种各样的问题。几次失败之后，决定用tar cvf $home/go.tar /n/sources/contrib/ericvh/go-plan9试试。</p>
<p>&nbsp;</p>
<p><strong><em>2011-02-25更新：</em></strong></p>
<p>在VirtualBox的Plan 9虚拟机中按照contrib/install来安装Python, Mercurial和执行hg clone go时并未出现任何错误。看来9vx和Plan9比起来还是很不稳定的。可惜的是Go默认的编译脚本是bash写的，而Plan 9只支持rc，看来只能等将来有时间再研究如何把bash的脚本改成rc了。</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/21/abaco-in-plan9">Plan 9中使用Abaco</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-21</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Plan 9-ref" rel="nofollow">Plan 9</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Go-ref" rel="nofollow">Go</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>Abaco是Plan 9的一个非常原始的浏览器，要想使用它，必须首先按照下列步骤：</p>
<ol>
<li>term% &nbsp;<span>webcookies (可选，如果webfs可以直接运行的话，不必运行webcookies)</span></li>
<li><span>term% &nbsp;webfs</span></li>
<li><span>term% &nbsp;abaco</span></li>
</ol>
<p>如果不启动webfs的话，很可能你会遇到这样的错误：</p>
<p><span><br />
</span>
<pre>term% abaco
*abaco: can't initialize webfs: '/mnt/web/ctl' does not exist*</pre></p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2011/02/18/xterm-delete-key">xterm中删除键无法使用</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2011-02-18</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>一个困扰了我很久得问题：xterm中&lt;backspace&gt;或&lt;delete&gt;键无法删除敲错的字符，只能使用Ctrl+H或者VI删除模式，很不方便。操作系统是Red Hat Enterprise Linux 5.5。</p>
<p>&nbsp;</p>
<p>Google之后发现这个问题比较普遍，但是很多建议都不能解决问题。最终在<a href="http://forums11.itrc.hp.com/service/forums/questionanswer.do?admit=109447626+1298028466012+28353475&amp;threadId=1158640">http://forums11.itrc.hp.com/service/forums/questionanswer.do?admit=109447626+1298028466012+28353475&amp;threadId=1158640</a>发现了一个可行的办法：</p>
<p>&nbsp;</p>
<p>stty erase &lt;backspace&gt;</p>
<p>&nbsp;</p>
<p>当然在设置之前要先用stty -a查看erase=XX是不是已经设置成了&lt;backspace&gt;，即^?。</p>
<p>&nbsp;</p>
<p>如果不想每次打开一个新的xterm之后都要手动输入stty erase &lt;backspace&gt;，可以在.env中加入</p>
<p>&nbsp;</p>
<p>stty erase&nbsp;^?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>PS：发现了一个详细解释并彻底解决各种Unix/Linux窗口中&lt;backspace&gt;或&lt;delete&gt;不一致的文章：<a href="http://www.ibb.net/~anne/keyboard.html">http://www.ibb.net/~anne/keyboard.html</a>。转载如下。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="c3">
<div class="c1">The Linux Hall of Shame</div>
<p class="c2"><a href="http://www.ibb.net/~anne/keyboard.html">http://www.ibb.net/~anne/keyboard.html</a><br />version 0.6&nbsp;<br />Last updated 11/18/2008 13:08:02</p>
</div>
<p>&nbsp;</p>
<div class="c3"><span style="text-decoration:underline;">Main Page</span>|<a href="http://www.ibb.net/~anne/keyboard/keyboardprev.html">The Alternative Way</a>&nbsp;|<a href="http://www.ibb.net/~anne/keyboard/troubleshooting.html">Troubleshooting</a></div>
<p>&nbsp;</p>
<div class="c3">
<table border="0">
<tbody>
<tr>
<th colspan="9">
<h3>Index</h3>
</th>
</tr>
<tr>
<td colspan="5">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#intro">Introduction</a></div>
</td>
<td colspan="4">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#term">Terminology</a></div>
</td>
</tr>
<tr>
<td colspan="3">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#prob">The Problem</a></div>
</td>
<td colspan="3">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#sol">Solution(work-arounds)</a></div>
</td>
<td colspan="3">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#overview">Overview</a></div>
</td>
</tr>
<tr>
<td colspan="9">
<div class="c3"><em>Configuration of environments...</em></div>
</td>
</tr>
<tr>
<td colspan="2">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#terminfo">terminfo</a></div>
</td>
<td colspan="2">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Xterm">Xterm</a></div>
</td>
<td>
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#X">X</a></div>
</td>
<td colspan="2">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Bash">Bash</a></div>
</td>
<td colspan="2">
<div class="c3"><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Tcsh">Tcsh</a></div>
</td>
</tr>
<tr>
<td colspan="9">
<div class="c3"><em>... and applications</em></div>
</td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#athena">Athena-apps</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#emacs">Emacs</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#joe">Joe</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#kde">KDE</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#less">Less</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#nedit">Nedit</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#netscape">Netscape</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#pico">Pico and Pine</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#vim">Vim</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#mutt">Mutt</a></td>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#other">Telnet</a></td>
</tr>
</tbody>
</table>
</div>
<div class="c3">
<h2><a name="intro">Introduction</a></h2>
</div>
<p>These pages were originally written to address a nagging problem which bothered many people using&nbsp;<a href="http://www.linux.org/">Linux</a>. It has to do with the default behaviour of the BackSpace and Delete keys, which did not behave as expected. The goal of this document was and still is to make [&lt;---] (i.e. the backspace-key on your keyboard) to erase to the left, and make [Delete](i.e. the delete-key) erase under the cursor. It seems all Linux distributions I am aware of have effectively dealt with the issue by now. However still lots of people visit these pages, presumably because the information presented here is applicable to other UNIX flavors and cross-platform environments and applications.</p>
<p>The keymapping problem can be traced back to the time when computers used punched tapes. The only way to correct a wrongly punched character was to punch additional bits in the tape (or rather, punch additional bits _out_ of the tape). Characters with all the bits punched were treated as deleted characters. See 'man ascii' for a list of the ASCII characterset, you'll see that DEL, (octal 177, decimal 127 and hexadecimal 7F) is the one with all the bits punched in (the ASCII code with the highest value). To be able to overwrite a character it is necessary to undo the feed between the characters first. For this the ASCII BS (octal 010, decimal 8, hexadecimal 08) was used. So to erase the last-typed character, you would have to press first BS to move back one character, and then DEL to delete the character. In newer computers either BS or DEL was chosen to move back and delete in one press.</p>
<p>The question to use BS or DEL was (and is...) just a matter of choice, just as different operating systems chose different ways to represent newlines, which was done by first issuing a carriage return (CR) and then a line-feed (LF). UNIX chose ASCII LF (hexadecimal 0A) to do both at the same time, Macintosh chose CR and MS-DOS both. Unfortunately, in the BS-DEL case, Linux ended up with two possibilities.</p>
<p>The essential point in this issue is to go for one way consistently. This page describes a way to consistently use DEL to erase the previous character, the page called&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboardprev.html">The Alternative Way</a>&nbsp;describes a way to consistently use BS. On the latter page there are some tips which may be useful regardless of what approach you take.</p>
<p>Since starting this page in 1997, most distributions have sorted out the issue. Still, some of the fixes/workarounds can be useful when working in a mixed environment, or when working on older systems. And evidently, given the number of hits the page still gets, it's a situation common to more then a few people ;-)</p>
<p>If you miss an application on this page, it's either because the keys are ok in the application ("If it ain't broken, don't fix it"), or because I don't know about it. In either case, don't hesitate to mail me about it.</p>
<div class="c3">
<h2><a name="term">Terminology</a></h2>
</div>
<p>Throughout this document, [&lt;---] and [Delete] are used to denote the physical keys on the keyboard, the things you actually press to erase characters. There are a few things to keep in mind: ASCII values can be represented in several equivalent ways. This means that ASCII BS is equivalent to 010 in octal, 8 in decimal and 08 in hexadecimal notation. To show that a number is in hexadecimal notation '0x' is put in front of it. Finally it should be noted that BS and DEL are known to applications by their corresponding control sequences. To sum it up:</p>
<div class="c3">
<table border="0">
<tbody>
<tr>
<th>Note:</th>
</tr>
<tr>
<td><strong>ASCII BS == 0x08 == ^H</strong></td>
</tr>
<tr>
<td><strong>ASCII DEL == 0x7f == 0177 == ^?</strong></td>
</tr>
</tbody>
</table>
</div>
<hr />
<div class="c3">
<h2><a name="prob">The problem:</a></h2>
</div>
<p>The reason the keys (generally) do not work out-of-the-box is partly lack of configuration (as you will see later, simply creating&nbsp;<code>.inputrc/.cshrc</code>&nbsp;already helps a lot) and a more difficult issue which I will try to describe below.</p>
<p>The linux console emulates a vt220 terminal which has the following key-mapping:</p>
<pre><a name="vt220">Linux console/VT220</a>
Key            KeySymName       Console characters
  --------------------------------------------------
  Ctrl+H   ---&gt;  Control_H  ---&gt;  ASCII  BS (0x08)
  [&lt;---]   ---&gt;  Backspace  ---&gt;  ASCII DEL (0x7f)
  [Delete] ---&gt;  Delete     ---&gt;  "/e[3~"
</pre>
<p>Note 1: BS (0x08) is equivalent to ^H, which is left to be used by applications (e.g. for help menus in emacs, but it could be anything). DEL is equivalent to ^?, or 0177 (octal) and 0x7f (hex) and "/e[3~" will show up in your xterm (using the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#trick">^v-trick</a>) as ^[[3~. Xterms on the other hand, emulate the vt100 terminal, which didn't have a [Delete]. It did have a [&lt;---] which generated ASCII BS (but it was in an awkward position and did not serve as rubout).</p>
<pre>VT100
--
Key            KeySymName       Console characters
  --------------------------------------------------
  Ctrl+H   ---&gt;  Control_H  ---&gt;  ASCII  BS (0x08)
  [&lt;---]   ---&gt;  Backspace  ---&gt;  ASCII DEL (0x7F)
</pre>
<p>Now here's how xterm emulates the VT100 terminal:</p>
<pre><a name="vt100">Xterm's emulation of VT100</a>
Key            KeySymName       Console characters
  --------------------------------------------------
  Ctrl+H   ---&gt;  Control_H  ---&gt;  ASCII  BS (0x08)
  [&lt;---]   ---&gt;  Backspace  ---&gt;  ASCII BS (0x08)
  [Delete] ---&gt;  Delete     ---&gt;  ASCII DEL (0x7F)
</pre>
<p>It may be clear that by default the keys are mapped differently on the console and in xterm. This would be ok if it weren't for the fact that while on the console ^H is free to be used by applications, in an xterm it is not (instead it's mapped to the [&lt;---] key). Differences between terminal types are generally dealt with by the terminfo database (see below), mapping terminal specific strings to the correct key. However, in this case, the ^H should&nbsp;<strong>not</strong>&nbsp;be mapped. Terminfo is not enough, the settings of the terminal (xterm) have to be modified such that ^H is not used.</p>
<p>In&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboardprev.html">my previous attempt</a>&nbsp;at working around the problem, I put most of my effort in trying to map all keys to suit xterm's vt100 emulation. However, I now propose another way to deal with the problem. This basically means getting xterm to work with the consoles' default settings: [&lt;---] will do ASCII DEL (0x7F, or ^?), and [Delete] will do "/e[3~". This way ^H is not used for any terminal specific functions, it can be used by applications.</p>
<div class="c3">
<h2><a name="sol">Solution (work-arounds)</a></h2>
</div>
<p>There is no clear solution, but there are some pretty good work-arounds. What is needed is to tell&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Xterm">xterm</a>&nbsp;how to handle the keys, and then to tell other applications about it (i.e. how xterm handles the keys). The terminfo database contains descriptions of how all kinds of terminals handle (terminal specific) keys. Applications look at the TERM variable, and then search the corresponding database for the value of a certain key, e.g. the left-arrow key, and find the string that corresponds to it. This means that the strings in the database had better correspond to your current xterm settings. This involves modifying xterm's terminfo entry.</p>
<p>When you change the keymapping on your own system, you may have problems when accessing other systems. Luckily, this can be worked-around by a script which changes the input it receives to the output that is expected by the application (telnet, rlogin). See the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#other">telnet</a>&nbsp;section.</p>
<div class="c3">
<h2><a name="overview">Overview</a></h2>
</div>
<p>This table summarizes the modifications needed in the different environments, and the tools it is done with:</p>
<div class="c3">
<table border="1">
<tbody>
<tr>
<td rowspan="2">
<div class="c4">Environment&nbsp;&nbsp;&nbsp;&nbsp;</div>
</td>
<td colspan="2">
<div class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configuration files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
</td>
<td rowspan="2">
<div class="c4">Configuration&nbsp;</div>
</td>
</tr>
<tr>
<td>
<div class="c4">user&nbsp;&nbsp;&nbsp;</div>
</td>
<td>
<div class="c4">&nbsp;systemwide&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#terminfo">Terminfo</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><code>&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></td>
<td><code>&nbsp;&nbsp;&nbsp;terminfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></td>
<td><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infocmp/tic&nbsp;&nbsp;&nbsp;</code></td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Xterm">Xterm</a>&nbsp;</td>
<td><code>~/.Xdefaults (*)</code></td>
<td><code>&nbsp;/etc/X11/Xresources&nbsp;</code></td>
<td><code>xrdb ~/.Xdefaults&nbsp;(*)</code></td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#X">X</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><code>&nbsp;-&nbsp;&nbsp;</code></td>
<td><code>/etc/X11/xinit/.Xmodmap (**)</code>&nbsp;&nbsp;</td>
<td><code>xmodmap .Xmodmap</code>&nbsp;&nbsp;</td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Bash">Bash</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><code>~/.inputrc</code>&nbsp;&nbsp;&nbsp;</td>
<td><code>/etc/inputrc&nbsp;&nbsp;&nbsp;</code></td>
<td><code>export INPUTRC=/etc/inputrc</code>&nbsp;&nbsp;</td>
</tr>
<tr>
<td><a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Tcsh">Tcsh</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><code>~/.cshrc</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td><code>/etc/cshrc</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;<code>bindkey (shellcommand)</code>&nbsp;&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p>* or&nbsp;<code>.Xresources</code><br />**&nbsp;<code>/etc/X11/XF86Config</code>&nbsp;also affects the keyboard settings under X</p>
<hr />
<div class="c3">
<h2><a name="terminfo">Terminfo</a></h2>
</div>
<p>This is often a problem. When you find that the keys are fine in e.g. vi on the console, but not in an xterm (or vice versa, or both) it means that your xterm-settings do not correspond to the settings listed in the terminfo database. I am not really comfortable with telling you to fiddle with terminfo, please be careful, make backups! If you run the tic command on the modified de-compiled terminfo entry as root, your system's terminfo database will be modified automagically. Put the original file in a save place so you can run tic on it and restore the original state. Read the manpage. First try it as non-privileged user. You can start with testing a modified xterminfo file (see below) as explained, however, since these are likely to differ from your system's entry at other points, it's probably better to modify your own instead. At any rate, first find out whether the terminfo entry for xterm is in accordance with your xterm settings:</p>
<pre><code>infocmp | grep kbs</code>
</pre>
<p>should return a line which includes&nbsp;<code>kbs=/177</code>. This means DEL (or ^?) is mapped to the backspace key, which is what we want.</p>
<pre><code>infocmp | grep kdch1</code>
</pre>
<p>should return a line with&nbsp;<code>kdch1=/E[3~</code>. This means that /E[3~ is mapped to the delete key. Often you will find kbs=^H and/or kdch1=/177, or there will be no kdch1 at all. You can either edit the terminfo entry as described on the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/troubleshooting.html#termcap">Troubleshooting-page</a>&nbsp;(simply setting or adding&nbsp;<code>kdch1=/E[3~</code>&nbsp;and&nbsp;<code>kbs=/177</code>, but make a backup first!). Put the file in&nbsp;<code>~/.terminfo/x/xterm</code>&nbsp;(for testing purposes) and do for bash:</p>
<pre><code>export TERMINFO=~/.terminfo</code>
</pre>
<p>and/or for tcsh:</p>
<pre><code>setenv TERMINFO ~/.terminfo</code>
</pre>
<p>Make sure that the TERM variable is set to xterm:</p>
<pre><code>echo $TERM</code>
</pre>
<p>should return "xterm". If it works as intended (do 'toe' to check whether the terminfo dir you specified is indeed used, toe will return a list of available terminfo types, only xterm in this case), you can run tic as root, which will copy the file to</p>
<pre><code>/etc/terminfo/x/xterm</code>
</pre>
<p>(<a href="http://www.debian.org/">debian</a>) or</p>
<pre><code>/usr/lib/terminfo/x/xterm</code>
</pre>
<p>(<a href="http://www.redhat.com/">redhat</a>,&nbsp;<a href="http://www.cdrom.com/">slackware</a>). Make backups first, and test it before you replace any files!</p>
<hr />
<div class="c3">
<h2><a name="Xterm">Xterm</a></h2>
</div>
<p>The xterm (and friends) only needs little configuration. In the&nbsp;<code>/etc/X11/Xresources</code>&nbsp;or&nbsp;<code>~/.Xdefaults</code>&nbsp;(or wherever it's merged with the other xresources) add the line:</p>
<pre><code>*VT100.Translations: #override /
              &lt;Key&gt;BackSpace: string(0x7F)/n/
              &lt;Key&gt;Delete:    string("/033[3~")/n/
              &lt;Key&gt;Home:      string("/033[1~")/n/
              &lt;Key&gt;End:       string("/033[4~")
*ttyModes: erase ^? 
</code>
</pre>
<p>Rxvt only uses&nbsp;<code>Xresources</code>&nbsp;if it is compiled with this option. Since rxvt uses readline, to get home and end to work you will have to edit&nbsp;<code>.inputrc</code>, see the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Bash">Bash</a>&nbsp;section).&nbsp;<a href="http://www.redhat.com/"><span class="goog_qs-tidbit goog_qs-tidbit-0 goog_qs-tidbit-hilite">Redhat</span></a><span class="goog_qs-tidbit goog_qs-tidbit-0 goog_qs-tidbit-hilite">&nbsp;users can pick up the SRPM (source) and compile rxvt themselves</span>&nbsp;with this&nbsp;<a href="http://www.ibb.net/~anne/keyboard/feature.h">feature.h</a>, ensuring the right keybindings.</p>
<p>Putting&nbsp;<code>xterm</code>&nbsp;or&nbsp;<code>nxterm</code>&nbsp;in front of&nbsp;<code>*vt100.translations</code>&nbsp;makes the settings specific for xterm or nxterm. Sometimes this does not seem to work properly, in that case try using both<code>nxterm*VT100.Translations</code>&nbsp;and&nbsp;<code>xterm*VT100.Translations</code>.</p>
<p><a name="trick">BTW, have I told you that&nbsp;<code>Ctrl-v &lt;key&gt;</code>&nbsp;will tell you what sequence is sent to the shell? Try&nbsp;<code>Ctrl-v [Delete]</code>, it should give a&nbsp;<code>^[[3~</code>&nbsp;in your xterm or console (try it with [ESC] and you'll find ^[, which corresponds to /e for readline apps, and /033 for Xresources).</a></p>
<p>1. The syntax of the&nbsp;<code>Xresources</code>&nbsp;files is very strict, make sure you don't leave blank spaces after the backslash on each line. Also watch the newline (<code>/n/</code>) sequences, there shouldn't be one at the last line of an entry.<br />2. The sections are named, if you only use&nbsp;<code>*VT100.Translations</code>&nbsp;it will work for all xterm and friends.<br />3. For info about&nbsp;<code>Xresources</code>&nbsp;and other X related stuff refer to&nbsp;<a href="http://www.ibb.net/~anne/keyboard/X.html"><code>'man X'</code></a>.</p>
<hr />
<div class="c3">
<h2><a name="X">X</a></h2>
</div>
<p>If you use&nbsp;<a href="http://www.xfree86.org/">XFree86</a>, make sure you have enable the XKB extensions in&nbsp;<code>/etc/X11/XF86Config</code>. It is enable by default, so it should be okay. Note the different keyboard layout-options. Now XFree86 will translate the console mapping, and everything should work in X. If you have problems, or want to fiddle with additional characters and things, create an&nbsp;<code>Xmodmap</code>. Also if you want the keyboard to generate special characters in X,&nbsp;<code>xmodmap</code>&nbsp;can also be used to configure the function-keys. This is adequately described in the manual page (<code>'man xmodmap'</code>. Make sure that the following lines are included in your<code>Xmodmap</code>:</p>
<p><code>keycode 22 = BackSpace</code><br /><code>keycode 107 = Delete</code></p>
<p>Note that the keycodes in X are&nbsp;<strong>not</strong>&nbsp;the same as in a VT. Use&nbsp;<code>showkey</code>&nbsp;to see the keycodes generated by the keyboard in a VT, and&nbsp;<code>xev</code>&nbsp;in X. There is an excellent graphical front end for X-keyboard configuration:&nbsp;<code>xkeycaps</code>. Refer to the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#netscape">Netscape section</a>.</p>
<p>Another way of generating special characters in X (without using&nbsp;<code>xmodmap</code>) is by defining a Compose-key (for use as a "dead key") in&nbsp;<code>XF86Config</code>&nbsp;in the Keyboard section:</p>
<pre><code>  RightCtl        Compose
</code>
</pre>
<p>Now you have a compose-key with the same properties as the one described in the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboardprev#VT">VT</a>&nbsp;section. Remember to set the environment variable&nbsp;<code>LC_CTYPE=iso-8859-1</code>&nbsp;(see&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboardprev.html#VTopt">VT optional...</a>). Consult&nbsp;<a href="http://www.ibb.net/~anne/keyboard/XF86Config.man.html"><code>'man XF86Config'</code></a>&nbsp;if you want to know more.&nbsp;<strong>Note</strong>: this doesn't seem work rxvt.<br />Alternatively, owners of a windows keyboard (one with extra buttons, it need not be a M$ natural keyboard) can enable the&nbsp;<code>XKEYBOARD</code>&nbsp;extension (enabled per default) in&nbsp;<code>XF86Config</code>&nbsp;and uncomment the line (follow the instructions in the file):</p>
<pre><code>  XkbModel    "microsoft" 
</code>
</pre>
<p>Now you can use the button with the windows flag on it to produce a great number of exotic characters, just press it in combination with e.g. a, producing &aacute; (a clear disadvantage is that there is no logic in the location of the special characters at all...).</p>
<p>Yet another way to use "dead keys" in X is by installing a modified version of libX11 which includes support for dead keys (transparent for all apps). First, get the modified version of libX11 (make sure you get the right version, if you use glibc replace both libX11, ELF-libc5 and ELF-libc6). Now, deactivate the XKB extension of XFree86 (edit&nbsp;<code>XF86Config</code>&nbsp;and run xmodmap on a Xmodmap file with dead keys like dead_acute, dead_grave, dead_cedilla, dead_ogonek and a Multi_keys one too.</p>
<p>A special case is if you use xdm, you need to deactivate XKB from the&nbsp;<code>/etc/X11/xdm/Xservers</code>&nbsp;file, passing a -kb parameter to the server like this:</p>
<pre><code>:0 local /usr/X11R6/bin/X -kb
</code>
</pre>
<p>then in&nbsp;<code>/etc/X11/xdm/Xsetup_0</code>&nbsp;file add a line to load the Xmodmap, like this:</p>
<pre><code>if [ -r /etc/X11/xinit/.Xmodmap ]; then
        /usr/X11R6/bin/xmodmap /etc/X11/xinit/.Xmodmap
fi
</code>
</pre>
<p>Now chars accesible by AltGr, dead keys or compose are usable in xdm too.</p>
<h4>More Composing Talk</h4>
<p>A problem common to all compose schemes is that while some composing systems make more sense than others, none of them make all of the iso_8859_1 characters readily accessible, simply because it is impossible to remember the combinations for all characters. So instead of, or in addition to getting special libraries, it is often desirable to simply have a list of characters you can copy from, a poor man's iso_8859_1 table so to speak. Just grab you favorite editor, open a file called iso_8859_1 (or any other name, but check the name and path) and put in all iso_8859_1 characters. Wait, here they are (you may want to create a different order):</p>
<pre><code>&iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &shy; &reg; &macr; &deg; &plusmn; &amp;sup2; &amp;sup3; &acute; &micro; &para; &middot; &cedil; &amp;sup1; &ordm; &raquo; &amp;frac14; &amp;frac12; &amp;frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil;
&Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc;
&iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; 
</code>
</pre>
<p>Now you need a way to display them (millions of options here, I bet you can do all kinds of crazy things with fonts, colors, pixmaps, borders...). The script assumes the file with the characters is in<code>/usr/local/lib</code>.</p>
<pre><code> 

#!/bin/bash 
export LESSCHARSET=latin1 
exec xterm -T Iso_8859_1-TABLE -geometry 77x4 +sb -bg SteelBlue -fg white /
-fn lucidasanstypewriter-bold-12 -e less /usr/local/lib/iso_8859_1

</code>
</pre>
<p>Refer to the manual page of iso_8859_1. If you do 'man iso_8859_1' but you don't see any special characters, edit&nbsp;<code>/etc/man.config</code>, and change the following line:</p>
<pre><code>NROFF         /usr/bin/groff -Tascii -mandoc
</code>
</pre>
<p>to:</p>
<pre><code>NROFF         /usr/bin/groff -Tlatin1 -mandoc
</code>
</pre>
<p>Now try 'man -c iso_8859_1' (the -c option is to make sure man does not use an old cat file).</p>
<hr />
<div class="c3">
<h2><a name="Bash">Bash</a></h2>
</div>
<p>Create a file,&nbsp;<code>/etc/inputrc</code>&nbsp;for system wide use or&nbsp;<code>~/.inputrc</code>&nbsp;for personal use. Actually, this is the readline initialization file, readline is a library that some programs (bash, kvt) use to read input (try&nbsp;<code>bind -v</code>&nbsp;to see a list of readline key and function bindings). Cut and paste the following in the file to make the Delete key delete characters under the cursor, and make Home and End work as well:</p>
<pre><code>"/e[3~": delete-char
# this is actually equivalent to "/C-?": delete-char
# VT
"/e[1~": beginning-of-line
"/e[4~": end-of-line
# kvt
"/e[H":beginning-of-line
"/e[F":end-of-line
# rxvt and konsole (i.e. the KDE-app...)
"/e[7~":beginning-of-line
"/e[8~":end-of-line
</code>
</pre>
<p>If a system-wide&nbsp;<code>/etc/inputrc</code>&nbsp;was created, add the following line to&nbsp;<code>/etc/profile</code>:</p>
<pre><code>export INPUTRC=/etc/inputrc</code>
</pre>
<p>Make sure that the stty erase character is set to&nbsp;<code>^?</code>. Type</p>
<pre><code>stty -a | grep erase</code>
</pre>
<p>and check if it says</p>
<pre><code>erase = ^?;</code>
</pre>
<p>If it is set to something else (e.g.&nbsp;<code>^H</code>) then put the following line in both&nbsp;<code>.bashrc</code>&nbsp;and in either&nbsp;<code>.bash_profile</code>&nbsp;or&nbsp;<code>/etc/profile</code>:</p>
<pre><code>  if tty --quiet ; then
    stty erase '^?'
  fi
</code>
</pre>
<p>and for xterm and rxvt add this to&nbsp;<code>.Xdefaults</code>:</p>
<pre><code>*ttyModes: erase ^?
</code>            
</pre>
<p>If you create&nbsp;<code>/etc/inputrc</code>, note that Bash will ignore&nbsp;<code>~/.inputrc</code>&nbsp;(currently this happens in all distributions except Debian, however, this might change in the future). As an alternative, you can edit<code>~/.inputrc</code>, and copy this to&nbsp;<code>/etc/skel/</code>, so it's in the home directories of all new users.<br />Push the key-combination '<code>Ctrl-x-r</code>' (push the control-key, the x-key. release it, push the r-key, release it, and then release the control-key) to see if the changes in&nbsp;<code>inputrc</code>&nbsp;take effect. Or just login again, and it will work.</p>
<p>You can also change the keybindings on the fly with the&nbsp;<code>bind</code>&nbsp;command, e.g:</p>
<pre>[localhost]&gt; bind "/C-?": backward-delete-char
</pre>
<p>This is useful to test different keybindings, if they work you can put them in&nbsp;<code>~/.inputrc</code>. Read all about it in the readline manpage.</p>
<p>People using keymaps with e.g. Scandinavian characters who would like bash to display these characters (&oslash;l;-) have to add the following lines in&nbsp;<code>.inputrc</code>:<br /><code>set convert-meta off</code><br /><code>set output-meta on</code><br /><code>set input-meta on</code></p>
<p>For more info, check the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/Danish-HOWTO.gz"><code>Danish-HOWTO</code></a>.</p>
<hr />
<div class="c3">
<h2><a name="Tcsh">Tcsh</a></h2>
</div>
<p>If you use the tcsh shell, put the following lines in your&nbsp;<code>/etc/cshrc</code>&nbsp;or your personal&nbsp;<code>~/.cshrc file:</code></p>
<pre><code>#.cshrc
 if ($term == "xterm" || $term == "vt100" /
            || $term == "vt102" || $term !~ "con*") then
          # bind keypad keys for console, vt100, vt102, xterm
          bindkey "/e[1~" beginning-of-line  # Home
          bindkey "/e[7~" beginning-of-line  # Home rxvt
          bindkey "/e[2~" overwrite-mode     # Ins
          bindkey "/e[3~" delete-char        # Delete
          bindkey "/e[4~" end-of-line        # End
          bindkey "/e[8~" end-of-line        # End rxvt
      endif
 </code>
</pre>
<p>To see whether it works or not, type:</p>
<p><code>[localhost]&gt; source .cshrc</code></p>
<hr />
<hr />
<div class="c3">
<h2><a name="athena">Athena Applications</a></h2>
</div>
<p>For programs using the Athena widgets (xpaint, xbmbrowser, xman, xmh, xedit, pixmap, bitmap, editres...) put the following in&nbsp;<code>.Xdefaults</code>&nbsp;to get Delete to work:</p>
<pre><code>*Text.translations:    #override / 
    ~Shift ~Meta &lt;Key&gt;Delete: delete-next-character()
</code>
</pre>
<div class="c3">
<h2><a name="emacs">Emacs</a></h2>
</div>
<p>In emacs, [&lt;---] and [Delete] are by default configured to both erase the character on the left of the cursor. To change this, you can either edit the file&nbsp;<code>x-win.el</code>&nbsp;in the emacs root directory, and find the following:</p>
<pre><code>
;; Map certain keypad keys into ASCII characters
;; that people usually expect.
(define-key function-key-map [backspace] [127])
(define-key function-key-map [delete] [127])

</code>
</pre>
<p>and change the last line to</p>
<pre><code>(define-key function-key-map [delete] [deletechar])

</code>
</pre>
<p>Alternatively you can add</p>
<pre><code>(define-key function-key-map [delete] [deletechar])

</code>
</pre>
<p>to your ~/.emacs file. On a related note, by default in emacs the HOME key brings you to the beginning of the buffer (i.e. top of the document). Likewise the END key brings you to the end of the buffer. Adding the lines</p>
<pre><code>
(define-key global-map [home] `beginning-of-line)
(define-key global-map [end] `end-of-line)
</code>
</pre>
<p>to your&nbsp;<code>~/.emacs</code>&nbsp;make these keys move you to the beginning and end of the current line. Note that the M-&lt; and M-&gt; keybindings remain untouched and can still be used to go to the beginning and end of the buffer.</p>
<div class="c3">
<h2><a name="joe">Joe</a></h2>
</div>
<p>First find the file joerc. It is most likely&nbsp;<code>/usr/lib/joe/joerc</code>, but sometimes&nbsp;<code>/etc/joerc</code>, or maybe even&nbsp;<code>/usr/local/lib/joerc</code>. Try&nbsp;<code>'locate joerc'</code>&nbsp;if you can't find the file. Make a backup for safety, or copy it to .joerc in your home directory, and change/add the following lines in the section "Standard JOE user interface" in joerc:</p>
<pre><code>bol              ^[ [ H          # Standard xterm escape seq.
bol              ^[ [ 1 ~        # Standard VT escape seq.
bol              ^[ [ 7 ~        # rxvt
eol              ^[ [ F          # Standard xterm escape seq.
eol              ^[ [ 4 ~        # Standard VT escape seq.
eol              ^[ [ 8 ~        # rxvt
</code>
</pre>
<p><strong>Note</strong>&nbsp;that you first have to make sure that Home and End work in an&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#Xterm">xterm</a>. Check out&nbsp;<a href="http://www.ibb.net/~anne/keyboard/joe.html"><code>'man joe'</code></a>. BTW, these modifications apply to&nbsp;<code>jpicorc</code>,&nbsp;<code>jstarrc</code>&nbsp;and&nbsp;<code>jmacsrc</code>&nbsp;as well.</p>
<div class="c3">
<h2><a name="kde">KDE</a></h2>
</div>
<p><a href="http://www.kde.org/">KDE</a>&nbsp;provides a new alternative to kvt called konsole. To get the home/end keys to work in konsole you have to put:</p>
<pre> 
<code>"/e[H":beginning-of-line
"/e[F":end-of-line
</code>
</pre>
<p>in&nbsp;<code>.inputrc</code>. Additionally, make sure that you have checked the '<code>BS sends DEL</code>' checkbox (right mouse click, or through the 'Options' pulldown menu). In kvt,&nbsp;<a href="http://www.kde.org/">KDE's</a>&nbsp;home and end can be configured by editing&nbsp;<code>~/.inputrc</code>&nbsp;(<code>tcsh</code>&nbsp;users too, it uses readline):</p>
<pre> 
<code>"/e[H":beginning-of-line
"/e[F":end-of-line
</code>
</pre>
<div class="c3">
<h2><a name="less">Less</a></h2>
</div>
<p>Less is ok on some systems. If it is not on yours, try the following. Create a file,&nbsp;<code>/etc/lesskey</code>, for system-wide use. This will be a&nbsp;<code>lesskey</code>&nbsp;input file. Put the following lines in the file:</p>
<pre><code>#line-edit
/e[3~          delete
/e[1~          home
/e[4~          end
</code>
</pre>
<p>Save the file, and compile it as follows:</p>
<pre><code>[localhost]&gt; lesskey -o /etc/less /etc/lesskey</code>
</pre>
<p>Add the following line to /etc/profile:</p>
<pre><code>export LESS="-MM -k/etc/less"</code>
</pre>
<p>Now type:</p>
<p><code>[localhost]&gt; . /etc/profile</code></p>
<p>By fiddling with these settings you should be able to get less to accept (all of) the holy keycodes, at least, it works on my computer. For some exciting reading, check&nbsp;<a href="http://www.ibb.net/~anne/keyboard/lesskey.html"><code>'man lesskey'</code></a>.</p>
<div class="c3">
<h2><a name="nedit">Nedit</a></h2>
</div>
<p>Put the following in&nbsp;<code>~/.Xdefaults</code>:</p>
<pre><code> nedit.remapDeleteKey: False</code>
</pre>
<p>Save the file, and the next time you start&nbsp;<a href="http://www-pat.fnal.gov/nirvana/nedit.html">nedit</a>&nbsp;the Delete key will do what we want it to: delete under the cursor. Note: you can also put the line in&nbsp;<code>~/.nedit</code>, but every time you save the default settings, the<code>.nedit</code>&nbsp;file will be overwritten, and you'll have to (n)edit it again.</p>
<p>Note the nedit, as e.g. netscape, is a motif application. This means that it uses the XKeysymDB, see thet netscape section.</p>
<div class="c3">
<h2><a name="netscape">Netscape</a></h2>
</div>
<p>The keys should be ok, as long as the XKeysymDB is installed in one of the places where netscape looks (where netscape itself is installed, or&nbsp;<code>/usr/X11R6/lib/X11/</code>). XKeysymDB is similar to an xmodmap file, but with a very cryptic and poorly documented syntax. Luckily, it does do the delete/backspace thing right, so no sweat.</p>
<p>If you use xmodmap, you may want to check out the graphical front end for X-keyboard configuration:&nbsp;<code>xkeycaps</code>. Get the .rpm at&nbsp;<a href="ftp://ftp.redhat.com/pub/redhat/">RedHat Powertools</a>, or get the&nbsp;<a href="http://www.debian.org/Packages/stable/x11/xkeycaps.html">Debian-package</a>&nbsp;(or plain tarball). It's a nice tool. You can also look for a default Xmodmap file on your system. At any rate, make sure that the following is in the file:</p>
<p><code>keycode 22 = BackSpace<br />keycode 107 = Delete</code></p>
<p>alternatively, you can put it in e.g. your .Xclients file, or in&nbsp;<code>/etc/X11/xdm/Xsetup_0</code>):</p>
<pre><code># map the [&lt;---] key to the [BackSpace] keysym.
xmodmap -e "keycode 22 = BackSpace"
# map the [Delete] key to the [Delete] keysym.
xmodmap -e "keycode 107 = Delete"
</code>
</pre>
<div class="c3">
<h2><a name="pico">Pico and Pine</a></h2>
</div>
<p>I found that while the keys worked in a VT, in xterms only backspace works. This was caused by the&nbsp;<code>.Xdefaults</code>&nbsp;modifications. If you use the&nbsp;<code>~/.inputrc</code>&nbsp;to get Delete to work in xterms (and then pico and pine will be able to use Delete), however, this creates problems with other apps (e.g. joe) which cannot be easily solved because joe relies on the&nbsp;<code>.Xdefaults</code>&nbsp;modifications to get the keys right. Anyway, it turns out that&nbsp;<a href="http://www.washington.edu/pine/">pine</a>&nbsp;and pico are simply broken, as the workaround will clearly demonstrate. Admittedly broken is a relative thing in all this keyboard-confusion: from the other method's perspective they are perfectly ok. One thing is for sure, these two apps are exceptions. Try the following: make an expect script (let's call it picofix):</p>
<pre><code>#!/usr/bin/expect

eval spawn -noecho $argv

interact {
 /177        {send "/010"}
 "/033/[3~"  {send "/004"}
}
</code>
</pre>
<p>Make picofix executable, and start the editor (or pine) with</p>
<pre><code>picofix pico</code>
</pre>
<p>and it will work (then you can make an alias or a wrapper). Thanks to Philip Hands for this ingenious (and powerful!) workaround. You can also use an alternate editor. Edit&nbsp;<code>.pinerc</code>&nbsp;and find the following lines:</p>
<p><code># Specifies the program invoked by ^_ in the Composer,<br /># or the "enable-alternate-editor-implicitly" feature.<br />editor=</code></p>
<p>You can enter the command for any editor here, e.g.&nbsp;<code>joe</code>&nbsp;or&nbsp;<code>vi</code>.</p>
<p>If you want the editor to be started right away, start&nbsp;<code>pine</code>, enter&nbsp;<code>SETUP</code>&nbsp;and&nbsp;<code>Config</code>&nbsp;and select the&nbsp;<code>enable-alternate-editor-implicitly</code>&nbsp;option. Now the editor of choice will be started automagically when you start writing a message.</p>
<p>Pico fans may want to try jpico, which is basically joe with pico keybindings (and all the extra's joe offers). Others my be even smarter and switch to&nbsp;<a href="http://www.vim.org/">vim</a>&nbsp;and&nbsp;<a href="http://www.mutt.org/">mutt</a>. Note that the first can be taught to do the<code>Ctrl-j</code>-trick, the latter can use pine keybindings.</p>
<div class="c3">
<h2><a name="vim">Vim</a></h2>
</div>
<p>Vim uses&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#terminfo">terminfo</a>, so the keys should be ok if your terminfo is. However, if it is not, you can still get the keys to work in vim. Type&nbsp;<code>:help fixdel</code>&nbsp;in vim and read all about it.</p>
<div class="c3">
<h2><a name="mutt">Mutt</a></h2>
</div>
<p>Put the following line in&nbsp;<code>~/.muttrc</code>:</p>
<pre>bind editor &lt;delete&gt; delete-char
</pre>
<p>This will make [Delete] do its job in&nbsp;<a href="http://www.mutt.org/">mutt's</a>&nbsp;internal pager.</p>
<div class="c3">
<h2><a name="other">Telnet</a></h2>
</div>
<p>If you have modified&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#terminfo">terminfo</a>&nbsp;and you are e.g. telnetting to a machine with a default terminfo (for xterm usually), you can use the following script (let's call it kbdfix) to change the keysequences you generate to the ones the program expects:</p>
<pre><code>#!/usr/bin/expect

eval spawn -noecho $argv

interact {
 /177        {send "/010"}
 "/033/[3~"  {send "/177"}
}
</code>
</pre>
<p>If you press [&lt;---], expect will receive /177 (equivalent to 0x7F and ^?, see the&nbsp;<a href="http://www.ibb.net/~anne/keyboard/keyboard.html#vt220">VT220 table</a>) and it will send /010 (equivalent to ^H) along to telnet, which will result in [&lt;---] at the other end. Make it executable and use&nbsp;<code>kbdfix telnet brokenhost</code>. Thanks to Philip Hands for this clever workaround.</p>
<p>The logical next step is to automate the trick. Create a file,&nbsp;<code>/etc/broken-backspace-hosts</code>&nbsp;(or a shorter name...). In this file, list the hosts which expect ^H and ^? instead of ^? and ^[[3~. Now you can make a wrapper for telnet as shown below. This particular script assumes that the telnet binary has been renamed telnet.orig, and that the kbdfix script described in the previous section is somewhere in your path):</p>
<pre><code>
#!/bin/sh

if [ "$#" -ge 1 ]; then
        if grep -wq "$@" /etc/broken-backspace-hosts ; then
                exec kbdfix telnet.orig "$@"
        else
                exec telnet.orig "$@"
        fi
else
        exec telnet.orig
fi

</code>
</pre>
<p>From now on, when you use telnet, the script will check whether the host you are telnetting to is considered broken (listed in the /etc/broken-backspace-hosts file). If it is, the expect script (kbdfix) will be used, if not, telnet will be started directly. Without arguments the original telnet executable will run (thanks to Jason Bonser for this addition). You can do the same for rlogin, although rlogin can't be moved (i.e. won't work when it isn't called rlogin).</p>
<hr />
<div class="c3">
<h2><a name="ref">References</a></h2>
</div>
<ul>
<li>The Linux Keyboard and Console HOWTO</li>
<li>Linux Keyboard Setup Mini-Howto</li>
<li>Consistent Keyboard Configuration' article (<a href="http://www.ssc.com/lj/">LJ</a>&nbsp;issue #38, June 97)</li>
<li><code>Danish-HOWTO</code></li>
<li><code><a href="http://www.cnr.berkeley.edu/~casterln/tcsh">Tcsh documentation</a></code></li>
<li>Fixkeys Mini Howto</li>
<li><code>Bash</code>&nbsp;documentation</li>
<li><code>'man showkey'</code></li>
<li><code>'man X'</code></li>
<li><code>'man XF86Config'</code></li>
<li><code>'man lesskey'</code></li>
<li><code>'man joe'</code></li>
<li>Dead keys under X11</li>
</ul>
<hr />
<p>This document was put together by Anne Baretta&nbsp;<em>(anne (at) ibb.net)</em>. Please mail me if you find mistakes, tY-pO's, alternative or plain better solutions. A few people have already pointed out many mistakes (there simply cannot be that many left...), which improved the document a lot.&nbsp;I would like to thank all the people who contributed to the page, and Thomas Telkamp for hosting the site.</p>
<div class="c3"><a href="http://www.nedstat.nl/cgi-bin/viewstat?name=keyboardtel"><img src="http://www.nedstat.nl/cgi-bin/nedstat.gif?name=keyboardtel" border="0" alt="page statistics" width="16" height="16" /></a></div>
<div class="c3">
<address class="c5">This page is maintained by Anne Baretta.&nbsp;<br />Last updated 11/18/2008 13:08:02</address>
</div>
<p>&nbsp;</p>

	</div>
	</div>
    
	
	<!-- Pagination links -->
	
	<ul class="pager">
	    
	    <li class="previous"><a href="/page10">&larr; Older</a></li>
	    
	
	    
	    <li class="next"><a href="/page8">Newer &rarr;</a></li>
	    
	</ul>
	
	<!-- content -->
</div>

<div class="col-lg-4">
		<div class="well">
            <h4>Links</h4>
            <a href="https://www.facebook.com/bo.yang.52493" target="_blank"> <i class="fa fa-facebook-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://www.linkedin.com/pub/bo-yang/21/a3/893" target="_blank"> <i class="fa fa-linkedin-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://github.com/bo-yang" target="_blank"> <i class="fa fa-github fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://plus.google.com/" target="_blank"> <i class="fa fa-google-plus-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="http://www.weibo.com/bonnyang" target="_blank"> <i class="fa fa-weibo fa-3x"></i> </a> &nbsp;&nbsp;
        	<a href="/atom.xml" target="_blank"> <i class="fa fa-rss-square fa-3x"></i> </a>	
        </div>
        <!-- /well -->
        <div class="well">
			<h4>Tags</h4>
			<div class="tag_box">
		    	
				
  
    
        <a href="/tags.html#MFC-ref" class="btn btn-mini">MFC <span class="badge">10</span></a>
    
        <a href="/tags.html#Algorithm-ref" class="btn btn-mini">Algorithm <span class="badge">23</span></a>
    
        <a href="/tags.html#C-ref" class="btn btn-mini">C <span class="badge">16</span></a>
    
        <a href="/tags.html#EMC-ref" class="btn btn-mini">EMC <span class="badge">9</span></a>
    
        <a href="/tags.html#fault diagnosis-ref" class="btn btn-mini">fault diagnosis <span class="badge">2</span></a>
    
        <a href="/tags.html#EMI-ref" class="btn btn-mini">EMI <span class="badge">1</span></a>
    
        <a href="/tags.html#notes-ref" class="btn btn-mini">notes <span class="badge">3</span></a>
    
        <a href="/tags.html#CBR-ref" class="btn btn-mini">CBR <span class="badge">1</span></a>
    
        <a href="/tags.html#AI-ref" class="btn btn-mini">AI <span class="badge">5</span></a>
    
        <a href="/tags.html#Database-ref" class="btn btn-mini">Database <span class="badge">1</span></a>
    
        <a href="/tags.html#Unix-ref" class="btn btn-mini">Unix <span class="badge">1</span></a>
    
        <a href="/tags.html#Linux-ref" class="btn btn-mini">Linux <span class="badge">1</span></a>
    
        <a href="/tags.html#Personal-ref" class="btn btn-mini">Personal <span class="badge">10</span></a>
    
        <a href="/tags.html#Unix/Linux-ref" class="btn btn-mini">Unix/Linux <span class="badge">93</span></a>
    
        <a href="/tags.html#Telecommunication-ref" class="btn btn-mini">Telecommunication <span class="badge">1</span></a>
    
        <a href="/tags.html#Tcl/Tk-ref" class="btn btn-mini">Tcl/Tk <span class="badge">6</span></a>
    
        <a href="/tags.html#Shell-ref" class="btn btn-mini">Shell <span class="badge">12</span></a>
    
        <a href="/tags.html#Network/Telecom-ref" class="btn btn-mini">Network/Telecom <span class="badge">3</span></a>
    
        <a href="/tags.html#Perl-ref" class="btn btn-mini">Perl <span class="badge">15</span></a>
    
        <a href="/tags.html#Essay-ref" class="btn btn-mini">Essay <span class="badge">12</span></a>
    
        <a href="/tags.html#Industry-ref" class="btn btn-mini">Industry <span class="badge">6</span></a>
    
        <a href="/tags.html#Cloud Computing-ref" class="btn btn-mini">Cloud Computing <span class="badge">2</span></a>
    
        <a href="/tags.html#Android-ref" class="btn btn-mini">Android <span class="badge">2</span></a>
    
        <a href="/tags.html#VBA-ref" class="btn btn-mini">VBA <span class="badge">4</span></a>
    
        <a href="/tags.html#ESXi-ref" class="btn btn-mini">ESXi <span class="badge">1</span></a>
    
        <a href="/tags.html#Virtual Machine-ref" class="btn btn-mini">Virtual Machine <span class="badge">2</span></a>
    
        <a href="/tags.html#Browser-ref" class="btn btn-mini">Browser <span class="badge">2</span></a>
    
        <a href="/tags.html#Plan 9-ref" class="btn btn-mini">Plan 9 <span class="badge">9</span></a>
    
        <a href="/tags.html#Go-ref" class="btn btn-mini">Go <span class="badge">3</span></a>
    
        <a href="/tags.html#Virtualization-ref" class="btn btn-mini">Virtualization <span class="badge">2</span></a>
    
        <a href="/tags.html#C/C++-ref" class="btn btn-mini">C/C++ <span class="badge">23</span></a>
    
        <a href="/tags.html#RHEL6.1-ref" class="btn btn-mini">RHEL6.1 <span class="badge">2</span></a>
    
        <a href="/tags.html#Tips-ref" class="btn btn-mini">Tips <span class="badge">5</span></a>
    
        <a href="/tags.html#CPP-ref" class="btn btn-mini">CPP <span class="badge">1</span></a>
    
        <a href="/tags.html#RPC-ref" class="btn btn-mini">RPC <span class="badge">1</span></a>
    
        <a href="/tags.html#rup-ref" class="btn btn-mini">rup <span class="badge">1</span></a>
    
        <a href="/tags.html#ksh-ref" class="btn btn-mini">ksh <span class="badge">1</span></a>
    
        <a href="/tags.html#Ubuntu-ref" class="btn btn-mini">Ubuntu <span class="badge">1</span></a>
    
        <a href="/tags.html#file descriptor-ref" class="btn btn-mini">file descriptor <span class="badge">1</span></a>
    
        <a href="/tags.html#Expect-ref" class="btn btn-mini">Expect <span class="badge">1</span></a>
    
        <a href="/tags.html#Here Document-ref" class="btn btn-mini">Here Document <span class="badge">1</span></a>
    
        <a href="/tags.html#Evolutionary Computation-ref" class="btn btn-mini">Evolutionary Computation <span class="badge">1</span></a>
    
        <a href="/tags.html#Genetic Algorihtm-ref" class="btn btn-mini">Genetic Algorihtm <span class="badge">1</span></a>
    
        <a href="/tags.html#ldd-ref" class="btn btn-mini">ldd <span class="badge">1</span></a>
    
        <a href="/tags.html#signal-ref" class="btn btn-mini">signal <span class="badge">1</span></a>
    
        <a href="/tags.html#swap-ref" class="btn btn-mini">swap <span class="badge">1</span></a>
    
        <a href="/tags.html#NIC-ref" class="btn btn-mini">NIC <span class="badge">1</span></a>
    
        <a href="/tags.html#Mac OS-ref" class="btn btn-mini">Mac OS <span class="badge">1</span></a>
    
        <a href="/tags.html#VNC-ref" class="btn btn-mini">VNC <span class="badge">1</span></a>
    
        <a href="/tags.html#X11-ref" class="btn btn-mini">X11 <span class="badge">1</span></a>
    
        <a href="/tags.html#Merge sort-ref" class="btn btn-mini">Merge sort <span class="badge">1</span></a>
    
        <a href="/tags.html#boost-ref" class="btn btn-mini">boost <span class="badge">1</span></a>
    
        <a href="/tags.html#CDF-ref" class="btn btn-mini">CDF <span class="badge">1</span></a>
    
        <a href="/tags.html#Matlab-ref" class="btn btn-mini">Matlab <span class="badge">3</span></a>
    
        <a href="/tags.html#Multi-Process-ref" class="btn btn-mini">Multi-Process <span class="badge">1</span></a>
    
        <a href="/tags.html#Multi-Threading-ref" class="btn btn-mini">Multi-Threading <span class="badge">1</span></a>
    
        <a href="/tags.html#Bioinformatics-ref" class="btn btn-mini">Bioinformatics <span class="badge">1</span></a>
    
        <a href="/tags.html#Computer Vision-ref" class="btn btn-mini">Computer Vision <span class="badge">4</span></a>
    
        <a href="/tags.html#DTF-ref" class="btn btn-mini">DTF <span class="badge">2</span></a>
    
        <a href="/tags.html#ffmpeg-ref" class="btn btn-mini">ffmpeg <span class="badge">1</span></a>
    
        <a href="/tags.html#OpenCV-ref" class="btn btn-mini">OpenCV <span class="badge">1</span></a>
    
        <a href="/tags.html#Machine Learning-ref" class="btn btn-mini">Machine Learning <span class="badge">2</span></a>
    
        <a href="/tags.html#parfor-ref" class="btn btn-mini">parfor <span class="badge">1</span></a>
    
        <a href="/tags.html#BACI-ref" class="btn btn-mini">BACI <span class="badge">1</span></a>
    
        <a href="/tags.html#Alogrithm-ref" class="btn btn-mini">Alogrithm <span class="badge">1</span></a>
    
        <a href="/tags.html#Jekyll-ref" class="btn btn-mini">Jekyll <span class="badge">1</span></a>
    
        <a href="/tags.html#Github-ref" class="btn btn-mini">Github <span class="badge">1</span></a>
    
        <a href="/tags.html#Architecture-ref" class="btn btn-mini">Architecture <span class="badge">1</span></a>
    
        <a href="/tags.html#Cache-ref" class="btn btn-mini">Cache <span class="badge">1</span></a>
    
        <a href="/tags.html#Fisher Vector-ref" class="btn btn-mini">Fisher Vector <span class="badge">1</span></a>
    
        <a href="/tags.html#SVM-ref" class="btn btn-mini">SVM <span class="badge">1</span></a>
    
        <a href="/tags.html#Java-ref" class="btn btn-mini">Java <span class="badge">1</span></a>
    
        <a href="/tags.html#Dynamic Programming-ref" class="btn btn-mini">Dynamic Programming <span class="badge">1</span></a>
    
        <a href="/tags.html#Distributed Systems-ref" class="btn btn-mini">Distributed Systems <span class="badge">1</span></a>
    
        <a href="/tags.html#Network-ref" class="btn btn-mini">Network <span class="badge">1</span></a>
    
  



			</div>
		</div>
		<!-- /well -->
        <div class="well">
			<h4>Visitors</h4>
			<div class="tag_box">
				<script type="text/javascript" src="http://je.revolvermaps.com/2/1.js?i=4nm24yds2ph&amp;s=300&amp;m=0&amp;v=true&amp;r=false&amp;b=000000&amp;n=false&amp;c=ff0000" async="async"></script>
	
			</div>
        </div>
        <!-- /well -->
        <div class="well">
            <h3>Recent Posts</h3>
	        <ul>
			
  			<li><span>2014-07-14</span> &raquo; <a href="/2014/07/14/insertion-sort-list">Insertion Sort List</a></li>
			
  			<li><span>2014-07-13</span> &raquo; <a href="/2014/07/13/linked-list-cycle">Linked List Cycle Problems</a></li>
			
  			<li><span>2014-07-08</span> &raquo; <a href="/2014/07/08/sort-list">Sort List</a></li>
			
  			<li><span>2014-07-07</span> &raquo; <a href="/2014/07/07/subset-sum">Subset Sum Problem</a></li>
			
  			<li><span>2014-07-07</span> &raquo; <a href="/2014/07/07/determine-top-common-ip-addresses">Find Top Source IP Addresses in Distributed Systems</a></li>
			
  			<li><span>2014-07-06</span> &raquo; <a href="/2014/07/06/longest-palindromic-substring">Longest Palindromic Substring</a></li>
			
  			<li><span>2014-07-01</span> &raquo; <a href="/2014/07/01/strstr">The First Occurrence of Needle In Haystack</a></li>
			
  			<li><span>2014-07-01</span> &raquo; <a href="/2014/07/01/longest-consecutive-sequence">Longest Consecutive Sequence</a></li>
			
  			<li><span>2014-06-29</span> &raquo; <a href="/2014/06/29/top-n-numbers">Top N Numbers</a></li>
			
  			<li><span>2014-06-27</span> &raquo; <a href="/2014/06/27/nqueens">N-Queens Problem</a></li>
			
			</ul>
        </div>
        <!-- /well -->
</div>

	</div>
</div>


    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> Bo Yang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
	    </script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/google-code-prettify/prettify.js"></script>
  <script src="/assets/run_prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow" class="btn btn-primary" role="button">' + 'Read More &raquo;</a>');
        }
      });
    });
  </script>

  

</body>
</html>

