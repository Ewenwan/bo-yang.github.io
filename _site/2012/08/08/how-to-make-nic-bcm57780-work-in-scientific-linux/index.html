
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<head>
  <title>How to make NIC BCM57780 work in Scientific Linux? | Bo's Blog</title>
  
  <meta name="author" content="boyang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">

  <!-- using baidu cdn instead
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  -->
  <link href="http://libs.baidu.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet">


  <!-- Google Prettify -->
  <link href="/assets/themes/clear/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/themes/clear/css/style.css" rel="stylesheet" type="text/css" media="all" />
  <!-- using baidu cdn instead
  <script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
  -->

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="/">bo-yang</a>
        <ul class="nav">
          <li><a href="/archive.html">Archive</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/messages.html">Messages</a></li>
        </ul>
        <ul class="pull-right">
          <li>
            <form class="navbar-search" method="get" action="http://www.google.com/search" target="google_window">
              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
              <input type="hidden" name="ie" value="UTF-8" />
              <input type="hidden" name="oe" value="UTF-8" />
              <input type="hidden" name="hl" value="en-US" />
              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
              <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
            </form>
          </li>
        </ul>
        <ul class="nav pull-right">
          <li><a href="/atom.xml">RSS</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container page-container">
    <div class="content">
      
<div class="page-header">
  <h1>How to make NIC BCM57780 work in Scientific Linux?</h1>
</div>

<div class="row-fluid page-body">
  <div class="span9 left">
    <div class="main-container shadow">
      <div class="mainbody thepost">
        <p>I decided to install Scientific Linux on the computer in my lab. Partly because this distribution is called "Scientific", partly because it is compiled from Red Hat Enterprise Linux, the most prestigious Linux distribution in the world.</p>
<p>At first, I downloaded the <a href="http://ftp.scientificlinux.org/linux/scientific/6.2/x86_64/iso">Everything DVDs</a> and burned it into my USB stick via <a href="http://unetbootin.sourceforge.net/">UNetbootin</a>. Unfortunately, it couldn't boot. Then I tried the <a href="http://ftp.scientificlinux.org/linux/scientific/6.2/x86_64/iso/SL-62-x86_64-2012-02-16-LiveCD.iso">Live CD</a>. It did worked and I installed the SL in a few minutes. However, the network could not be connected and the NIC could not be activated. I checked the NIC type by "<code>lspci | grep net</code>", and I found it was <strong>Broadcom Corporation NetLink BCM57780</strong>.</p>
<p>Many people complain this network card. Some guys tried to download the<a href="http://www.broadcom.com/support/ethernet_nic/netlink_k57.php"> source code </a>of the driver from Broadcom and compiled it by themselves. I didn't want to do that, so I searched "tg3 rpm" and finally got the rpm package for SL <a href="ftp://ftp.ntua.gr/pub/linux/scientificlinux/6.2/x86_64/updates/fastbugs/kmod-tg3-3.122-1.el6_2.x86_64.rpm">kmod-tg3-3.122-1.el6_2.x86_64.rpm</a>. I installed it and restarted the network even the computer, the NIC still didn't work.</p>
<p>Then I resorted to compiling the source code of tg3. Unfortunately, I realized that gcc was not installed -- the LiveCD didn't contain the GCC package. When I tried to manually install GCC from rpm, a series of shared library dependencies blocked me. So I have to downloaded the <a href="http://ftp.scientificlinux.org/linux/scientific/6.2/x86_64/iso/SL-62-x86_64-2012-02-16-LiveDVD.iso">LiveDVD of SL</a>, burned it again and installed the SL again. This time, the GCC was included.</p>
<p>Before building the tg3 driver, I installed the downloaded tg3 rpm package and searched again for the driver. Finally I found webpage <strong><a href="http://www.aoddy.com/2007/10/15/how-to-updating-driver-for-gigabit-network-card-broadcom-tg3netxtream-on-fedora-core-4-2/">How to updating driver for gigabit network card [Broadcom TG3:netXtream] on fedora core 4.</a> </strong>and responses to <a href="http://fonality.com/trixbox/forums/trixbox-forums/help/eth0-no-device-found-nic-broadcom-tg3-drivers-kernel-dkms">eth0 no device found, NIC Broadcom tg3 drivers, kernel, DKMS</a>. Combing the two webpages, I got to know how to make BCM57780 work in SL:</p>
<ol>
<li>Download and install <a href="ftp://ftp.ntua.gr/pub/linux/scientificlinux/6.2/x86_64/updates/fastbugs/kmod-tg3-3.122-1.el6_2.x86_64.rpm">kmod-tg3-3.122-1.el6_2.x86_64.rpm</a>.</li>
<li>Go to <code>/lib/modules/&lt;kernel#&gt;/kernel/net </code> and check if tg3.ko there. If not, try executing "locate tg3".</li>
<li>Run command "<code>insmod  /path/to/tg3.ko</code>".</li>
<li>Run command "<code>service network restart</code>".</li>
<li>Update /etc/.rc.local and append commands in 3 &amp; 4 to the end. Or you must manually run commands 3&amp;4 after reboot.</li>
</ol>
<p>Besides, if the above still not work, you may consider appending "<code>biosdevname=0</code>" to the kernel line of the grub config file <code>/etc/grub.conf</code>.</p>
<p><em><strong>[Update 08/09/2012]:</strong></em></p>
<p>I am sorry that I didn't really tried if the way above modifying /etc/rc.local really work after reboot. And today I did try, but the answer was no. I struggled for another hour and finally found out the tricky tip: <span style="color:#ff0000;"><strong>module tg3.ko must be removed and re-installed before restarting your network, or the Broadcom NIC still wouldn't work!</strong></span></p>
<p>So you should append following code to your /etc/rc.local:</p>
<p><strong><code>rmmod tg3.ko<br />
insmod /path/to/tg3.ko<br />
service network restart</code></strong></p>

      </div>
    </div>

    <div class="main-container shadow">
      <div class="mainbody">
        <div class="bshare-custom">
	<span class='st_facebook_large' displayText='Facebook'></span>
	<span class='st_googleplus_large' displayText='Google +'></span>
	<span class='st_twitter_large' displayText='Tweet'></span>
	<span class='st_sina_large' displayText='Sina'></span>
	<span class='st_linkedin_large' displayText='LinkedIn'></span>
	<span class='st_tumblr_large' displayText='Tumblr'></span>
	<span class='st_sharethis_large' displayText='ShareThis'></span>
	<span class='st_blogger_large' displayText='Blogger'></span>
	<span class='st_email_large' displayText='Email'></span>
</div>
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "6e9cb968-ad78-4055-b1e7-1b7ab6751416", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

        
        <div class="post-end">
</div>


        <div class="pagination">
          <ul>
          
            <li class="prev"><a href="/2012/06/14/sock_raw-issue-with-setuidchroot-ed-login-on-linux-serversstill-unresolved" title="SOCK_RAW Issue with setuid&chroot-ed login on Linux Servers(Still Unresolved)">&larr; Previous</a></li>
          
            <li><a href="/archive.html">Archive</a></li>
          
            <li class="next"><a href="/2012/08/24/connect-mac-os-x-with-linux-server" title="Connect Mac OS X with Linux Server">Next &rarr;</a></li>
          
          </ul>
        </div>
      </div>
    </div>

    <div class="main-container shadow">
      <div class="mainbody">
		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'boyang'; // required: replace example with your forum shortname
     var disqus_identifier = '/2012/08/08/how-to-make-nic-bcm57780-work-in-scientific-linux';
    var disqus_url = 'http://bo-yang.github.com//2012/08/08/how-to-make-nic-bcm57780-work-in-scientific-linux';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	  </div>
    </div>

  </div>

  <div class="span3 right">
    <div class="side-container shadow">
      <div class="sidebar">
        <h4>Published</h4>
        <div class="date"><span>2012-08-08</span></div>
      </div>
    </div>

    <div class="side-container shadow">
      <div class="sidebar">
        
          <h4>Tags</h4>
          <ul class="tag_box">
          
          


  
     
    	<li><a href="/tags.html#Linux-ref">Linux <span>5</span></a></li>
     
    	<li><a href="/tags.html#NIC-ref">NIC <span>1</span></a></li>
    
  



          </ul>
        
      </div>
    </div>

    <div class="side-container shadow">
		<div class="sidebar">
			<!--
			<script type="text/javascript" id="wumiiRelatedItems"></script>
			-->
		  <script>
var linkwithin_site_id = 2140443;
</script>
<script src="http://www.linkwithin.com/widget.js"></script>
<a href="http://www.linkwithin.com/"><img src="http://www.linkwithin.com/pixel.png" alt="Related Posts Plugin for WordPress, Blogger..." style="border: 0" /></a>

      </div>
    </div>

  </div>
</div>




    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> boyang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
        </script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/themes/clear/google-code-prettify/prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow">' + 'Read More ...</a>');
        }
      });
    });
  </script>
  

</body>
</html>

