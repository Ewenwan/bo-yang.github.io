
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <title>Korn Shell中IFS的妙用 | Bo's Blog</title>
  
  <meta name="author" content="Bo Yang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <!--
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  -->

  <!-- Bootstrap -->
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- font-awesome -->
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

  <!-- Google Prettify -->
  <link href="/assets/themes/clear/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/themes/clear/css/style.css" rel="stylesheet" type="text/css" media="all" />
  
  
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="/">bo-yang</a>
        <ul class="nav">
          <li><a href="/archive.html">Archive</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/messages.html">Messages</a></li>
        </ul>
        <ul class="pull-right">
          <li>
            <form class="navbar-search" method="get" action="http://www.google.com/search" target="google_window">
              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
              <input type="hidden" name="ie" value="UTF-8" />
              <input type="hidden" name="oe" value="UTF-8" />
              <input type="hidden" name="hl" value="en-US" />
              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
              <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
            </form>
          </li>
        </ul>
        <ul class="nav pull-right">
          <li><a href="/atom.xml">RSS</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container page-container">
    <div class="content">
      
<div class="page-header">
	<h1>Korn Shell中IFS的妙用</h1>
</div>

<div class="row-fluid page-body">
  <div class="span11 left">
    <div class="main-container shadow">
	  <div class="mainbody thepost">
        <p>IFS是internal field separator的缩写，shell的特殊环境变量。ksh根据IFS存储的值，可以是空格、tab、换行符或者其他自定义符号，来解析输入和输出的变量值。</p>
<p>&nbsp;</p>
<p>如果有一IP地址220.112.253.111, 欲将这个IP地址颠倒顺序，你可以定义IFS为"."，然后直接echo这个地址即可得到此IP的4个数值，然后c重新把IFS设为空格，重新组合四个IP地址的数值即可。</p>
<p>
<pre># The following code segment will only work in ksh, 
# and it will fail in bash
IP=220.112.253.111
IFS="."
TMPIP=$(echo $IP)
IFS=" " # space
echo $TMPIP | read ip1 ip2 ip3 ip4
INVERT_IP=$ip4.$ip3.$ip2.$ip1</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>更详细的IFS的介绍参见下文：（原文地址：<a href="http://www.livefirelabs.com/unix_tip_trick_shell_script/oct_2003/10132003.htm">http://www.livefirelabs.com/unix_tip_trick_shell_script/oct_2003/10132003.htm</a>）</p>
<p>&nbsp;</p>
<table style="width:100%;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>Another shell variable that you should become comfortable using is the IFS, or internal field separator, variable.<span>&nbsp;&nbsp;</span>The shell uses the value stored in IFS, which is the space, tab, and newline characters by default, to delimit words for the read and set commands, when parsing output from command substitution, and when performing variable substitution.</span><span></p>
<p><span style="text-decoration:underline;">IFS can be redefined to parse one or more lines of data whose fields are not delimited by the default white-space characters.</span><span>&nbsp;&nbsp;</span>Consider this sequence of variable assignments and for loops:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;">$ line=learn:unix:at:livefire:labs<br />$ for i in $line<br />&gt; do<br />&gt; echo $i<br />&gt; done<br />learn:unix:at:livefire:labs<br />$ OIFS=$IFS<br />$ IFS=:<br />$ for i in $line<br />&gt; do<br />&gt; echo $i<br />&gt; done<br />learn<br />unix<br />at<br />livefire<br />labs<br />$</p>
<p></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>The first command assigns the string &ldquo;learn:unix:at:livefire:labs&rdquo; to the variable named line.<span>&nbsp;&nbsp;</span>You can see from the first for loop that the shell treats the entire string as a single field.<span>&nbsp;&nbsp;</span>This is because the string does not contain a space, tab, or newline character.&nbsp;</p>
<p></span><span>After redefining IFS, the second for loop treats the string as four separated fields, each delimited by a colon.<span>&nbsp;&nbsp;</span>Using a colon for IFS would be appropriate when parsing the fields in a record from /etc/passwd, the user account information file:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;">livefire:x:100:1::/export/home/livefire:/bin/ksh</p>
<p></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>Notice that the original value of IFS was stored in OIFS (&ldquo;O&rdquo; for original) prior to changing its value.<span>&nbsp;&nbsp;</span>After you are finished using the new definition, it would be wise to return it to its original value to avoid unexpected side effects that may surface later on in your script.&nbsp;</p>
<p></span><span>TIP &ndash; The current value of IFS may be viewed using the following pipeline:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<blockquote>
<p><span style="font-family:Arial;font-size:x-small;">$ echo "$IFS" | od -b<br />0000000 040 011 012 012<br />0000004<br />$</span></p>
</blockquote>
</td>
</tr>
<tr>
<td width="100%"><span style="font-family:Arial;font-size:x-small;"><span>The output of the echo command is piped into the octal dump command, giving you its octal equivalent.<span>&nbsp;&nbsp;</span>You can then use an ASCII table to determine what characters are stored in the variable.<span>&nbsp;&nbsp;</span>Hint: Ignore the first set of zeros and the second newline character (012), which was generated by echo.<br /></span></span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>

      </div>
    </div>

    <div class="main-container shadow">
      <div class="mainbody">
        <div class="bshare-custom">
	<span class='st_facebook_large' displayText='Facebook'></span>
	<span class='st_googleplus_large' displayText='Google +'></span>
	<span class='st_twitter_large' displayText='Tweet'></span>
	<span class='st_sina_large' displayText='Sina'></span>
	<span class='st_linkedin_large' displayText='LinkedIn'></span>
	<span class='st_tumblr_large' displayText='Tumblr'></span>
	<span class='st_sharethis_large' displayText='ShareThis'></span>
	<span class='st_blogger_large' displayText='Blogger'></span>
	<span class='st_email_large' displayText='Email'></span>
</div>
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "6e9cb968-ad78-4055-b1e7-1b7ab6751416", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

        
        <div class="post-end">
</div>


        <div class="pagination">
          <ul>
          
            <li class="prev"><a href="/2010/06/24/apache-subversion-config" title="Apache and Subversion配置">&larr; Previous</a></li>
          
            <li><a href="/archive.html">Archive</a></li>
          
            <li class="next"><a href="/2010/07/17/use-shell-var-in-awk" title="awk正则表达式中调用ksh变量">Next &rarr;</a></li>
          
          </ul>
        </div>
      </div>
    </div>

    <div class="main-container shadow">
      <div class="mainbody">
		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'boyang'; // required: replace example with your forum shortname
     var disqus_identifier = '/2010/07/17/ifs-in-kshell';
    var disqus_url = 'http://bo-yang.github.com//2010/07/17/ifs-in-kshell';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	  </div>
    </div>

  </div>

  <div class="span3 right">
    <div class="side-container shadow">
      <div class="sidebar">
        <h4>Published</h4>
        <div class="date"><span>2010-07-17</span></div>
      </div>
    </div>

    <div class="side-container shadow">
      <div class="sidebar">
        
          <h4>Tags</h4>
          <ul class="tag_box">
          
          


  
     
    	<li><a href="/tags.html#Unix/Linux-ref">Unix/Linux <span>93</span></a></li>
    
  



          </ul>
        
      </div>
    </div>

	
    <div class="side-container shadow">
		<div class="sidebar">
			<!--
			<script>
var linkwithin_site_id = 2140443;
</script>
<script src="http://www.linkwithin.com/widget.js"></script>
<a href="http://www.linkwithin.com/"><img src="http://www.linkwithin.com/pixel.png" alt="Related Posts Plugin for WordPress, Blogger..." style="border: 0" /></a>

			-->
			<h4>Related Posts</h4>
			
  				<li><a href="/2014/06/27/nqueens">N-Queens Problem</a></li>
			
  				<li><a href="/2014/06/25/combination-sum">Combination Sum Problem - A Non-recursive Method</a></li>
			
  				<li><a href="/2014/06/20/coin-change">Coin Change Problem</a></li>
			
  				<li><a href="/2014/06/18/text-justification">Text Justification</a></li>
			
  				<li><a href="/2014/06/17/sort-colors">Sort Colors</a></li>
			
  				<li><a href="/2014/06/14/soduku">Check Soduku Solution</a></li>
			
      </div>
  </div>
  	

  	<div class="side-container shadow">
		<div class="sidebar">
			<h4>Recent Posts</h4>
			
  				<li><a href="/2014/06/27/nqueens">N-Queens Problem</a></li>
  			
  				<li><a href="/2014/06/25/combination-sum">Combination Sum Problem - A Non-recursive Method</a></li>
  			
  				<li><a href="/2014/06/20/coin-change">Coin Change Problem</a></li>
  			
  				<li><a href="/2014/06/18/text-justification">Text Justification</a></li>
  			
  				<li><a href="/2014/06/17/sort-colors">Sort Colors</a></li>
  			
  				<li><a href="/2014/06/14/soduku">Check Soduku Solution</a></li>
  			
  				<li><a href="/2014/06/12/lru-cache">Least Recently Used(LRU) Cache</a></li>
  			
  				<li><a href="/2014/05/26/binary-tree-traversal">Binary Tree Operations</a></li>
  			
  				<li><a href="/2014/04/30/fisher-vector-in-action-recognition">Action Recognition with Fisher Vectors</a></li>
  			
  				<li><a href="/2014/03/29/how-to-install-jekyll-in-mac-osx-mavericks">How To Install Jekyll in Mac OSX Mavericks</a></li>
  			
      </div>
    </div>


  </div>
</div>




    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> Bo Yang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
	    </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/themes/clear/google-code-prettify/prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow">' + 'Read More ...</a>');
        }
      });
    });
  </script>
  

</body>
</html>

