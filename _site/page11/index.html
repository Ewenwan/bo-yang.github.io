
<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:wb="http://open.weibo.com/wb">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bo Yang | Bo's Blog</title>
  
  <meta name="author" content="Bo Yang" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <!--
  <link href="/assets/themes/clear/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  -->

  <!-- Bootstrap -->
  <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

  <!-- font-awesome -->
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

  <!-- Google Prettify -->
  <link href="/assets/google-code-prettify/desert.css" rel="stylesheet" type="text/css" media="all">
  <!-- Google Pretty end -->

  <link href="/assets/style/blog.css" rel="stylesheet">
  
  <script src="/assets/bootstrap/js/jquery-1.10.2.js"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

   <!-- navigation bar -->
	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Home</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/archive.html">Archive</a>
                    </li>
                    <li><a href="/about.html">About</a>
                    </li>
                    <li><a href="/messages.html">Messages</a>
                    </li>
				</ul>
				<ul class="nav navbar-nav pull-right">
		          <li>
		            <form class="navbar-form navbar-search" method="get" action="http://www.google.com/search" target="google_window">
		              <input id="g_search" type="text" class="search-query" placeholder="Search..." name="q" />
		              <input type="submit" name="btnG" style="display:none" id="searchsubmit" value="Search" />
		              <input type="hidden" name="ie" value="UTF-8" />
		              <input type="hidden" name="oe" value="UTF-8" />
		              <input type="hidden" name="hl" value="en-US" />
		              <input type="hidden" name="domains" value="http://bo-yang.github.io/" />
					  <input type="hidden" name="sitesearch" value="http://bo-yang.github.io/" />
					  <button type="submit" class="button button-rounded button-flat-blue">Go</button>
		            </form>
		          </li>
		        </ul>
            </div>
			<!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

  <div class="container">
    <div class="row" id="content-row">
      
<div class="page-header">
	<h1>Bo Yang  <small style="margin-left:20px;"><font face="cursive"><i>Beginner's mind.</i></font></small></h1>
</div>

<div class="container">
    <div class="row" id="content-row">
		<div class="col-md-8">
	<!-- blog entry -->
	
	<div class="post paper">	
    <h2 class="header"><a href="/2010/09/03/delete-realplayer">Linux下如何删除已安装的realplayer</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-09-03</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>由于realplayer在Linux下只能通过realplay*.bin来安装，装好后不能通过yum或rpm卸载。现在的realplayer已然成为名副其实的垃圾软件，Linux下尤其如此。</p>
<p>&nbsp;</p>
<p>卸载它的办法就是通过locate realplay命令找到所有realplay相关的文件，然后统统删除之！</p>
<p>&nbsp;</p>
<p><span style="font-family:monospace;font-size:small;"><span style="white-space:pre-wrap;">
<pre>realplayer=$(locate realplay)
echo $realplayer
rm -rf $realplayer
</pre>
<p> </span></span></p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/09/02/splashtop-remote">Splashtop Remote——让你在iPad上也能用Windows下的应用</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-09-02</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Industry-ref" rel="nofollow">Industry</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>今天看到这样一篇博文：<a href="http://blog.sina.com.cn/s/blog_679720260100ky5a.html?tj=1">在iPad上也能用Windows下的应用？我能！</a></p>
<p>&nbsp;</p>
<p>对于文中介绍的可以在iPad上也能用Windows软件的Splashtop Remote很感兴趣，因为传说Chrome OS也会用类似的机制来解决Windows软件的兼容问题，即&ldquo;一部分运行在PC上，起daemon的作用，另外一个运行在iPad上，跟PC的软件进行通信，使用户能够控制或管理PC上的软件程序和数据。&rdquo; 这应该和VNC起的作用类似。</p>
<p>&nbsp;</p>
<p>估计iPad和即将发布的gPad（Chrome OS Tablet）乃至Android Pad们很快就会利用这种方式开拓市场，甚至蚕食PC市场了。试想如果将来有公司（比如这个DeviceVM）推出一项服务（可以免费，也可收费），为用户提供现成的Windows应用，而用户所需要做的就是在iPad或gPad上安装Splashtop Remote，打开这个应用就可以自动连接到DeviceVM的Windows PC/Server，利用现成的Windows程序了&mdash;&mdash;省去了自己购买并维护PC的很多麻烦，节省了购买大量Windows软件的开支，何乐而不为呢？而且这也正契合了时下的云计算潮流。</p>
<p>&nbsp;</p>
<p>我能想到的问题是，这种方式使用Windows软件的体验会不会大打折扣？因为在使用VNC登录到Mac OS X的时候，即使在局域网内，图像质量很差，操作很不流畅。也许像Splashtop Remote这样的应用可以保证图像的质量，但是网络本身也会成为一个瓶颈，尤其是3G网络。看来在LTE普及之前，这种应用只能使用WIFI了。</p>
<p>&nbsp;</p>
<p>顺便到Apple App Store里看了一下，发现了几张官方的截图，可以看出，图像质量还是有一定的损失的：</p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/053/Purple/c5/a5/f6/mzl.vcvzpnec.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/036/Purple/ff/b6/63/mzl.ncmtyrzu.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/026/Purple/a7/73/4a/mzl.zngpsfkj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/033/Purple/34/71/31/mzl.nzoufixg.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>
<p><img src="http://a1.phobos.apple.com/us/r1000/004/Purple/1c/8b/bf/mzl.phnrdjsj.480x480-75.jpg" alt="" width="480" height="360" /></p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/08/03/use-pipe-in-expect">Tcl/Expect中利用exec调用管道"|"和awk的注意事项</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-08-03</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Tcl/Tk-ref" rel="nofollow">Tcl/Tk</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>Tcl/Expect中利用exec调用稍微复杂的shell命令时，经常会遇到一些小问题，常见的就是pipeline(|)和awk。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用多个shell命令并使用|将其串接在一起时，需要注意的是必须在"|"前后加上空格" "，否则tcl/Expect会报奇怪的错。</p>
<p>&nbsp;</p>
<p>Tcl/Expect调用awk命令时，需要把awk的' '中的命令改为用" "，并把$1, $2之类的变量改为/$1, /$2。</p>
<p>&nbsp;</p>
<p>下面的ksh命令判断test_process是否在运行：</p>
<p>
<pre>ps -fu bonny|grep -v ps|grep MMCAP|grep -v grep|awk '{print $2}'</pre>
<p>&nbsp;</p>
<p>改为Tcl/Expect后，为：</p>
<p>
<pre>exec ps -fu $myname | grep -v ps | grep COOLrunMMCAP | grep -v grep | awk "{print /$2}"</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>另外，&nbsp;<a href="http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/">http://www.linuxquestions.org/questions/linux-software-2/ksh-tcl-173092/</a>&nbsp;列出了一些ksh命令转换为tcl语句时经常遇到的问题（本人未曾验证过，请谨慎使用）。</p>
<p>&nbsp;</p>
<p>Here's some conversion rules that I have proven, if anyone has any more info ( in any fashion ) , please advise.</p>
<p>-----------------------------------------------------------------<br />Rule: Remove "<br />-----------------------------------------------------------------<br />ksh: cat *.passwd 2&gt;/dev/null | cut -d":" -f1 | sort | uniq<br />tcl: exec cat *.passwd 2&gt;/dev/null | cut -d: -f1 | sort | uniq<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '(..$1..)' with "{../$1..}"<br />-----------------------------------------------------------------<br />ksh: ps -eaf | awk '(print $1}' | grep $1 2&gt;&amp;1<br />tcl: exec ps -eaf | awk "{print /$1}" | grep $user_login_to_test<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace "..." with {...}<br />-----------------------------------------------------------------<br />ksh: grep "^$(user_login:" /etc/passwd /etc/shadow 2&gt;&amp;1<br />tcl: exec grep {^$user_login:} /etc/passwd /etc/shadow<br />-----------------------------------------------------------------</p>
<p>-----------------------------------------------------------------<br />Rule: Replace '...' with "..." or {...}<br />-----------------------------------------------------------------<br />ksh: grep 'Version' user.tcl<br />tcl: exec grep {Version} user.tcl<br />tcl: exec grep "Version" user.tcl<br />-----------------------------------------------------------------</p>
<p>&nbsp;</p>
<p>还有就是<a href="http://wiki.tcl.tk/1039">http://wiki.tcl.tk/1039</a>列出了使用exec的一些常见问题。</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/07/22/expect-send-data-in-expect_out">expect_out(buffer)中包含send的数据</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-07-22</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Tcl/Tk-ref" rel="nofollow">Tcl/Tk</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>&nbsp;</p>
<div>
<h1 id="zw-129f916d484wZwN43916c">expect_out(buffer)中包含send的数据</h1>
<p id="zw-129f9095e02SqGVnn3916c"><span id="zw-129f9081eab6rVFjl3916c">我一直以为在Expect中一旦执行send之后，</span><span id="zw-129f9081eab0LvB_n3916c">expect_out(buffer)就会被清空，直到有新的数据被填入，而恰恰就是这些数据被用在expect语句中。而今天在调试时发现的问题却令我大吃一惊，原来expect_out(buffer)不会被自动清空，而expect到的数据很可能不是你真正想要的，非常有可能是历史数据。</span><span id="zw-129f9095dc2QusTdp3916c"><a id="zw-129f9081f1cN6cQM93916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378">"expect_out(buffer) has the content of the previous send"</a>&nbsp;</span><span id="zw-129f9099e0e7RHXvZ3916c">一文</span><span id="zw-129f908ec42SOcAlE3916c">也指出了这个问题。</span></p>
<h4></h4>
<p id="zw-129f8fe7303mkLwZ3916c">&nbsp;</p>
<p id="zw-129f9000807KX0na03916c">&nbsp;</p>
<div id="zw-129f900a60bRM8gME3916c"><span id="zw-129f900a60cjSAA9Y3916c">比如在我的代码中，有如下片段：</span></div>
<div id="zw-129f90d0f92fIcFt93916c">
<pre>set prompt "#"
set lockfile "/root/tmp/.cool.lock" 
send "
if /[ -e $lockfile ]; then
        cat $lockfile
else 
        echo /"COOLID: $coolid/" &gt; $lockfile
        echo DONE!
fi
/r"
sleep 1 ;# necessary
expect {
        timeout {
                puts stderr "WARNING: $ME: cannot verify if the Linux AP is locked by other COOL session!";
                exit 2;
        }
       -re "COOLID: (/[1-9](/[0-9])*).*$prompt" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                puts stdout "expect_out(2,string)=$expect_out(2,string)"
                puts stdout "expect_out(3,string)=$expect_out(3,string)"
        }
        "DONE!"  ;# do nothing    
}
</pre>
<p>&nbsp;</p></div>
<div id="zw-129f90da827xtgjkZ3916c">无论$<span id="zw-129f90e1718nSGeGs3916c">lockfile是否存在，expect总会得到COOLID: 68，而expect_out(buffer)的出如下：</span></div>
<div id="zw-129f90b2476dtXxBy3916c"><span id="zw-129f90b2476oxjVv3916c"><br /></span></div>
<div id="zw-129f909c0f6KIKdhr3916c">
<pre>[root@bjvsmcl05 ~]# expect_out(buffer)= 
Last login: Fri Jul 23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]#
expect_out(0,string)=23 09:32:13 2010 from bjbldd
[root@bjvsmcl05 ~]# 
[root@bjvsmcl05 ~]# if [ -e /root/tmp/.cool.lock ]; then
&gt;         cat /root/tmp/.cool.lock
&gt; else 
&gt;         echo "COOLID: 68" &gt; /root/tmp/.cool.lock
&gt;         echo DONE!
&gt; fi
COOLID: 1234</pre>
<p>&nbsp;</p></div>
<div id="zw-129f900a6154k9vr_3916c"></div>
<div id="zw-129f9105181rk1x3916c"><span id="zw-129f910e606ulQUt93916c">由此可见，由于</span><span id="zw-129f910e6063BF84J3916c">expect_out(buffer)中含有send的</span><span id="zw-129f910e666C0g_Fp3916c">echo "COOLID: 68"</span><span id="zw-129f910e607avGslF3916c">，因此永远都能匹配到这个数据。</span></div>
<div id="zw-129f912e050bsjfk33916c"><span id="zw-129f912e0513SIKJW3916c"><br /></span></div>
<div id="zw-129f912eb9dtLDgK3916c"><span id="zw-129f91d3abebAfTcg3916c">由于没有找到一种可以清空</span><span id="zw-129f91d3ac0nlD1Le3916c">expect_out(buffer)的方法，无法实时地将</span><span id="zw-129f91d3b3fb8YqAR3916c">expect_out(buffer)清空。</span><span id="zw-129f91d3ac3QUsX9u3916c">我能想到的解决方法有两种：一是更改send和expect的内容或方式，避免send的内容中出现expect的模式(pattern)。比如在我的程序中把上述代码段改为：</span></div>
<div id="zw-129f9158fb2IWSJh63916c">
<pre>set lockfile "/root/tmp/.cool.lock"   
send "cat $lockfile/r"
expect {
        -re "COOLID: (/[1-9](/[0-9])*)" {
                puts stdout "expect_out(buffer)=$expect_out(buffer)"
                puts stdout "expect_out(0,string)=$expect_out(0,string)"
                puts stdout "expect_out(1,string)=$expect_out(1,string)"
                if { [string compare $expect_out(1,string) $coolid] } {
                        puts stdout "ERROR: $ME: $pcname has been reserverd by COOL session $expect_out(1,string), please choose another Linux PC instead./n"
                        exit 2;
                }
        }
        "cat: $lockfile: No such file or directory*" {
                send "echo /"COOLID: $coolid/" &gt; $lockfile/r"
        }
}</pre>
<p>&nbsp;</p></div>
<div id="zw-129f9158fbfu4Bqbj3916c">就可以正常工作了。</div>
<div id="zw-129f915d6eatVpx_B3916c"></div>
<div id="zw-129f915ddd2JF4vnX3916c"><span id="zw-129f9193cbaAjqmW43916c">另一种方法是按照</span><a id="zw-129f9193cbcDH9aOQ3916c" title="click to see reference to this page" href="http://wiki.tcl.tk/_/ref?N=17378"><span id="zw-129f9193cbdI49BAL3916c">"expect_out(buffer) has the content of the previous send"</span></a><span id="zw-129f9193cbfZkPuN3916c">的例子中的方法，set prompt，保持原始代码中send的内容不变，将expect的正则表达式改为&nbsp;</span><span id="zw-129f9193d30IyWK1h3916c">-re "fi(</span><span id="zw-129f9193d30nUI-eL3916c">.*)</span><span id="zw-129f9193d30LfTLJL3916c">$prompt"，如此一来希望的输出就在expect_out(1,string)中了，然后利用string或者lsearch命令对匹配到的数据进行分析。</span></div>
<div id="zw-129f91aeeb09SBIGu3916c"><span id="zw-129f91aeeb1poW5U3916c"><br /></span></div>
<div id="zw-129f91af02eanEEu3916c"><span id="zw-129f91af02eiHWs1G3916c">结论：今后在编写Expect脚本时，不仅要考虑每一步的send/expect，也还要考虑到这一步的expect的内容有可能出现在之前的历史数据中。</span></div>
<div><span id="zw-129f91af02eiHWs1G3916c"><br /></span></div>
<p id="zw-129f9158fca-kkq893916c">&nbsp;</p>
</div>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/07/20/here-document">Here Document</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-07-20</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	</p>
<p id="zw-129ed8c28af2dvqtt15bea0" class="MsoNormal">
<h1>Here Document</h1></p>
<p>Syntax:</p>
<p><em>command &lt;&lt; label&nbsp;<br />input line 1&nbsp;<br />&hellip;&nbsp;<br />input line n&nbsp;<br />label</em></p>
<p>This allows you to redirect input to a shell script from within the shell script itself.</p>
<ul>
<li>&lt;&lt; label indicates that label marks the end of the here document</li>
<li>label must appear on a line by itself to end the here document</li>
<li>&lt;&lt; 'label' prevents the shell from doing parameter and command substitution in the here document</li>
<li>&lt;&lt;- label deletes leading tabs (but not spaces) from the here document</li>
</ul>
<h2>Here Document Example&nbsp;<br /><span>(from page 189 in "Learning the Korn Shell")</span></h2>
<p>pgmname=$1&nbsp;<br />for user in $(ypcat passwd | cut -f1 -d:)&nbsp;<br />do&nbsp;<br />&nbsp;&nbsp;mail $user &lt;&lt;- EOF<br />&nbsp;&nbsp;Dear user,&nbsp;<br />&nbsp;&nbsp;A new version of $pgmname has been installed&nbsp;<br />&nbsp;&nbsp;in $(whence $pgmname).&nbsp;<br />&nbsp;&nbsp;Regards,&nbsp;<br />&nbsp;&nbsp;Your friendly sysadmin&nbsp;<br />EOF&nbsp;<br />done</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span>原文：&nbsp;</span><a href="http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html">http://snap.nlc.dcccd.edu/reference/scarlatos/cis2.50/note6.html</a></p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/07/18/iphone4-antena-gate">浅析Apple iPhone4天线问题的危机公关</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-07-18</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Industry-ref" rel="nofollow">Industry</a>, <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Essay-ref" rel="nofollow">Essay</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>&nbsp;</p>
<div>
<h1 id="zw-129e3d10a83QJWE-15bea0" style="text-align:center;">浅析A<span id="zw-129e3ac83d3_bPs9e15bea0">pple iPhone4天线问题的危机公关</span></h1>
<p id="zw-129e3ac83d3CFDfYy15bea0">&nbsp;</p>
<p id="zw-129e3ace966fegbrD15bea0"><span id="zw-129e3ace967cO2dP15bea0">iPhone4的天线问题甫一曝光，乔帮主就故态复萌了，拿出25年前打死不认亲生女儿的尽头，摆出死猪不怕开水烫的嘴脸，直言这个问题是由于用户的握手机的姿势不对引起的，言外之意就是碰到问题的这些用户太白痴，连如何正确握手机都得要别人教。很不幸的是，敝人也是习惯左手握手机，也是被乔帮主鄙视的那群人之一。</span></p>
<p id="zw-129e3bfa69dUjg1BQ15bea0">乔帮主的言论客观上激起了媒体和更多用户的不满，一大撮人巴不得Apple出事呢，现在苦苦等待了好几年的机会终于来到了，岂有坐视的道理？于是媒体铺天盖地的报道iPhone4的天线问题，科技专栏作家不断发表自己的看法，评测公司不断发布最新的评测&hellip;&hellip;</p>
<p id="zw-129e3c45695rq97mN15bea0">Apple深知此事不能不了了之，于是又宣称会尽快推出新的固件来修正之前iPhone的信号显示的bug&mdash;&mdash;iPhone4的信号之所以在握住某个点之后会大幅下降，主要原因是之前的信号显示是被夸大了的，也就是说之前的信号其实本来没有那么好，iPhone会故意将信号条设为满格，给用户以iPhone信号良好的假象。我相信这样做的绝不只Apple一家，其他厂家肯定也会搞这种小动作，只是程度不同而已。</p>
<p id="zw-129e3c5287eFTOTLj15bea0">但很快就有新的分析和测试出炉，固件升级不可能解决iPhone4掉话的问题，因为这个问题是由硬件引起的，确切而言是天线的设计缺陷&mdash;&mdash;软件不可能修复这种硬件的缺陷。而直到此时，Apple还没有同意免费为用户提供可以解决掉话问题的iPhone4保护套，用户还不得不掏30美元去买保护套。</p>
<p id="zw-129e3c8ff4erCaAr315bea0"><span id="zw-129e3d0c290zcxAbx15bea0">媒体继续穷追猛打，Apple必须得给出一个说法了。于是本周五，乔帮主专门召开了一个发布会来解释iPhone4的信号问题。一向喜欢在最后5分钟报道米国人民生活于水深火热之中的《新闻联播》当然不会放弃这样一个好机会，专门报道了这个消息&mdash;&mdash;</span><span id="zw-129e3d0c317LKBufn15bea0">迷信水果出品的一小撮不明真相的群众们，你们该醒醒了！即便牛B如iPhone4者，照样问题多多！还是赶紧买我天朝自产的XX吧！&hellip;&hellip;</span></p>
<p id="zw-129e3b99ae6BemeBk15bea0"><span id="zw-129e3d5aac4iEW14D15bea0">感谢CCAV，在我吃饭的时候报道了这条消息，吃完饭后我赶紧上网仔细看了看相关报道。今天在新浪科技上看到了《</span><a id="zw-129e4b8ff5frYBH3215bea0" title="直播实录：苹果iPhone 4信号问题发布会" href="http://tech.sina.com.cn/t/2010-07-17/01104438749.shtml" target="_blank"><span id="zw-129e4b8ff5eyLK11U15bea0">直播实录：苹果iPhone 4信号问题发布会</span></a><span id="zw-129e4b8ff5eNw8vUx15bea0">》。看完之后，坦白讲，我被乔帮主的真诚感动了。下面简单分析一下乔帮主的思路。</span></p>
<p id="zw-129e3d5b65dLO6jCz15bea0">&nbsp;</p>
<div id="zw-129e490e626TplBJT15bea0"><span id="zw-129e490e627NPEeNZ15bea0">首先，在所有智能手机中iPhone4拥有最好的销量和最佳的口碑&mdash;&mdash;iPhone4天赋异禀，瑕不掩瑜&mdash;&mdash;先定好基调很重要。</span></div>
<div id="zw-129e490f1dfAY5D2x15bea0"><span id="zw-129e490f1dfS9Qoiq15bea0"><br /></span></div>
<div id="zw-129e490e6272R8F15bea0"><span id="zw-129e490e627t0Jes415bea0">所有的手机都不是完美的，iPhone4不是，其他手机也不是，iPhone4存在的天线问题在其他手机上照样存在&mdash;&mdash;老乔我阴沟里翻船了，你们在岸上的也休想有好日子过！空口无凭，图片为证，老乔把其他手机的信号锐减的情况逐一摆在大家面前。需要注意的是老乔在演讲中提到说类似的问题也存在在诺基亚手机中，但在presentation中却不见又诺记的图片，因此我怀疑Apple至今肯定还没有诺记信号问题的切实证据，老乔故意制造烟雾弹。也有另外一种可能是，在乔帮主眼中，就诺基亚那样低劣的工业设计，根本不配是Apple的对手，因此在presentation中放它一码。</span></div>
<p id="zw-129e490e62eIdY0Ue15bea0">&nbsp;</p>
<p id="zw-129e490e62eNfX3gi15bea0">&nbsp;</p>
<div id="zw-129e49bafa92zPQZ-15bea0"><span id="zw-129e49bafaahdOOuP15bea0">接下来乔帮主介绍了Apple在手机天线上的投入&mdash;&mdash;神秘的&ldquo;black&rdquo;实验室、过硬的技术人员和大量的资金投入&mdash;&mdash;两层含义：我们很重视手机天线的设计的，尽管iPhone4的天线存在问题，但绝对不可能是大问题；我们有这么大的投入尚不能解决的问题，其他公司又怎么能彻底解决呢？</span></div>
<div id="zw-129e49bafaaUZbLpI15bea0"></div>
<div id="zw-129e49bafab_EUqk15bea0"><span id="zw-129e49bafabFvyYtb15bea0">然后乔帮主拿出了hard data来说明iPhone4的问题，除了掉话率iPhone4比iPhone 3GS稍高一点之外，返修率和退货率都要低很多。在这里，乔帮主的下面这张slide制作的实在是太有水平了，不仔细看怎么都不觉得他是在承认iPhone4的问题，分明是在炫耀他的成绩嘛！</span></div>
<div id="zw-129e49bafabCPL2At15bea0"><img src="http://i0.sinaimg.cn/IT/2010/0717/201071723455.jpeg" border="0" alt="" hspace="0" vspace="0" /></div>
<p id="zw-129e49bafb06hOzSx15bea0">&nbsp;</p>
<p id="zw-129e4a1188ftS6F15bea0">其实iPhone4的这些数据很难说明问题，因为一是因为它上市的时间太短了，而且上市的地区有限（iPhone 3GS是在欧美多国同时上市的，而iPhone4只有少数几个国家）；再者就是天线信号显示条都可以随意更改，这数据又有何不可呢？</p>
<div id="zw-129e4adebdb9JDl4Y15bea0"></div>
<div id="zw-129e4adebdcVQ5Xz15bea0"><span id="zw-129e4adebdcT8Nwro15bea0">至于问题的解决方法，乔帮主终于同意了免费为用户提供手机套&mdash;&mdash;这是对他们最为有利的方案，如果接受媒体和业内人士的召回的建议，Apple的损失将是惨重的。为了进一步打消某些人仍然抱有的召回的幻想，乔帮主在Q&amp;A的环节中干脆暗示召回也很难解决问题，原因就是这是智能手机的通病，不可能在短期内有最终解决方案。</span></div>
<div id="zw-129e4adebdcth46IY15bea0"></div>
<div id="zw-129e4adebdcmY6Yds15bea0"><span id="zw-129e4adebddh5-O0815bea0">最后，乔帮主竟然主动爆出了正在调查iPhone4的距离感应器的问题&mdash;&mdash;如果有谁还幻想着在天线问题过去之后再炒作距离感应器的问题，还是省省吧！</span></div>
<div id="zw-129e4adebddBfU2VJ15bea0"></div>
<div id="zw-129e4adebdeVf30_J15bea0"><span id="zw-129e4adebdecOwZat15bea0">另外，乔帮主还深情的自我表白：&ldquo;我们这样做的原因是，我们爱自己的用户；如果我们把事情搞砸了，我们会自我检讨，并更加努力地工作。当我们取得成功时，我们所获得的奖励就是留住了用户。或许我们本应让公关人员来打发这些麻烦事，但我们没有，而是亲自来解决。所以，在过去22天时间里，我们一直都努力解决这个问题。我们认为，已经抓住了问题的核心。&rdquo;</span></div>
<div id="zw-129e4adebdeXJLvPH15bea0"></div>
<div id="zw-129e4adebdfA85PY215bea0"><span id="zw-129e4adebdfcUIB8Z15bea0">这是一个堪称经典的危机公关演讲！</span></div>
<div id="zw-129e4aeace8Bm15Ac15bea0"><span id="zw-129e4aeace8bX2vv15bea0"><br /></span></div>
<div id="zw-129e4aeaf80JHU7o15bea0"><span id="zw-129e4aeaf80v6SWKE15bea0">联想起最近国内的唐俊面对&ldquo;学历门&rdquo;的态度，汪晖教授面对&ldquo;抄袭门&rdquo;的反应，乔帮主的水平实在比他们高出一个档次&mdash;&mdash;既承认了自己的错误，又捎带打击了对手，既安抚了消费者和媒体，又能使自己的利益最大化。谢谢乔帮主又给我们上了一课！</span></div>
<div><span id="zw-129e4aeaf80v6SWKE15bea0"><br /></span></div>
<p id="zw-129e4adebe7O4HTKQ15bea0">PS:</p>
<p>&nbsp;</p>
<p>根据Apple的声明，很多人推测Apple很可能在10月份推出重新设计的iPhone4.我认为这很有可能，因Steve Jobs不可能容忍有瑕疵的产品在市场上销售太久。另外，至于有很多人质疑乔帮主在iPhone4发部前就已经知道它的天线问题，我觉得可能性也不是很大，凭着乔帮主要求Mac开发者搞半年才能拿出一个入他老人家法眼的的滚动条而最终发布时又不得不把这滚动条放弃的高要求，很难想象他会容忍有问题的iPhone流入市场&mdash;&mdash;即使事先他真的已经知道了这个问题，估计那也是离WWDC很近的时间内才知道的，箭在弦上不得不发了&hellip;&hellip;</p>
</div>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/07/17/use-shell-var-in-awk">awk正则表达式中调用ksh变量</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-07-17</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	</p>
<p>如果ksh中定义了变量pcname,而在嵌入ksh中的awk程序中又要使用这个环境变量，并且用它在正则表达式中，该如何用它呢？</p>
<p>最简单的方法就是：</p>
<p>
<pre>#!/bin/ksh
pcname="ap201"
nawk '/'"$pcname"'/{print $2}' $FILE</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>更多方法，参见下面转载的《<strong><a href="http://www.91linux.com/html/article/shell/20090405/16355.html">AWK 使用 Shell 变量</a></strong>》一文：</p>
<p>&nbsp;</p>
<p>最近闲着没事，想写个Shell脚本，其中用到了 AWK。想在AWK中读取／设置Shell脚本中定义的变量，搜索些资源，总结了一些东东。</p>
<p><span style="font-size:large;">读取变量</span></p>
<p>在通过如下方式<span>读取</span>Shell变量<br />1&gt; awk -v varName=varValue '...' ...<br />2&gt; awk '...{print "'"${USER}"'"}' ...<br />&nbsp;&nbsp; 此种方式可以访问系统环境变量（如USER等），和自定义Shell变量。若这些变量中没有空格及其他特殊字符，则可以少写两个双引号：awk '...{print "'${USER}"}' ...<br />3&gt; awk '...{print ENVIRON["USER"]}...' ...<br />&nbsp;&nbsp; 但是这种方法只能访问系统变量</p>
<p><span style="font-size:large;">设置变量</span></p>
<p><span>在AWK中尚未找到设置</span>Shell变量的方法，因为像上面的读取的方法中，一旦awk开始执行，这些环境变量都是一个副本，无论处理多少条记录，不管主Shell中如何变化，所引用的这些变量值都保持不变。而且，通过下面的实验可以看出来，在AWK中执行system函数调用命令是另起一个Shell线程，所以无法依靠system来设置外部环境变量。<br />如果你的AWK只打印一条结果的话，可以使用如下方式<span>在shell环境中设置</span>变量<br />&nbsp;&nbsp; myVar="`echo | awk '{print "AA/nBB/nCC"}'`"<br />注意，这种方式在awk打印多行情况下会将回车用空格替代后赋值。</p>
<p>实验过程如下：</p>
<p><span style="font-size:medium;"><span>$ vi tmp.sh</span></span><br />// 编辑内容如下<br /><span><span style="font-family:新宋体;">
<pre>#!/bin/bash
echo
echo "SHELL VERSION : ${SHELL} ${BASH_VERSION}"
echo "AWK VERSION : `awk -W version | sed -n '1p'`"
echo
myVar="AAA BBB CCC DDD"
echo "IN SHELL : PID=$"
echo "IN SHELL : /${myVar}=/"${myVar}/""
echo
echo | awk -v var1="${myVar}" '{
    print "IN AWK : how to print single quote : " "'"'"'" 
    print "No." NR
    print "IN AWK : -v : var1=/"" var1 "/""
    print "IN AWK : get : ENVIRON[/"USER/"]=/"" ENVIRON["USER"] "/""
    print "IN AWK : get : ENVIRON[/"myVar/"]=/"" ENVIRON["myVar"] "/""
    print "IN AWK : get : ${USER} =/"" "'"${USER}"'" "/"" 
    print "IN AWK : get : ${myVar}=/"" "'"${myVar}"'" "/"" 
    print
    system("echo /"IN AWK : system() : PID=$/"")
}' 
myVar="`echo | awk '{print "AA/nBB/nCC"}'`"
#/n is replaced by space character
echo ${myVar}</pre>
<p></span><br /><span style="font-size:medium;"><span style="font-family:新宋体;"><span>$ . tmp.sh</span><br /></span></span></span>//输出结果如下
<pre>
SHELL VERSION : /bin/bash 3.2.25(1)-release
AWK VERSION : GNU Awk 3.1.5
IN SHELL : PID=10627
IN SHELL : ${myVar}="AAA BBB CCC DDD"
IN AWK : how to print single quote : ' 
No.1
IN AWK : -v : var1="AAA BBB CCC DDD"
IN AWK : get : ENVIRON["USER"]="zhangll"
IN AWK : get : ENVIRON["myVar"]=""
IN AWK : get : ${USER} ="zhangll"
IN AWK : get : ${myVar}="AAA BBB CCC DDD"
IN AWK : system() : PID=17468
AA BB CC</pre>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/07/17/ifs-in-kshell">Korn Shell中IFS的妙用</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-07-17</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>IFS是internal field separator的缩写，shell的特殊环境变量。ksh根据IFS存储的值，可以是空格、tab、换行符或者其他自定义符号，来解析输入和输出的变量值。</p>
<p>&nbsp;</p>
<p>如果有一IP地址220.112.253.111, 欲将这个IP地址颠倒顺序，你可以定义IFS为"."，然后直接echo这个地址即可得到此IP的4个数值，然后c重新把IFS设为空格，重新组合四个IP地址的数值即可。</p>
<p>
<pre># The following code segment will only work in ksh, 
# and it will fail in bash
IP=220.112.253.111
IFS="."
TMPIP=$(echo $IP)
IFS=" " # space
echo $TMPIP | read ip1 ip2 ip3 ip4
INVERT_IP=$ip4.$ip3.$ip2.$ip1</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>更详细的IFS的介绍参见下文：（原文地址：<a href="http://www.livefirelabs.com/unix_tip_trick_shell_script/oct_2003/10132003.htm">http://www.livefirelabs.com/unix_tip_trick_shell_script/oct_2003/10132003.htm</a>）</p>
<p>&nbsp;</p>
<table style="width:100%;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>Another shell variable that you should become comfortable using is the IFS, or internal field separator, variable.<span>&nbsp;&nbsp;</span>The shell uses the value stored in IFS, which is the space, tab, and newline characters by default, to delimit words for the read and set commands, when parsing output from command substitution, and when performing variable substitution.</span><span></p>
<p><span style="text-decoration:underline;">IFS can be redefined to parse one or more lines of data whose fields are not delimited by the default white-space characters.</span><span>&nbsp;&nbsp;</span>Consider this sequence of variable assignments and for loops:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;">$ line=learn:unix:at:livefire:labs<br />$ for i in $line<br />&gt; do<br />&gt; echo $i<br />&gt; done<br />learn:unix:at:livefire:labs<br />$ OIFS=$IFS<br />$ IFS=:<br />$ for i in $line<br />&gt; do<br />&gt; echo $i<br />&gt; done<br />learn<br />unix<br />at<br />livefire<br />labs<br />$</p>
<p></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>The first command assigns the string &ldquo;learn:unix:at:livefire:labs&rdquo; to the variable named line.<span>&nbsp;&nbsp;</span>You can see from the first for loop that the shell treats the entire string as a single field.<span>&nbsp;&nbsp;</span>This is because the string does not contain a space, tab, or newline character.&nbsp;</p>
<p></span><span>After redefining IFS, the second for loop treats the string as four separated fields, each delimited by a colon.<span>&nbsp;&nbsp;</span>Using a colon for IFS would be appropriate when parsing the fields in a record from /etc/passwd, the user account information file:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;">livefire:x:100:1::/export/home/livefire:/bin/ksh</p>
<p></span></p>
</td>
</tr>
<tr>
<td width="100%">
<p class="MsoNormal"><span style="font-family:Arial;font-size:x-small;"><span>Notice that the original value of IFS was stored in OIFS (&ldquo;O&rdquo; for original) prior to changing its value.<span>&nbsp;&nbsp;</span>After you are finished using the new definition, it would be wise to return it to its original value to avoid unexpected side effects that may surface later on in your script.&nbsp;</p>
<p></span><span>TIP &ndash; The current value of IFS may be viewed using the following pipeline:</p>
<p></span></span></p>
</td>
</tr>
<tr>
<td width="100%">
<blockquote>
<p><span style="font-family:Arial;font-size:x-small;">$ echo "$IFS" | od -b<br />0000000 040 011 012 012<br />0000004<br />$</span></p>
</blockquote>
</td>
</tr>
<tr>
<td width="100%"><span style="font-family:Arial;font-size:x-small;"><span>The output of the echo command is piped into the octal dump command, giving you its octal equivalent.<span>&nbsp;&nbsp;</span>You can then use an ASCII table to determine what characters are stored in the variable.<span>&nbsp;&nbsp;</span>Hint: Ignore the first set of zeros and the second newline character (012), which was generated by echo.<br /></span></span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/06/24/apache-subversion-config">Apache and Subversion配置</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-06-24</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#Unix/Linux-ref" rel="nofollow">Unix/Linux</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>&nbsp;</p>
<h2>I.&nbsp;<span style="color:#000000;"><a href="http://xuebingnanmm.javaeye.com/blog/629810">CentOS Apache配置详解</a></span></h2>
<p><span style="color:#000000;">(</span><a href="http://xuebingnanmm.javaeye.com/blog/629810">http://xuebingnanmm.javaeye.com/blog/629810</a>)</p>
<p>&nbsp;</p>
<p><span style="color:#000000;"><br />
</span></p>
<h2>II.<span style="color:#000000;"><a id="vqhi" title="Subversion on CentOS" href="http://wiki.centos.org/HowTos/Subversion#head-63b296629e14e219beb2a4b866521947afe58d68">Subversion on CentOS</a>&nbsp;</span></h2>
<pre><span style="color:#000000;">(</span><a href="http://wiki.centos.org/HowTos/Subversion#head-2afd8f61ccc6de4477fde9a4bcc84720b86c17a9">http://wiki.centos.org/HowTos/Subversion#head-2afd8f61ccc6de4477fde9a4bcc84720b86c17a9</a>)</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>III. How to customize the path of svn repository?&nbsp;</h2>
<p>The URL of svn repository is like http://&lt;server_name&gt;/&lt;location&gt;/&lt;project&gt;. You can store the svn repository to anywhere you want.&nbsp;</p>
<p>&nbsp;</p>
<div>If the location is not defined in&nbsp;/etc/httpd/conf/httpd.conf, add such definition in it:</div>
<div><span style="font-family:'Courier New';">&lt;Directory /path&gt;</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp;Options FollowSymLinks<br /></span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp;AllowOverride None</span></div>
<div><span style="font-family:'Courier New';">&lt;/Directory&gt;</span></div>
<p>&nbsp;</p>
<div>Then change the&nbsp;<strong>/etc/httpd/conf.d/subversion.conf</strong>, such as:</div>
<div><span style="font-family:'Courier New';">&lt;Location /tmp&gt;</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;DAV svn</span></div>
<div><span style="font-family:'Courier New';"># &nbsp; &nbsp; &nbsp;SVNParentPath /var/www/svn/repos</span></div>
<div><span style="font-family:'Courier New';"># &nbsp; &nbsp; &nbsp;AuthzSVNAccessFile /etc/svn-acl-conf</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;SVNPath /tmp/svn/project</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;AuthType Basic</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;AuthName "Subversion repos"</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;AuthUserFile /etc/svn-auth-conf</span></div>
<div><span style="font-family:'Courier New';">&nbsp;&nbsp; &nbsp; &nbsp;Require valid-user</span></div>
<div><span style="font-family:'Courier New';">&lt;/Location&gt;</span></div>
<p>
<br />However,&nbsp;<span style="font-family:'courier new';">SVNParentPath&nbsp;</span>is can not be used here and only&nbsp;<span style="font-family:'courier new';">SVNPath&nbsp;</span>is supported (<a href="http://lists.freebsd.org/pipermail/freebsd-questions/2009-November/208244.html">http://lists.freebsd.org/pipermail/freebsd-questions/2009-November/208244.html</a>).</p>
<div>The &lt;Location /&gt;...&lt;/Location&gt; tags also can be added in /etc/httpd/conf/httpd.conf (<a href="http://stackoverflow.com/questions/673572/how-to-specify-the-repository-in-apache-dav-svn">http://stackoverflow.com/questions/673572/how-to-specify-the-repository-in-apache-dav-svn</a>).</div>
<div>Command to stop SELinux: &nbsp;<span style="font-family:'courier new';"><span style="font-size:x-small;">setenforce 0</span></span></div>
<p>&nbsp;</p>

	</div>
	</div>
    
	<div class="post paper">	
    <h2 class="header"><a href="/2010/06/13/batch-process-with-excel-vba">利用Excel VBA处理文档</a></h2>
    <p>
    	<span class="glyphicon glyphicon-time"></span> Posted by <strong>Bo Yang</strong> at <strong>2010-06-13</strong> with tags <span class="glyphicon glyphicon-tag"></span><a href="/tags.html#VBA-ref" rel="nofollow">VBA</a>
	</p>
	<hr>
    
    <div class="post_at_index thepost">
    	<p>遇到如下格式的一篇WORD文档，格式混乱，不适合打印：</p>
<p>&nbsp;</p>
<p><span style="font-family:monospace;font-size:13px;"><span style="white-space:pre-wrap;"><img src="http://bonny95.files.wordpress.com/2010/06/64_1276413753mmbm.jpg" alt="" width="232" height="614" /></span></span></p>
<p>&nbsp;</p>
<p>由于没有接触过Word VBA，因此决定用Excel VBA来处理这篇文档。首先全选该文档的内容，粘贴到Excel文档中。然后创建一个新的macro,修改该Macro为以下代码：</p>
<p>&nbsp;</p>
<p><span style="font-family:monospace;font-size:13px;"><span style="white-space:pre-wrap;">
<pre>Sub FormatSheet()'' FormatSheet Macro' Macro recorded 6/13/2010 by Bo Yang'' Keyboard Shortcut: Ctrl+f'    Dim str As String    Dim i As Long        ' Remove blank rows    rownumber = Range(&quot;A65536&quot;).End(xlUp).Row    Do While rownumber &gt;= 1        If Cells(rownumber, 1).Value = &quot;&quot; Then            Rows(rownumber).Delete            rownumber = rownumber - 1        End If        rownumber = rownumber - 1    Loop        ' Copy the Chinese intepretation    For rownumber = 2 To 65535        Cells(rownumber, 2).Value = Cells(rownumber + 1, 1).Value    Next        ' Delete rows which contians Chinese character    ' in their first cells    For rownumber = 2 To 65535        For i = 1 To Len(Cells(rownumber, 1).Value)            str = Mid(Cells(rownumber, 1).Value, i, 1)            If str Like &quot;[Ò»£­ý›]&quot; Then                Rows(rownumber).Delete            End If        Next    Next    End Sub</pre>
<p> </span></span></p>
<p>&nbsp;</p>
<p>然后按自定义快捷键Ctrl+f， 数秒钟后，文档处理完毕，秩序井然矣。</p>
<p>&nbsp;</p>
<p><img src="http://bonny95.files.wordpress.com/2010/06/64_12764139792ekk.jpg" alt="" width="464" height="523" /></p>

	</div>
	</div>
    
	
	<!-- Pagination links -->
	
	<ul class="pager">
	    
	    <li class="previous"><a href="/page12">&larr; Older</a></li>
	    
	
	    
	    <li class="next"><a href="/page10">Newer &rarr;</a></li>
	    
	</ul>
	
	<!-- content -->
</div>

<div class="col-lg-4">
		<div class="well">
            <h4>Links</h4>
            <a href="https://www.facebook.com/bo.yang.52493" target="_blank"> <i class="fa fa-facebook-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://www.linkedin.com/pub/bo-yang/21/a3/893" target="_blank"> <i class="fa fa-linkedin-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://github.com/bo-yang" target="_blank"> <i class="fa fa-github fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="https://plus.google.com/" target="_blank"> <i class="fa fa-google-plus-square fa-3x"></i> </a> &nbsp;&nbsp;
			<a href="http://www.weibo.com/bonnyang" target="_blank"> <i class="fa fa-weibo fa-3x"></i> </a> &nbsp;&nbsp;
        	<a href="/atom.xml" target="_blank"> <i class="fa fa-rss-square fa-3x"></i> </a>	
        </div>
        <!-- /well -->
        <div class="well">
			<h4>Tags</h4>
			<div class="tag_box">
		    	
				
  
    
        <a href="/tags.html#MFC-ref" class="btn btn-mini">MFC <span class="badge">10</span></a>
    
        <a href="/tags.html#Algorithm-ref" class="btn btn-mini">Algorithm <span class="badge">18</span></a>
    
        <a href="/tags.html#C-ref" class="btn btn-mini">C <span class="badge">16</span></a>
    
        <a href="/tags.html#EMC-ref" class="btn btn-mini">EMC <span class="badge">9</span></a>
    
        <a href="/tags.html#fault diagnosis-ref" class="btn btn-mini">fault diagnosis <span class="badge">2</span></a>
    
        <a href="/tags.html#EMI-ref" class="btn btn-mini">EMI <span class="badge">1</span></a>
    
        <a href="/tags.html#notes-ref" class="btn btn-mini">notes <span class="badge">3</span></a>
    
        <a href="/tags.html#CBR-ref" class="btn btn-mini">CBR <span class="badge">1</span></a>
    
        <a href="/tags.html#AI-ref" class="btn btn-mini">AI <span class="badge">5</span></a>
    
        <a href="/tags.html#Database-ref" class="btn btn-mini">Database <span class="badge">1</span></a>
    
        <a href="/tags.html#Unix-ref" class="btn btn-mini">Unix <span class="badge">1</span></a>
    
        <a href="/tags.html#Linux-ref" class="btn btn-mini">Linux <span class="badge">1</span></a>
    
        <a href="/tags.html#Personal-ref" class="btn btn-mini">Personal <span class="badge">10</span></a>
    
        <a href="/tags.html#Unix/Linux-ref" class="btn btn-mini">Unix/Linux <span class="badge">93</span></a>
    
        <a href="/tags.html#Telecommunication-ref" class="btn btn-mini">Telecommunication <span class="badge">1</span></a>
    
        <a href="/tags.html#Tcl/Tk-ref" class="btn btn-mini">Tcl/Tk <span class="badge">6</span></a>
    
        <a href="/tags.html#Shell-ref" class="btn btn-mini">Shell <span class="badge">12</span></a>
    
        <a href="/tags.html#Network/Telecom-ref" class="btn btn-mini">Network/Telecom <span class="badge">3</span></a>
    
        <a href="/tags.html#Perl-ref" class="btn btn-mini">Perl <span class="badge">14</span></a>
    
        <a href="/tags.html#Essay-ref" class="btn btn-mini">Essay <span class="badge">12</span></a>
    
        <a href="/tags.html#Industry-ref" class="btn btn-mini">Industry <span class="badge">6</span></a>
    
        <a href="/tags.html#Cloud Computing-ref" class="btn btn-mini">Cloud Computing <span class="badge">2</span></a>
    
        <a href="/tags.html#Android-ref" class="btn btn-mini">Android <span class="badge">2</span></a>
    
        <a href="/tags.html#VBA-ref" class="btn btn-mini">VBA <span class="badge">4</span></a>
    
        <a href="/tags.html#ESXi-ref" class="btn btn-mini">ESXi <span class="badge">1</span></a>
    
        <a href="/tags.html#Virtual Machine-ref" class="btn btn-mini">Virtual Machine <span class="badge">2</span></a>
    
        <a href="/tags.html#Browser-ref" class="btn btn-mini">Browser <span class="badge">2</span></a>
    
        <a href="/tags.html#Plan 9-ref" class="btn btn-mini">Plan 9 <span class="badge">9</span></a>
    
        <a href="/tags.html#Go-ref" class="btn btn-mini">Go <span class="badge">3</span></a>
    
        <a href="/tags.html#Virtualization-ref" class="btn btn-mini">Virtualization <span class="badge">2</span></a>
    
        <a href="/tags.html#C/C++-ref" class="btn btn-mini">C/C++ <span class="badge">17</span></a>
    
        <a href="/tags.html#RHEL6.1-ref" class="btn btn-mini">RHEL6.1 <span class="badge">2</span></a>
    
        <a href="/tags.html#Tips-ref" class="btn btn-mini">Tips <span class="badge">5</span></a>
    
        <a href="/tags.html#CPP-ref" class="btn btn-mini">CPP <span class="badge">1</span></a>
    
        <a href="/tags.html#RPC-ref" class="btn btn-mini">RPC <span class="badge">1</span></a>
    
        <a href="/tags.html#rup-ref" class="btn btn-mini">rup <span class="badge">1</span></a>
    
        <a href="/tags.html#ksh-ref" class="btn btn-mini">ksh <span class="badge">1</span></a>
    
        <a href="/tags.html#Ubuntu-ref" class="btn btn-mini">Ubuntu <span class="badge">1</span></a>
    
        <a href="/tags.html#file descriptor-ref" class="btn btn-mini">file descriptor <span class="badge">1</span></a>
    
        <a href="/tags.html#Expect-ref" class="btn btn-mini">Expect <span class="badge">1</span></a>
    
        <a href="/tags.html#Here Document-ref" class="btn btn-mini">Here Document <span class="badge">1</span></a>
    
        <a href="/tags.html#Evolutionary Computation-ref" class="btn btn-mini">Evolutionary Computation <span class="badge">1</span></a>
    
        <a href="/tags.html#Genetic Algorihtm-ref" class="btn btn-mini">Genetic Algorihtm <span class="badge">1</span></a>
    
        <a href="/tags.html#ldd-ref" class="btn btn-mini">ldd <span class="badge">1</span></a>
    
        <a href="/tags.html#signal-ref" class="btn btn-mini">signal <span class="badge">1</span></a>
    
        <a href="/tags.html#swap-ref" class="btn btn-mini">swap <span class="badge">1</span></a>
    
        <a href="/tags.html#NIC-ref" class="btn btn-mini">NIC <span class="badge">1</span></a>
    
        <a href="/tags.html#Mac OS-ref" class="btn btn-mini">Mac OS <span class="badge">1</span></a>
    
        <a href="/tags.html#VNC-ref" class="btn btn-mini">VNC <span class="badge">1</span></a>
    
        <a href="/tags.html#X11-ref" class="btn btn-mini">X11 <span class="badge">1</span></a>
    
        <a href="/tags.html#Merge sort-ref" class="btn btn-mini">Merge sort <span class="badge">1</span></a>
    
        <a href="/tags.html#boost-ref" class="btn btn-mini">boost <span class="badge">1</span></a>
    
        <a href="/tags.html#CDF-ref" class="btn btn-mini">CDF <span class="badge">1</span></a>
    
        <a href="/tags.html#Matlab-ref" class="btn btn-mini">Matlab <span class="badge">3</span></a>
    
        <a href="/tags.html#Multi-Process-ref" class="btn btn-mini">Multi-Process <span class="badge">1</span></a>
    
        <a href="/tags.html#Multi-Threading-ref" class="btn btn-mini">Multi-Threading <span class="badge">1</span></a>
    
        <a href="/tags.html#Bioinformatics-ref" class="btn btn-mini">Bioinformatics <span class="badge">1</span></a>
    
        <a href="/tags.html#Computer Vision-ref" class="btn btn-mini">Computer Vision <span class="badge">4</span></a>
    
        <a href="/tags.html#DTF-ref" class="btn btn-mini">DTF <span class="badge">2</span></a>
    
        <a href="/tags.html#ffmpeg-ref" class="btn btn-mini">ffmpeg <span class="badge">1</span></a>
    
        <a href="/tags.html#OpenCV-ref" class="btn btn-mini">OpenCV <span class="badge">1</span></a>
    
        <a href="/tags.html#Machine Learning-ref" class="btn btn-mini">Machine Learning <span class="badge">2</span></a>
    
        <a href="/tags.html#parfor-ref" class="btn btn-mini">parfor <span class="badge">1</span></a>
    
        <a href="/tags.html#BACI-ref" class="btn btn-mini">BACI <span class="badge">1</span></a>
    
        <a href="/tags.html#Alogrithm-ref" class="btn btn-mini">Alogrithm <span class="badge">1</span></a>
    
        <a href="/tags.html#Jekyll-ref" class="btn btn-mini">Jekyll <span class="badge">1</span></a>
    
        <a href="/tags.html#Github-ref" class="btn btn-mini">Github <span class="badge">1</span></a>
    
        <a href="/tags.html#Fisher Vector-ref" class="btn btn-mini">Fisher Vector <span class="badge">1</span></a>
    
        <a href="/tags.html#SVM-ref" class="btn btn-mini">SVM <span class="badge">1</span></a>
    
        <a href="/tags.html#Java-ref" class="btn btn-mini">Java <span class="badge">1</span></a>
    
        <a href="/tags.html#Dynamic Programming-ref" class="btn btn-mini">Dynamic Programming <span class="badge">1</span></a>
    
  



			</div>
        </div>
        <!-- /well -->
        <div class="well">
            <h3>Recent Posts</h3>
	        <ul>
			
  			<li><span>2014-07-01</span> &raquo; <a href="/2014/07/01/strstr">The First Occurrence of Needle In Haystack</a></li>
			
  			<li><span>2014-07-01</span> &raquo; <a href="/2014/07/01/longest-consecutive-sequence">Longest Consecutive Sequence</a></li>
			
  			<li><span>2014-06-29</span> &raquo; <a href="/2014/06/29/top-n-numbers">Top N Numbers</a></li>
			
  			<li><span>2014-06-27</span> &raquo; <a href="/2014/06/27/nqueens">N-Queens Problem</a></li>
			
  			<li><span>2014-06-25</span> &raquo; <a href="/2014/06/25/combination-sum">Combination Sum Problem - A Non-recursive Method</a></li>
			
  			<li><span>2014-06-20</span> &raquo; <a href="/2014/06/20/coin-change">Coin Change Problem</a></li>
			
  			<li><span>2014-06-18</span> &raquo; <a href="/2014/06/18/text-justification">Text Justification</a></li>
			
  			<li><span>2014-06-17</span> &raquo; <a href="/2014/06/17/sort-colors">Sort Colors</a></li>
			
  			<li><span>2014-06-14</span> &raquo; <a href="/2014/06/14/soduku">Check Soduku Solution</a></li>
			
  			<li><span>2014-06-12</span> &raquo; <a href="/2014/06/12/lru-cache">Least Recently Used(LRU) Cache</a></li>
			
			</ul>
        </div>
        <!-- /well -->
</div>

	</div>
</div>


    </div>

    <footer>
        <p>&copy; 2007 <span id="now_year"></span> Bo Yang. </p>
        <script type="text/javascript">
          var now_year = new Date().getFullYear();
          if (now_year != 2007) {
              $('#now_year').html('- ' + now_year);
          }
	    </script>
      </footer>
  </div>

  <script type="text/javascript" src="/assets/google-code-prettify/prettify.js"></script>
  <script src="/assets/run_prettify.js"></script>
  <script type="text/javascript">
    $(function() {

      $('a[href^="http"]').each(function () {
        $(this).attr('target', '_blank');
      });

      $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto');
      window.prettyPrint && prettyPrint();

      function traverse($node, len, maxCount) {
        var reachMaxCount = len > maxCount;
        if (reachMaxCount) {
          $node.hide();
        }
        var $contents = $node.contents();
        for (var i = 0; i < $contents.length; ++i) {
          if (reachMaxCount) {
            $contents.eq(i).hide();
            continue;
          }
          if ($contents[i].nodeType == 3) { // TextNode
            var tmp = len;
            var s = $contents[i].nodeValue;
            len += s.length;
            reachMaxCount = len > maxCount;
            if (reachMaxCount && $contents[i].parentNode.nodeName != 'A') {
              $contents[i].nodeValue = s.substring(0, maxCount - tmp);
            }
          }
          else if ($contents[i].nodeType == 1) { // Element
            len = traverse($contents.eq(i), len, maxCount);
          }
        }
        return len;
      }

      $('.post_at_index').each(function() {
        var count = traverse($(this), 0, 400);
        if (count > 400) {
          var thisUrl = $(this).siblings().first().children().attr('href');
          $(this).after('\n<a href="' + thisUrl + '" rel="nofollow" class="btn btn-primary" role="button">' + 'Read More &raquo;</a>');
        }
      });
    });
  </script>

  

</body>
</html>

